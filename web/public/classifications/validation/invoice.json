{
  "id": "invoice",
  "title": "Validation Criteria — Invoice",
  "typeIds": [
    "business_invoice"
  ],
  "markdown": "# Validation Criteria — Invoice\n\nType id: `business_invoice`\n\n## Goal\nDetect malformed or risky invoices and surface concrete issues:\n- compliance fields missing\n- math/tax inconsistencies\n- unclear payment terms\n- party/entity mismatches\n\n## What to extract (structured)\n- Supplier entity (name, address, tax id)\n- Buyer entity (name, address)\n- Invoice identifiers (invoice number, issue date, due date)\n- Currency\n- Line items (description, qty, unit price, line total)\n- Subtotal, taxes, total\n- Payment terms and payment instructions\n- References (PO number, contract/SOW reference, project name)\n\n## Validation checklist\n\n### A) Legal entity consistency\n- Supplier name matches supplier tax id context (ABN/VAT id present when expected)\n- Buyer name matches who the invoice is addressed to\n- Flag mismatch between header entity name and footer/legal entity lines\n\n### B) Required invoice fields\nFlag as **missing** if absent:\n- invoice number\n- issue date\n- due date or payment terms\n- supplier tax id (when it is a tax invoice / claims GST/VAT)\n- currency (if ambiguous)\n\n### C) Tax logic (GST/VAT)\n- Detect whether tax is included vs excluded\n- Check tax rate consistency across lines\n- Check subtotal + tax = total (within rounding tolerance)\n- Flag “tax invoice” wording without tax id\n\n### D) Line items vs totals\n- qty × unit price = line total\n- sum(line totals) = subtotal\n- subtotal + tax = total\n- Flag suspicious “misc/other” lines without description\n\n### E) Payment terms clarity\n- Detect net terms (e.g. Net 7/14/30)\n- Detect late fees / interest\n- Flag missing payment method details (if the invoice demands payment)\n\n### F) Cross-document references (if provided)\nIf PO/contract docs are provided:\n- invoice references PO number when a PO exists\n- line items match PO/contract scope (high-level)\n- flag extra/unscoped items\n\n## Output schema (draft)\n```json\n{\n  \"type\": \"invoice_validation\",\n  \"supplier\": {\"name\": \"\", \"taxId\": \"\", \"address\": \"\"},\n  \"buyer\": {\"name\": \"\", \"address\": \"\"},\n  \"invoice\": {\"number\": \"\", \"issueDate\": \"\", \"dueDate\": \"\", \"currency\": \"\"},\n  \"totals\": {\"subtotal\": null, \"tax\": null, \"total\": null, \"taxIncluded\": null},\n  \"lineItems\": [{\"description\": \"\", \"qty\": null, \"unitPrice\": null, \"lineTotal\": null}],\n  \"findings\": [{\"severity\": \"high|medium|low\", \"code\": \"\", \"message\": \"\", \"evidence\": [{\"page\": 1, \"quote\": \"\"}]}]\n}\n```\n\n## Red flags (high severity)\n- invoice total inconsistent with line items\n- tax claimed but no tax id\n- buyer entity mismatch vs contract/PO (if provided)\n- missing invoice number\n",
  "version": 1
}
