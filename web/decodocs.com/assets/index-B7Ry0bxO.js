var Cy=r=>{throw TypeError(r)};var Ud=(r,t,e)=>t.has(r)||Cy("Cannot "+e);var Zt=(r,t,e)=>(Ud(r,t,"read from private field"),e?e.call(r):t.get(r)),Qn=(r,t,e)=>t.has(r)?Cy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),Ke=(r,t,e,i)=>(Ud(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e),Zn=(r,t,e)=>(Ud(r,t,"access private method"),e);var Ry=(r,t,e,i)=>({set _(a){Ke(r,t,a,e)},get _(){return Zt(r,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=e(a);fetch(a.href,l)}})();function lv(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Fd={exports:{}},mo={};var Dy;function GA(){if(Dy)return mo;Dy=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var u in a)u!=="key"&&(l[u]=a[u])}else l=a;return a=l.ref,{$$typeof:r,type:i,key:c,ref:a!==void 0?a:null,props:l}}return mo.Fragment=t,mo.jsx=e,mo.jsxs=e,mo}var Ny;function qA(){return Ny||(Ny=1,Fd.exports=GA()),Fd.exports}var b=qA(),zd={exports:{}},bt={};var My;function $A(){if(My)return bt;My=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),v=Symbol.iterator;function w(k){return k===null||typeof k!="object"?null:(k=v&&k[v]||k["@@iterator"],typeof k=="function"?k:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,S={};function E(k,V,Z){this.props=k,this.context=V,this.refs=S,this.updater=Z||_}E.prototype.isReactComponent={},E.prototype.setState=function(k,V){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,V,"setState")},E.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function R(){}R.prototype=E.prototype;function C(k,V,Z){this.props=k,this.context=V,this.refs=S,this.updater=Z||_}var D=C.prototype=new R;D.constructor=C,x(D,E.prototype),D.isPureReactComponent=!0;var N=Array.isArray;function L(){}var j={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function Y(k,V,Z){var et=Z.ref;return{$$typeof:r,type:k,key:V,ref:et!==void 0?et:null,props:Z}}function $(k,V){return Y(k.type,V,k.props)}function H(k){return typeof k=="object"&&k!==null&&k.$$typeof===r}function J(k){var V={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(Z){return V[Z]})}var at=/\/+/g;function rt(k,V){return typeof k=="object"&&k!==null&&k.key!=null?J(""+k.key):V.toString(36)}function pt(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(L,L):(k.status="pending",k.then(function(V){k.status==="pending"&&(k.status="fulfilled",k.value=V)},function(V){k.status==="pending"&&(k.status="rejected",k.reason=V)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function P(k,V,Z,et,ut){var gt=typeof k;(gt==="undefined"||gt==="boolean")&&(k=null);var ht=!1;if(k===null)ht=!0;else switch(gt){case"bigint":case"string":case"number":ht=!0;break;case"object":switch(k.$$typeof){case r:case t:ht=!0;break;case m:return ht=k._init,P(ht(k._payload),V,Z,et,ut)}}if(ht)return ut=ut(k),ht=et===""?"."+rt(k,0):et,N(ut)?(Z="",ht!=null&&(Z=ht.replace(at,"$&/")+"/"),P(ut,V,Z,"",function(Gn){return Gn})):ut!=null&&(H(ut)&&(ut=$(ut,Z+(ut.key==null||k&&k.key===ut.key?"":(""+ut.key).replace(at,"$&/")+"/")+ht)),V.push(ut)),1;ht=0;var ae=et===""?".":et+":";if(N(k))for(var Pt=0;Pt<k.length;Pt++)et=k[Pt],gt=ae+rt(et,Pt),ht+=P(et,V,Z,gt,ut);else if(Pt=w(k),typeof Pt=="function")for(k=Pt.call(k),Pt=0;!(et=k.next()).done;)et=et.value,gt=ae+rt(et,Pt++),ht+=P(et,V,Z,gt,ut);else if(gt==="object"){if(typeof k.then=="function")return P(pt(k),V,Z,et,ut);throw V=String(k),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return ht}function q(k,V,Z){if(k==null)return k;var et=[],ut=0;return P(k,et,"","",function(gt){return V.call(Z,gt,ut++)}),et}function tt(k){if(k._status===-1){var V=k._result;V=V(),V.then(function(Z){(k._status===0||k._status===-1)&&(k._status=1,k._result=Z)},function(Z){(k._status===0||k._status===-1)&&(k._status=2,k._result=Z)}),k._status===-1&&(k._status=0,k._result=V)}if(k._status===1)return k._result.default;throw k._result}var mt=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},St={map:q,forEach:function(k,V,Z){q(k,function(){V.apply(this,arguments)},Z)},count:function(k){var V=0;return q(k,function(){V++}),V},toArray:function(k){return q(k,function(V){return V})||[]},only:function(k){if(!H(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return bt.Activity=g,bt.Children=St,bt.Component=E,bt.Fragment=e,bt.Profiler=a,bt.PureComponent=C,bt.StrictMode=i,bt.Suspense=d,bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,bt.__COMPILER_RUNTIME={__proto__:null,c:function(k){return j.H.useMemoCache(k)}},bt.cache=function(k){return function(){return k.apply(null,arguments)}},bt.cacheSignal=function(){return null},bt.cloneElement=function(k,V,Z){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var et=x({},k.props),ut=k.key;if(V!=null)for(gt in V.key!==void 0&&(ut=""+V.key),V)!K.call(V,gt)||gt==="key"||gt==="__self"||gt==="__source"||gt==="ref"&&V.ref===void 0||(et[gt]=V[gt]);var gt=arguments.length-2;if(gt===1)et.children=Z;else if(1<gt){for(var ht=Array(gt),ae=0;ae<gt;ae++)ht[ae]=arguments[ae+2];et.children=ht}return Y(k.type,ut,et)},bt.createContext=function(k){return k={$$typeof:c,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:l,_context:k},k},bt.createElement=function(k,V,Z){var et,ut={},gt=null;if(V!=null)for(et in V.key!==void 0&&(gt=""+V.key),V)K.call(V,et)&&et!=="key"&&et!=="__self"&&et!=="__source"&&(ut[et]=V[et]);var ht=arguments.length-2;if(ht===1)ut.children=Z;else if(1<ht){for(var ae=Array(ht),Pt=0;Pt<ht;Pt++)ae[Pt]=arguments[Pt+2];ut.children=ae}if(k&&k.defaultProps)for(et in ht=k.defaultProps,ht)ut[et]===void 0&&(ut[et]=ht[et]);return Y(k,gt,ut)},bt.createRef=function(){return{current:null}},bt.forwardRef=function(k){return{$$typeof:u,render:k}},bt.isValidElement=H,bt.lazy=function(k){return{$$typeof:m,_payload:{_status:-1,_result:k},_init:tt}},bt.memo=function(k,V){return{$$typeof:f,type:k,compare:V===void 0?null:V}},bt.startTransition=function(k){var V=j.T,Z={};j.T=Z;try{var et=k(),ut=j.S;ut!==null&&ut(Z,et),typeof et=="object"&&et!==null&&typeof et.then=="function"&&et.then(L,mt)}catch(gt){mt(gt)}finally{V!==null&&Z.types!==null&&(V.types=Z.types),j.T=V}},bt.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},bt.use=function(k){return j.H.use(k)},bt.useActionState=function(k,V,Z){return j.H.useActionState(k,V,Z)},bt.useCallback=function(k,V){return j.H.useCallback(k,V)},bt.useContext=function(k){return j.H.useContext(k)},bt.useDebugValue=function(){},bt.useDeferredValue=function(k,V){return j.H.useDeferredValue(k,V)},bt.useEffect=function(k,V){return j.H.useEffect(k,V)},bt.useEffectEvent=function(k){return j.H.useEffectEvent(k)},bt.useId=function(){return j.H.useId()},bt.useImperativeHandle=function(k,V,Z){return j.H.useImperativeHandle(k,V,Z)},bt.useInsertionEffect=function(k,V){return j.H.useInsertionEffect(k,V)},bt.useLayoutEffect=function(k,V){return j.H.useLayoutEffect(k,V)},bt.useMemo=function(k,V){return j.H.useMemo(k,V)},bt.useOptimistic=function(k,V){return j.H.useOptimistic(k,V)},bt.useReducer=function(k,V,Z){return j.H.useReducer(k,V,Z)},bt.useRef=function(k){return j.H.useRef(k)},bt.useState=function(k){return j.H.useState(k)},bt.useSyncExternalStore=function(k,V,Z){return j.H.useSyncExternalStore(k,V,Z)},bt.useTransition=function(){return j.H.useTransition()},bt.version="19.2.4",bt}var ky;function zf(){return ky||(ky=1,zd.exports=$A()),zd.exports}var I=zf();const Un=lv(I);var Hd={exports:{}},go={},Vd={exports:{}},Gd={};var Ly;function YA(){return Ly||(Ly=1,(function(r){function t(P,q){var tt=P.length;P.push(q);t:for(;0<tt;){var mt=tt-1>>>1,St=P[mt];if(0<a(St,q))P[mt]=q,P[tt]=St,tt=mt;else break t}}function e(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var q=P[0],tt=P.pop();if(tt!==q){P[0]=tt;t:for(var mt=0,St=P.length,k=St>>>1;mt<k;){var V=2*(mt+1)-1,Z=P[V],et=V+1,ut=P[et];if(0>a(Z,tt))et<St&&0>a(ut,Z)?(P[mt]=ut,P[et]=tt,mt=et):(P[mt]=Z,P[V]=tt,mt=V);else if(et<St&&0>a(ut,tt))P[mt]=ut,P[et]=tt,mt=et;else break t}}return q}function a(P,q){var tt=P.sortIndex-q.sortIndex;return tt!==0?tt:P.id-q.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;r.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();r.unstable_now=function(){return c.now()-u}}var d=[],f=[],m=1,g=null,v=3,w=!1,_=!1,x=!1,S=!1,E=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function D(P){for(var q=e(f);q!==null;){if(q.callback===null)i(f);else if(q.startTime<=P)i(f),q.sortIndex=q.expirationTime,t(d,q);else break;q=e(f)}}function N(P){if(x=!1,D(P),!_)if(e(d)!==null)_=!0,L||(L=!0,J());else{var q=e(f);q!==null&&pt(N,q.startTime-P)}}var L=!1,j=-1,K=5,Y=-1;function $(){return S?!0:!(r.unstable_now()-Y<K)}function H(){if(S=!1,L){var P=r.unstable_now();Y=P;var q=!0;try{t:{_=!1,x&&(x=!1,R(j),j=-1),w=!0;var tt=v;try{e:{for(D(P),g=e(d);g!==null&&!(g.expirationTime>P&&$());){var mt=g.callback;if(typeof mt=="function"){g.callback=null,v=g.priorityLevel;var St=mt(g.expirationTime<=P);if(P=r.unstable_now(),typeof St=="function"){g.callback=St,D(P),q=!0;break e}g===e(d)&&i(d),D(P)}else i(d);g=e(d)}if(g!==null)q=!0;else{var k=e(f);k!==null&&pt(N,k.startTime-P),q=!1}}break t}finally{g=null,v=tt,w=!1}q=void 0}}finally{q?J():L=!1}}}var J;if(typeof C=="function")J=function(){C(H)};else if(typeof MessageChannel<"u"){var at=new MessageChannel,rt=at.port2;at.port1.onmessage=H,J=function(){rt.postMessage(null)}}else J=function(){E(H,0)};function pt(P,q){j=E(function(){P(r.unstable_now())},q)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(P){P.callback=null},r.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<P?Math.floor(1e3/P):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_next=function(P){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var tt=v;v=q;try{return P()}finally{v=tt}},r.unstable_requestPaint=function(){S=!0},r.unstable_runWithPriority=function(P,q){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var tt=v;v=P;try{return q()}finally{v=tt}},r.unstable_scheduleCallback=function(P,q,tt){var mt=r.unstable_now();switch(typeof tt=="object"&&tt!==null?(tt=tt.delay,tt=typeof tt=="number"&&0<tt?mt+tt:mt):tt=mt,P){case 1:var St=-1;break;case 2:St=250;break;case 5:St=1073741823;break;case 4:St=1e4;break;default:St=5e3}return St=tt+St,P={id:m++,callback:q,priorityLevel:P,startTime:tt,expirationTime:St,sortIndex:-1},tt>mt?(P.sortIndex=tt,t(f,P),e(d)===null&&P===e(f)&&(x?(R(j),j=-1):x=!0,pt(N,tt-mt))):(P.sortIndex=St,t(d,P),_||w||(_=!0,L||(L=!0,J()))),P},r.unstable_shouldYield=$,r.unstable_wrapCallback=function(P){var q=v;return function(){var tt=v;v=q;try{return P.apply(this,arguments)}finally{v=tt}}}})(Gd)),Gd}var Oy;function XA(){return Oy||(Oy=1,Vd.exports=YA()),Vd.exports}var qd={exports:{}},Ie={};var Iy;function WA(){if(Iy)return Ie;Iy=1;var r=zf();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(d,f,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:d,containerInfo:f,implementation:m}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Ie.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ie.createPortal=function(d,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(d,f,null,m)},Ie.flushSync=function(d){var f=c.T,m=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=f,i.p=m,i.d.f()}},Ie.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Ie.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Ie.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var m=f.as,g=u(m,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,w=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:w}):m==="script"&&i.d.X(d,{crossOrigin:g,integrity:v,fetchPriority:w,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Ie.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Ie.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,g=u(m,f.crossOrigin);i.d.L(d,m,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Ie.preloadModule=function(d,f){if(typeof d=="string")if(f){var m=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Ie.requestFormReset=function(d){i.d.r(d)},Ie.unstable_batchedUpdates=function(d,f){return d(f)},Ie.useFormState=function(d,f,m){return c.H.useFormState(d,f,m)},Ie.useFormStatus=function(){return c.H.useHostTransitionStatus()},Ie.version="19.2.4",Ie}var Py;function KA(){if(Py)return qd.exports;Py=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),qd.exports=WA(),qd.exports}var jy;function QA(){if(jy)return go;jy=1;var r=XA(),t=zf(),e=KA();function i(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var s=n,o=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(o=s.return),n=s.return;while(n)}return s.tag===3?o:null}function c(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function u(n){if(n.tag===31){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function d(n){if(l(n)!==n)throw Error(i(188))}function f(n){var s=n.alternate;if(!s){if(s=l(n),s===null)throw Error(i(188));return s!==n?null:n}for(var o=n,h=s;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){o=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return d(p),n;if(y===h)return d(p),s;y=y.sibling}throw Error(i(188))}if(o.return!==h.return)o=p,h=y;else{for(var A=!1,T=p.child;T;){if(T===o){A=!0,o=p,h=y;break}if(T===h){A=!0,h=p,o=y;break}T=T.sibling}if(!A){for(T=y.child;T;){if(T===o){A=!0,o=y,h=p;break}if(T===h){A=!0,h=y,o=p;break}T=T.sibling}if(!A)throw Error(i(189))}}if(o.alternate!==h)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:s}function m(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=m(n),s!==null)return s;n=n.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),C=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function J(n){return n===null||typeof n!="object"?null:(n=H&&n[H]||n["@@iterator"],typeof n=="function"?n:null)}var at=Symbol.for("react.client.reference");function rt(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===at?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case x:return"Fragment";case E:return"Profiler";case S:return"StrictMode";case N:return"Suspense";case L:return"SuspenseList";case Y:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case _:return"Portal";case C:return n.displayName||"Context";case R:return(n._context.displayName||"Context")+".Consumer";case D:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case j:return s=n.displayName||null,s!==null?s:rt(n.type)||"Memo";case K:s=n._payload,n=n._init;try{return rt(n(s))}catch{}}return null}var pt=Array.isArray,P=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tt={pending:!1,data:null,method:null,action:null},mt=[],St=-1;function k(n){return{current:n}}function V(n){0>St||(n.current=mt[St],mt[St]=null,St--)}function Z(n,s){St++,mt[St]=n.current,n.current=s}var et=k(null),ut=k(null),gt=k(null),ht=k(null);function ae(n,s){switch(Z(gt,s),Z(ut,n),Z(et,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?K0(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=K0(s),n=Q0(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}V(et),Z(et,n)}function Pt(){V(et),V(ut),V(gt)}function Gn(n){n.memoizedState!==null&&Z(ht,n);var s=et.current,o=Q0(s,n.type);s!==o&&(Z(ut,n),Z(et,o))}function qn(n){ut.current===n&&(V(et),V(ut)),ht.current===n&&(V(ht),uo._currentValue=tt)}var Ln,aa;function $n(n){if(Ln===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Ln=s&&s[1]||"",aa=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ln+n+aa}var ra=!1;function xr(n,s){if(!n||ra)return"";ra=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var Q=function(){throw Error()};if(Object.defineProperty(Q.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Q,[])}catch(G){var z=G}Reflect.construct(n,[],Q)}else{try{Q.call()}catch(G){z=G}n.call(Q.prototype)}}else{try{throw Error()}catch(G){z=G}(Q=n())&&typeof Q.catch=="function"&&Q.catch(function(){})}}catch(G){if(G&&z&&typeof G.stack=="string")return[G.stack,z.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=h.DetermineComponentFrameRoot(),A=y[0],T=y[1];if(A&&T){var M=A.split(`
`),F=T.split(`
`);for(p=h=0;h<M.length&&!M[h].includes("DetermineComponentFrameRoot");)h++;for(;p<F.length&&!F[p].includes("DetermineComponentFrameRoot");)p++;if(h===M.length||p===F.length)for(h=M.length-1,p=F.length-1;1<=h&&0<=p&&M[h]!==F[p];)p--;for(;1<=h&&0<=p;h--,p--)if(M[h]!==F[p]){if(h!==1||p!==1)do if(h--,p--,0>p||M[h]!==F[p]){var X=`
`+M[h].replace(" at new "," at ");return n.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",n.displayName)),X}while(1<=h&&0<=p);break}}}finally{ra=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?$n(o):""}function rl(n,s){switch(n.tag){case 26:case 27:case 5:return $n(n.type);case 16:return $n("Lazy");case 13:return n.child!==s&&s!==null?$n("Suspense Fallback"):$n("Suspense");case 19:return $n("SuspenseList");case 0:case 15:return xr(n.type,!1);case 11:return xr(n.type.render,!1);case 1:return xr(n.type,!0);case 31:return $n("Activity");default:return""}}function ol(n){try{var s="",o=null;do s+=rl(n,o),o=n,n=n.return;while(n);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var oa=Object.prototype.hasOwnProperty,ll=r.unstable_scheduleCallback,la=r.unstable_cancelCallback,_u=r.unstable_shouldYield,Eu=r.unstable_requestPaint,je=r.unstable_now,Tu=r.unstable_getCurrentPriorityLevel,Ar=r.unstable_ImmediatePriority,cl=r.unstable_UserBlockingPriority,ca=r.unstable_NormalPriority,Yt=r.unstable_LowPriority,re=r.unstable_IdlePriority,Oe=r.log,bn=r.unstable_setDisableYieldValue,Vi=null,nn=null;function Gi(n){if(typeof Oe=="function"&&bn(n),nn&&typeof nn.setStrictMode=="function")try{nn.setStrictMode(Vi,n)}catch{}}var sn=Math.clz32?Math.clz32:Nw,Rw=Math.log,Dw=Math.LN2;function Nw(n){return n>>>=0,n===0?32:31-(Rw(n)/Dw|0)|0}var ul=256,hl=262144,dl=4194304;function Rs(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function fl(n,s,o){var h=n.pendingLanes;if(h===0)return 0;var p=0,y=n.suspendedLanes,A=n.pingedLanes;n=n.warmLanes;var T=h&134217727;return T!==0?(h=T&~y,h!==0?p=Rs(h):(A&=T,A!==0?p=Rs(A):o||(o=T&~n,o!==0&&(p=Rs(o))))):(T=h&~y,T!==0?p=Rs(T):A!==0?p=Rs(A):o||(o=h&~n,o!==0&&(p=Rs(o)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:p}function Sr(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function Mw(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mp(){var n=dl;return dl<<=1,(dl&62914560)===0&&(dl=4194304),n}function Cu(n){for(var s=[],o=0;31>o;o++)s.push(n);return s}function _r(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function kw(n,s,o,h,p,y){var A=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var T=n.entanglements,M=n.expirationTimes,F=n.hiddenUpdates;for(o=A&~o;0<o;){var X=31-sn(o),Q=1<<X;T[X]=0,M[X]=-1;var z=F[X];if(z!==null)for(F[X]=null,X=0;X<z.length;X++){var G=z[X];G!==null&&(G.lane&=-536870913)}o&=~Q}h!==0&&kp(n,h,0),y!==0&&p===0&&n.tag!==0&&(n.suspendedLanes|=y&~(A&~s))}function kp(n,s,o){n.pendingLanes|=s,n.suspendedLanes&=~s;var h=31-sn(s);n.entangledLanes|=s,n.entanglements[h]=n.entanglements[h]|1073741824|o&261930}function Lp(n,s){var o=n.entangledLanes|=s;for(n=n.entanglements;o;){var h=31-sn(o),p=1<<h;p&s|n[h]&s&&(n[h]|=s),o&=~p}}function Op(n,s){var o=s&-s;return o=(o&42)!==0?1:Ru(o),(o&(n.suspendedLanes|s))!==0?0:o}function Ru(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Du(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ip(){var n=q.p;return n!==0?n:(n=window.event,n===void 0?32:wy(n.type))}function Pp(n,s){var o=q.p;try{return q.p=n,s()}finally{q.p=o}}var qi=Math.random().toString(36).slice(2),Re="__reactFiber$"+qi,Ve="__reactProps$"+qi,ua="__reactContainer$"+qi,Nu="__reactEvents$"+qi,Lw="__reactListeners$"+qi,Ow="__reactHandles$"+qi,jp="__reactResources$"+qi,Er="__reactMarker$"+qi;function Mu(n){delete n[Re],delete n[Ve],delete n[Nu],delete n[Lw],delete n[Ow]}function ha(n){var s=n[Re];if(s)return s;for(var o=n.parentNode;o;){if(s=o[ua]||o[Re]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(n=sy(n);n!==null;){if(o=n[Re])return o;n=sy(n)}return s}n=o,o=n.parentNode}return null}function da(n){if(n=n[Re]||n[ua]){var s=n.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return n}return null}function Tr(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(i(33))}function fa(n){var s=n[jp];return s||(s=n[jp]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ae(n){n[Er]=!0}var Bp=new Set,Up={};function Ds(n,s){pa(n,s),pa(n+"Capture",s)}function pa(n,s){for(Up[n]=s,n=0;n<s.length;n++)Bp.add(s[n])}var Iw=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fp={},zp={};function Pw(n){return oa.call(zp,n)?!0:oa.call(Fp,n)?!1:Iw.test(n)?zp[n]=!0:(Fp[n]=!0,!1)}function pl(n,s,o){if(Pw(s))if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+o)}}function ml(n,s,o){if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+o)}}function ci(n,s,o,h){if(h===null)n.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(s,o,""+h)}}function vn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Hp(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function jw(n,s,o){var h=Object.getOwnPropertyDescriptor(n.constructor.prototype,s);if(!n.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var p=h.get,y=h.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return p.call(this)},set:function(A){o=""+A,y.call(this,A)}}),Object.defineProperty(n,s,{enumerable:h.enumerable}),{getValue:function(){return o},setValue:function(A){o=""+A},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function ku(n){if(!n._valueTracker){var s=Hp(n)?"checked":"value";n._valueTracker=jw(n,s,""+n[s])}}function Vp(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var o=s.getValue(),h="";return n&&(h=Hp(n)?n.checked?"true":"false":n.value),n=h,n!==o?(s.setValue(n),!0):!1}function gl(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Bw=/[\n"\\]/g;function wn(n){return n.replace(Bw,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Lu(n,s,o,h,p,y,A,T){n.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?n.type=A:n.removeAttribute("type"),s!=null?A==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+vn(s)):n.value!==""+vn(s)&&(n.value=""+vn(s)):A!=="submit"&&A!=="reset"||n.removeAttribute("value"),s!=null?Ou(n,A,vn(s)):o!=null?Ou(n,A,vn(o)):h!=null&&n.removeAttribute("value"),p==null&&y!=null&&(n.defaultChecked=!!y),p!=null&&(n.checked=p&&typeof p!="function"&&typeof p!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.name=""+vn(T):n.removeAttribute("name")}function Gp(n,s,o,h,p,y,A,T){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(n.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ku(n);return}o=o!=null?""+vn(o):"",s=s!=null?""+vn(s):o,T||s===n.value||(n.value=s),n.defaultValue=s}h=h??p,h=typeof h!="function"&&typeof h!="symbol"&&!!h,n.checked=T?n.checked:!!h,n.defaultChecked=!!h,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(n.name=A),ku(n)}function Ou(n,s,o){s==="number"&&gl(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function ma(n,s,o,h){if(n=n.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<n.length;o++)p=s.hasOwnProperty("$"+n[o].value),n[o].selected!==p&&(n[o].selected=p),p&&h&&(n[o].defaultSelected=!0)}else{for(o=""+vn(o),s=null,p=0;p<n.length;p++){if(n[p].value===o){n[p].selected=!0,h&&(n[p].defaultSelected=!0);return}s!==null||n[p].disabled||(s=n[p])}s!==null&&(s.selected=!0)}}function qp(n,s,o){if(s!=null&&(s=""+vn(s),s!==n.value&&(n.value=s),o==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=o!=null?""+vn(o):""}function $p(n,s,o,h){if(s==null){if(h!=null){if(o!=null)throw Error(i(92));if(pt(h)){if(1<h.length)throw Error(i(93));h=h[0]}o=h}o==null&&(o=""),s=o}o=vn(s),n.defaultValue=o,h=n.textContent,h===o&&h!==""&&h!==null&&(n.value=h),ku(n)}function ga(n,s){if(s){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=s;return}}n.textContent=s}var Uw=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yp(n,s,o){var h=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":h?n.setProperty(s,o):typeof o!="number"||o===0||Uw.has(s)?s==="float"?n.cssFloat=o:n[s]=(""+o).trim():n[s]=o+"px"}function Xp(n,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(n=n.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?n.setProperty(h,""):h==="float"?n.cssFloat="":n[h]="");for(var p in s)h=s[p],s.hasOwnProperty(p)&&o[p]!==h&&Yp(n,p,h)}else for(var y in s)s.hasOwnProperty(y)&&Yp(n,y,s[y])}function Iu(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fw=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yl(n){return zw.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ui(){}var Pu=null;function ju(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ya=null,ba=null;function Wp(n){var s=da(n);if(s&&(n=s.stateNode)){var o=n[Ve]||null;t:switch(n=s.stateNode,s.type){case"input":if(Lu(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+wn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var h=o[s];if(h!==n&&h.form===n.form){var p=h[Ve]||null;if(!p)throw Error(i(90));Lu(h,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)h=o[s],h.form===n.form&&Vp(h)}break t;case"textarea":qp(n,o.value,o.defaultValue);break t;case"select":s=o.value,s!=null&&ma(n,!!o.multiple,s,!1)}}}var Bu=!1;function Kp(n,s,o){if(Bu)return n(s,o);Bu=!0;try{var h=n(s);return h}finally{if(Bu=!1,(ya!==null||ba!==null)&&(sc(),ya&&(s=ya,n=ba,ba=ya=null,Wp(s),n)))for(s=0;s<n.length;s++)Wp(n[s])}}function Cr(n,s){var o=n.stateNode;if(o===null)return null;var h=o[Ve]||null;if(h===null)return null;o=h[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(n=n.type,h=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!h;break t;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uu=!1;if(hi)try{var Rr={};Object.defineProperty(Rr,"passive",{get:function(){Uu=!0}}),window.addEventListener("test",Rr,Rr),window.removeEventListener("test",Rr,Rr)}catch{Uu=!1}var $i=null,Fu=null,bl=null;function Qp(){if(bl)return bl;var n,s=Fu,o=s.length,h,p="value"in $i?$i.value:$i.textContent,y=p.length;for(n=0;n<o&&s[n]===p[n];n++);var A=o-n;for(h=1;h<=A&&s[o-h]===p[y-h];h++);return bl=p.slice(n,1<h?1-h:void 0)}function vl(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function wl(){return!0}function Zp(){return!1}function Ge(n){function s(o,h,p,y,A){this._reactName=o,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=A,this.currentTarget=null;for(var T in n)n.hasOwnProperty(T)&&(o=n[T],this[T]=o?o(y):y[T]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?wl:Zp,this.isPropagationStopped=Zp,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=wl)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=wl)},persist:function(){},isPersistent:wl}),s}var Ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xl=Ge(Ns),Dr=g({},Ns,{view:0,detail:0}),Hw=Ge(Dr),zu,Hu,Nr,Al=g({},Dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gu,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Nr&&(Nr&&n.type==="mousemove"?(zu=n.screenX-Nr.screenX,Hu=n.screenY-Nr.screenY):Hu=zu=0,Nr=n),zu)},movementY:function(n){return"movementY"in n?n.movementY:Hu}}),Jp=Ge(Al),Vw=g({},Al,{dataTransfer:0}),Gw=Ge(Vw),qw=g({},Dr,{relatedTarget:0}),Vu=Ge(qw),$w=g({},Ns,{animationName:0,elapsedTime:0,pseudoElement:0}),Yw=Ge($w),Xw=g({},Ns,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ww=Ge(Xw),Kw=g({},Ns,{data:0}),tm=Ge(Kw),Qw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tx(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=Jw[n])?!!s[n]:!1}function Gu(){return tx}var ex=g({},Dr,{key:function(n){if(n.key){var s=Qw[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=vl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Zw[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gu,charCode:function(n){return n.type==="keypress"?vl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?vl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),nx=Ge(ex),ix=g({},Al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),em=Ge(ix),sx=g({},Dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gu}),ax=Ge(sx),rx=g({},Ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),ox=Ge(rx),lx=g({},Al,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),cx=Ge(lx),ux=g({},Ns,{newState:0,oldState:0}),hx=Ge(ux),dx=[9,13,27,32],qu=hi&&"CompositionEvent"in window,Mr=null;hi&&"documentMode"in document&&(Mr=document.documentMode);var fx=hi&&"TextEvent"in window&&!Mr,nm=hi&&(!qu||Mr&&8<Mr&&11>=Mr),im=" ",sm=!1;function am(n,s){switch(n){case"keyup":return dx.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rm(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var va=!1;function px(n,s){switch(n){case"compositionend":return rm(s);case"keypress":return s.which!==32?null:(sm=!0,im);case"textInput":return n=s.data,n===im&&sm?null:n;default:return null}}function mx(n,s){if(va)return n==="compositionend"||!qu&&am(n,s)?(n=Qp(),bl=Fu=$i=null,va=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return nm&&s.locale!=="ko"?null:s.data;default:return null}}var gx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function om(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!gx[n.type]:s==="textarea"}function lm(n,s,o,h){ya?ba?ba.push(h):ba=[h]:ya=h,s=hc(s,"onChange"),0<s.length&&(o=new xl("onChange","change",null,o,h),n.push({event:o,listeners:s}))}var kr=null,Lr=null;function yx(n){G0(n,0)}function Sl(n){var s=Tr(n);if(Vp(s))return n}function cm(n,s){if(n==="change")return s}var um=!1;if(hi){var $u;if(hi){var Yu="oninput"in document;if(!Yu){var hm=document.createElement("div");hm.setAttribute("oninput","return;"),Yu=typeof hm.oninput=="function"}$u=Yu}else $u=!1;um=$u&&(!document.documentMode||9<document.documentMode)}function dm(){kr&&(kr.detachEvent("onpropertychange",fm),Lr=kr=null)}function fm(n){if(n.propertyName==="value"&&Sl(Lr)){var s=[];lm(s,Lr,n,ju(n)),Kp(yx,s)}}function bx(n,s,o){n==="focusin"?(dm(),kr=s,Lr=o,kr.attachEvent("onpropertychange",fm)):n==="focusout"&&dm()}function vx(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Sl(Lr)}function wx(n,s){if(n==="click")return Sl(s)}function xx(n,s){if(n==="input"||n==="change")return Sl(s)}function Ax(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var an=typeof Object.is=="function"?Object.is:Ax;function Or(n,s){if(an(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var o=Object.keys(n),h=Object.keys(s);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var p=o[h];if(!oa.call(s,p)||!an(n[p],s[p]))return!1}return!0}function pm(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function mm(n,s){var o=pm(n);n=0;for(var h;o;){if(o.nodeType===3){if(h=n+o.textContent.length,n<=s&&h>=s)return{node:o,offset:s-n};n=h}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=pm(o)}}function gm(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?gm(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function ym(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=gl(n.document);s instanceof n.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)n=s.contentWindow;else break;s=gl(n.document)}return s}function Xu(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var Sx=hi&&"documentMode"in document&&11>=document.documentMode,wa=null,Wu=null,Ir=null,Ku=!1;function bm(n,s,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ku||wa==null||wa!==gl(h)||(h=wa,"selectionStart"in h&&Xu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ir&&Or(Ir,h)||(Ir=h,h=hc(Wu,"onSelect"),0<h.length&&(s=new xl("onSelect","select",null,s,o),n.push({event:s,listeners:h}),s.target=wa)))}function Ms(n,s){var o={};return o[n.toLowerCase()]=s.toLowerCase(),o["Webkit"+n]="webkit"+s,o["Moz"+n]="moz"+s,o}var xa={animationend:Ms("Animation","AnimationEnd"),animationiteration:Ms("Animation","AnimationIteration"),animationstart:Ms("Animation","AnimationStart"),transitionrun:Ms("Transition","TransitionRun"),transitionstart:Ms("Transition","TransitionStart"),transitioncancel:Ms("Transition","TransitionCancel"),transitionend:Ms("Transition","TransitionEnd")},Qu={},vm={};hi&&(vm=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function ks(n){if(Qu[n])return Qu[n];if(!xa[n])return n;var s=xa[n],o;for(o in s)if(s.hasOwnProperty(o)&&o in vm)return Qu[n]=s[o];return n}var wm=ks("animationend"),xm=ks("animationiteration"),Am=ks("animationstart"),_x=ks("transitionrun"),Ex=ks("transitionstart"),Tx=ks("transitioncancel"),Sm=ks("transitionend"),_m=new Map,Zu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zu.push("scrollEnd");function On(n,s){_m.set(n,s),Ds(s,[n])}var _l=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},xn=[],Aa=0,Ju=0;function El(){for(var n=Aa,s=Ju=Aa=0;s<n;){var o=xn[s];xn[s++]=null;var h=xn[s];xn[s++]=null;var p=xn[s];xn[s++]=null;var y=xn[s];if(xn[s++]=null,h!==null&&p!==null){var A=h.pending;A===null?p.next=p:(p.next=A.next,A.next=p),h.pending=p}y!==0&&Em(o,p,y)}}function Tl(n,s,o,h){xn[Aa++]=n,xn[Aa++]=s,xn[Aa++]=o,xn[Aa++]=h,Ju|=h,n.lanes|=h,n=n.alternate,n!==null&&(n.lanes|=h)}function th(n,s,o,h){return Tl(n,s,o,h),Cl(n)}function Ls(n,s){return Tl(n,null,null,s),Cl(n)}function Em(n,s,o){n.lanes|=o;var h=n.alternate;h!==null&&(h.lanes|=o);for(var p=!1,y=n.return;y!==null;)y.childLanes|=o,h=y.alternate,h!==null&&(h.childLanes|=o),y.tag===22&&(n=y.stateNode,n===null||n._visibility&1||(p=!0)),n=y,y=y.return;return n.tag===3?(y=n.stateNode,p&&s!==null&&(p=31-sn(o),n=y.hiddenUpdates,h=n[p],h===null?n[p]=[s]:h.push(s),s.lane=o|536870912),y):null}function Cl(n){if(50<io)throw io=0,cd=null,Error(i(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var Sa={};function Cx(n,s,o,h){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rn(n,s,o,h){return new Cx(n,s,o,h)}function eh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function di(n,s){var o=n.alternate;return o===null?(o=rn(n.tag,s,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=s,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,s=n.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Tm(n,s){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,s=o.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function Rl(n,s,o,h,p,y){var A=0;if(h=n,typeof n=="function")eh(n)&&(A=1);else if(typeof n=="string")A=kA(n,o,et.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case Y:return n=rn(31,o,s,p),n.elementType=Y,n.lanes=y,n;case x:return Os(o.children,p,y,s);case S:A=8,p|=24;break;case E:return n=rn(12,o,s,p|2),n.elementType=E,n.lanes=y,n;case N:return n=rn(13,o,s,p),n.elementType=N,n.lanes=y,n;case L:return n=rn(19,o,s,p),n.elementType=L,n.lanes=y,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case C:A=10;break t;case R:A=9;break t;case D:A=11;break t;case j:A=14;break t;case K:A=16,h=null;break t}A=29,o=Error(i(130,n===null?"null":typeof n,"")),h=null}return s=rn(A,o,s,p),s.elementType=n,s.type=h,s.lanes=y,s}function Os(n,s,o,h){return n=rn(7,n,h,s),n.lanes=o,n}function nh(n,s,o){return n=rn(6,n,null,s),n.lanes=o,n}function Cm(n){var s=rn(18,null,null,0);return s.stateNode=n,s}function ih(n,s,o){return s=rn(4,n.children!==null?n.children:[],n.key,s),s.lanes=o,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var Rm=new WeakMap;function An(n,s){if(typeof n=="object"&&n!==null){var o=Rm.get(n);return o!==void 0?o:(s={value:n,source:s,stack:ol(s)},Rm.set(n,s),s)}return{value:n,source:s,stack:ol(s)}}var _a=[],Ea=0,Dl=null,Pr=0,Sn=[],_n=0,Yi=null,Yn=1,Xn="";function fi(n,s){_a[Ea++]=Pr,_a[Ea++]=Dl,Dl=n,Pr=s}function Dm(n,s,o){Sn[_n++]=Yn,Sn[_n++]=Xn,Sn[_n++]=Yi,Yi=n;var h=Yn;n=Xn;var p=32-sn(h)-1;h&=~(1<<p),o+=1;var y=32-sn(s)+p;if(30<y){var A=p-p%5;y=(h&(1<<A)-1).toString(32),h>>=A,p-=A,Yn=1<<32-sn(s)+p|o<<p|h,Xn=y+n}else Yn=1<<y|o<<p|h,Xn=n}function sh(n){n.return!==null&&(fi(n,1),Dm(n,1,0))}function ah(n){for(;n===Dl;)Dl=_a[--Ea],_a[Ea]=null,Pr=_a[--Ea],_a[Ea]=null;for(;n===Yi;)Yi=Sn[--_n],Sn[_n]=null,Xn=Sn[--_n],Sn[_n]=null,Yn=Sn[--_n],Sn[_n]=null}function Nm(n,s){Sn[_n++]=Yn,Sn[_n++]=Xn,Sn[_n++]=Yi,Yn=s.id,Xn=s.overflow,Yi=n}var De=null,Wt=null,Dt=!1,Xi=null,En=!1,rh=Error(i(519));function Wi(n){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw jr(An(s,n)),rh}function Mm(n){var s=n.stateNode,o=n.type,h=n.memoizedProps;switch(s[Re]=n,s[Ve]=h,o){case"dialog":Et("cancel",s),Et("close",s);break;case"iframe":case"object":case"embed":Et("load",s);break;case"video":case"audio":for(o=0;o<ao.length;o++)Et(ao[o],s);break;case"source":Et("error",s);break;case"img":case"image":case"link":Et("error",s),Et("load",s);break;case"details":Et("toggle",s);break;case"input":Et("invalid",s),Gp(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Et("invalid",s);break;case"textarea":Et("invalid",s),$p(s,h.value,h.defaultValue,h.children)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||h.suppressHydrationWarning===!0||X0(s.textContent,o)?(h.popover!=null&&(Et("beforetoggle",s),Et("toggle",s)),h.onScroll!=null&&Et("scroll",s),h.onScrollEnd!=null&&Et("scrollend",s),h.onClick!=null&&(s.onclick=ui),s=!0):s=!1,s||Wi(n,!0)}function km(n){for(De=n.return;De;)switch(De.tag){case 5:case 31:case 13:En=!1;return;case 27:case 3:En=!0;return;default:De=De.return}}function Ta(n){if(n!==De)return!1;if(!Dt)return km(n),Dt=!0,!1;var s=n.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||_d(n.type,n.memoizedProps)),o=!o),o&&Wt&&Wi(n),km(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Wt=iy(n)}else if(s===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Wt=iy(n)}else s===27?(s=Wt,cs(n.type)?(n=Dd,Dd=null,Wt=n):Wt=s):Wt=De?Cn(n.stateNode.nextSibling):null;return!0}function Is(){Wt=De=null,Dt=!1}function oh(){var n=Xi;return n!==null&&(Xe===null?Xe=n:Xe.push.apply(Xe,n),Xi=null),n}function jr(n){Xi===null?Xi=[n]:Xi.push(n)}var lh=k(null),Ps=null,pi=null;function Ki(n,s,o){Z(lh,s._currentValue),s._currentValue=o}function mi(n){n._currentValue=lh.current,V(lh)}function ch(n,s,o){for(;n!==null;){var h=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),n===o)break;n=n.return}}function uh(n,s,o,h){var p=n.child;for(p!==null&&(p.return=n);p!==null;){var y=p.dependencies;if(y!==null){var A=p.child;y=y.firstContext;t:for(;y!==null;){var T=y;y=p;for(var M=0;M<s.length;M++)if(T.context===s[M]){y.lanes|=o,T=y.alternate,T!==null&&(T.lanes|=o),ch(y.return,o,n),h||(A=null);break t}y=T.next}}else if(p.tag===18){if(A=p.return,A===null)throw Error(i(341));A.lanes|=o,y=A.alternate,y!==null&&(y.lanes|=o),ch(A,o,n),A=null}else A=p.child;if(A!==null)A.return=p;else for(A=p;A!==null;){if(A===n){A=null;break}if(p=A.sibling,p!==null){p.return=A.return,A=p;break}A=A.return}p=A}}function Ca(n,s,o,h){n=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var A=p.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var T=p.type;an(p.pendingProps.value,A.value)||(n!==null?n.push(T):n=[T])}}else if(p===ht.current){if(A=p.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(n!==null?n.push(uo):n=[uo])}p=p.return}n!==null&&uh(s,n,o,h),s.flags|=262144}function Nl(n){for(n=n.firstContext;n!==null;){if(!an(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function js(n){Ps=n,pi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ne(n){return Lm(Ps,n)}function Ml(n,s){return Ps===null&&js(n),Lm(n,s)}function Lm(n,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},pi===null){if(n===null)throw Error(i(308));pi=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else pi=pi.next=s;return o}var Rx=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(o,h){n.push(h)}};this.abort=function(){s.aborted=!0,n.forEach(function(o){return o()})}},Dx=r.unstable_scheduleCallback,Nx=r.unstable_NormalPriority,fe={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hh(){return{controller:new Rx,data:new Map,refCount:0}}function Br(n){n.refCount--,n.refCount===0&&Dx(Nx,function(){n.controller.abort()})}var Ur=null,dh=0,Ra=0,Da=null;function Mx(n,s){if(Ur===null){var o=Ur=[];dh=0,Ra=md(),Da={status:"pending",value:void 0,then:function(h){o.push(h)}}}return dh++,s.then(Om,Om),s}function Om(){if(--dh===0&&Ur!==null){Da!==null&&(Da.status="fulfilled");var n=Ur;Ur=null,Ra=0,Da=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function kx(n,s){var o=[],h={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return n.then(function(){h.status="fulfilled",h.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(h.status="rejected",h.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),h}var Im=P.S;P.S=function(n,s){b0=je(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&Mx(n,s),Im!==null&&Im(n,s)};var Bs=k(null);function fh(){var n=Bs.current;return n!==null?n:Vt.pooledCache}function kl(n,s){s===null?Z(Bs,Bs.current):Z(Bs,s.pool)}function Pm(){var n=fh();return n===null?null:{parent:fe._currentValue,pool:n}}var Na=Error(i(460)),ph=Error(i(474)),Ll=Error(i(542)),Ol={then:function(){}};function jm(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Bm(n,s,o){switch(o=n[o],o===void 0?n.push(s):o!==s&&(s.then(ui,ui),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,Fm(n),n;default:if(typeof s.status=="string")s.then(ui,ui);else{if(n=Vt,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=s,n.status="pending",n.then(function(h){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=h}},function(h){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,Fm(n),n}throw Fs=s,Na}}function Us(n){try{var s=n._init;return s(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Fs=o,Na):o}}var Fs=null;function Um(){if(Fs===null)throw Error(i(459));var n=Fs;return Fs=null,n}function Fm(n){if(n===Na||n===Ll)throw Error(i(483))}var Ma=null,Fr=0;function Il(n){var s=Fr;return Fr+=1,Ma===null&&(Ma=[]),Bm(Ma,n,s)}function zr(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function Pl(n,s){throw s.$$typeof===v?Error(i(525)):(n=Object.prototype.toString.call(s),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function zm(n){function s(B,O){if(n){var U=B.deletions;U===null?(B.deletions=[O],B.flags|=16):U.push(O)}}function o(B,O){if(!n)return null;for(;O!==null;)s(B,O),O=O.sibling;return null}function h(B){for(var O=new Map;B!==null;)B.key!==null?O.set(B.key,B):O.set(B.index,B),B=B.sibling;return O}function p(B,O){return B=di(B,O),B.index=0,B.sibling=null,B}function y(B,O,U){return B.index=U,n?(U=B.alternate,U!==null?(U=U.index,U<O?(B.flags|=67108866,O):U):(B.flags|=67108866,O)):(B.flags|=1048576,O)}function A(B){return n&&B.alternate===null&&(B.flags|=67108866),B}function T(B,O,U,W){return O===null||O.tag!==6?(O=nh(U,B.mode,W),O.return=B,O):(O=p(O,U),O.return=B,O)}function M(B,O,U,W){var lt=U.type;return lt===x?X(B,O,U.props.children,W,U.key):O!==null&&(O.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===K&&Us(lt)===O.type)?(O=p(O,U.props),zr(O,U),O.return=B,O):(O=Rl(U.type,U.key,U.props,null,B.mode,W),zr(O,U),O.return=B,O)}function F(B,O,U,W){return O===null||O.tag!==4||O.stateNode.containerInfo!==U.containerInfo||O.stateNode.implementation!==U.implementation?(O=ih(U,B.mode,W),O.return=B,O):(O=p(O,U.children||[]),O.return=B,O)}function X(B,O,U,W,lt){return O===null||O.tag!==7?(O=Os(U,B.mode,W,lt),O.return=B,O):(O=p(O,U),O.return=B,O)}function Q(B,O,U){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=nh(""+O,B.mode,U),O.return=B,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case w:return U=Rl(O.type,O.key,O.props,null,B.mode,U),zr(U,O),U.return=B,U;case _:return O=ih(O,B.mode,U),O.return=B,O;case K:return O=Us(O),Q(B,O,U)}if(pt(O)||J(O))return O=Os(O,B.mode,U,null),O.return=B,O;if(typeof O.then=="function")return Q(B,Il(O),U);if(O.$$typeof===C)return Q(B,Ml(B,O),U);Pl(B,O)}return null}function z(B,O,U,W){var lt=O!==null?O.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return lt!==null?null:T(B,O,""+U,W);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case w:return U.key===lt?M(B,O,U,W):null;case _:return U.key===lt?F(B,O,U,W):null;case K:return U=Us(U),z(B,O,U,W)}if(pt(U)||J(U))return lt!==null?null:X(B,O,U,W,null);if(typeof U.then=="function")return z(B,O,Il(U),W);if(U.$$typeof===C)return z(B,O,Ml(B,U),W);Pl(B,U)}return null}function G(B,O,U,W,lt){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return B=B.get(U)||null,T(O,B,""+W,lt);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case w:return B=B.get(W.key===null?U:W.key)||null,M(O,B,W,lt);case _:return B=B.get(W.key===null?U:W.key)||null,F(O,B,W,lt);case K:return W=Us(W),G(B,O,U,W,lt)}if(pt(W)||J(W))return B=B.get(U)||null,X(O,B,W,lt,null);if(typeof W.then=="function")return G(B,O,U,Il(W),lt);if(W.$$typeof===C)return G(B,O,U,Ml(O,W),lt);Pl(O,W)}return null}function st(B,O,U,W){for(var lt=null,Mt=null,ot=O,At=O=0,Ct=null;ot!==null&&At<U.length;At++){ot.index>At?(Ct=ot,ot=null):Ct=ot.sibling;var kt=z(B,ot,U[At],W);if(kt===null){ot===null&&(ot=Ct);break}n&&ot&&kt.alternate===null&&s(B,ot),O=y(kt,O,At),Mt===null?lt=kt:Mt.sibling=kt,Mt=kt,ot=Ct}if(At===U.length)return o(B,ot),Dt&&fi(B,At),lt;if(ot===null){for(;At<U.length;At++)ot=Q(B,U[At],W),ot!==null&&(O=y(ot,O,At),Mt===null?lt=ot:Mt.sibling=ot,Mt=ot);return Dt&&fi(B,At),lt}for(ot=h(ot);At<U.length;At++)Ct=G(ot,B,At,U[At],W),Ct!==null&&(n&&Ct.alternate!==null&&ot.delete(Ct.key===null?At:Ct.key),O=y(Ct,O,At),Mt===null?lt=Ct:Mt.sibling=Ct,Mt=Ct);return n&&ot.forEach(function(ps){return s(B,ps)}),Dt&&fi(B,At),lt}function ft(B,O,U,W){if(U==null)throw Error(i(151));for(var lt=null,Mt=null,ot=O,At=O=0,Ct=null,kt=U.next();ot!==null&&!kt.done;At++,kt=U.next()){ot.index>At?(Ct=ot,ot=null):Ct=ot.sibling;var ps=z(B,ot,kt.value,W);if(ps===null){ot===null&&(ot=Ct);break}n&&ot&&ps.alternate===null&&s(B,ot),O=y(ps,O,At),Mt===null?lt=ps:Mt.sibling=ps,Mt=ps,ot=Ct}if(kt.done)return o(B,ot),Dt&&fi(B,At),lt;if(ot===null){for(;!kt.done;At++,kt=U.next())kt=Q(B,kt.value,W),kt!==null&&(O=y(kt,O,At),Mt===null?lt=kt:Mt.sibling=kt,Mt=kt);return Dt&&fi(B,At),lt}for(ot=h(ot);!kt.done;At++,kt=U.next())kt=G(ot,B,At,kt.value,W),kt!==null&&(n&&kt.alternate!==null&&ot.delete(kt.key===null?At:kt.key),O=y(kt,O,At),Mt===null?lt=kt:Mt.sibling=kt,Mt=kt);return n&&ot.forEach(function(VA){return s(B,VA)}),Dt&&fi(B,At),lt}function zt(B,O,U,W){if(typeof U=="object"&&U!==null&&U.type===x&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case w:t:{for(var lt=U.key;O!==null;){if(O.key===lt){if(lt=U.type,lt===x){if(O.tag===7){o(B,O.sibling),W=p(O,U.props.children),W.return=B,B=W;break t}}else if(O.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===K&&Us(lt)===O.type){o(B,O.sibling),W=p(O,U.props),zr(W,U),W.return=B,B=W;break t}o(B,O);break}else s(B,O);O=O.sibling}U.type===x?(W=Os(U.props.children,B.mode,W,U.key),W.return=B,B=W):(W=Rl(U.type,U.key,U.props,null,B.mode,W),zr(W,U),W.return=B,B=W)}return A(B);case _:t:{for(lt=U.key;O!==null;){if(O.key===lt)if(O.tag===4&&O.stateNode.containerInfo===U.containerInfo&&O.stateNode.implementation===U.implementation){o(B,O.sibling),W=p(O,U.children||[]),W.return=B,B=W;break t}else{o(B,O);break}else s(B,O);O=O.sibling}W=ih(U,B.mode,W),W.return=B,B=W}return A(B);case K:return U=Us(U),zt(B,O,U,W)}if(pt(U))return st(B,O,U,W);if(J(U)){if(lt=J(U),typeof lt!="function")throw Error(i(150));return U=lt.call(U),ft(B,O,U,W)}if(typeof U.then=="function")return zt(B,O,Il(U),W);if(U.$$typeof===C)return zt(B,O,Ml(B,U),W);Pl(B,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,O!==null&&O.tag===6?(o(B,O.sibling),W=p(O,U),W.return=B,B=W):(o(B,O),W=nh(U,B.mode,W),W.return=B,B=W),A(B)):o(B,O)}return function(B,O,U,W){try{Fr=0;var lt=zt(B,O,U,W);return Ma=null,lt}catch(ot){if(ot===Na||ot===Ll)throw ot;var Mt=rn(29,ot,null,B.mode);return Mt.lanes=W,Mt.return=B,Mt}}}var zs=zm(!0),Hm=zm(!1),Qi=!1;function mh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gh(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Zi(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ji(n,s,o){var h=n.updateQueue;if(h===null)return null;if(h=h.shared,(Lt&2)!==0){var p=h.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),h.pending=s,s=Cl(n),Em(n,null,o),s}return Tl(n,h,s,o),Cl(n)}function Hr(n,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Lp(n,o)}}function yh(n,s){var o=n.updateQueue,h=n.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var A={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=A:y=y.next=A,o=o.next}while(o!==null);y===null?p=y=s:y=y.next=s}else p=y=s;o={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,callbacks:h.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=s:n.next=s,o.lastBaseUpdate=s}var bh=!1;function Vr(){if(bh){var n=Da;if(n!==null)throw n}}function Gr(n,s,o,h){bh=!1;var p=n.updateQueue;Qi=!1;var y=p.firstBaseUpdate,A=p.lastBaseUpdate,T=p.shared.pending;if(T!==null){p.shared.pending=null;var M=T,F=M.next;M.next=null,A===null?y=F:A.next=F,A=M;var X=n.alternate;X!==null&&(X=X.updateQueue,T=X.lastBaseUpdate,T!==A&&(T===null?X.firstBaseUpdate=F:T.next=F,X.lastBaseUpdate=M))}if(y!==null){var Q=p.baseState;A=0,X=F=M=null,T=y;do{var z=T.lane&-536870913,G=z!==T.lane;if(G?(Tt&z)===z:(h&z)===z){z!==0&&z===Ra&&(bh=!0),X!==null&&(X=X.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});t:{var st=n,ft=T;z=s;var zt=o;switch(ft.tag){case 1:if(st=ft.payload,typeof st=="function"){Q=st.call(zt,Q,z);break t}Q=st;break t;case 3:st.flags=st.flags&-65537|128;case 0:if(st=ft.payload,z=typeof st=="function"?st.call(zt,Q,z):st,z==null)break t;Q=g({},Q,z);break t;case 2:Qi=!0}}z=T.callback,z!==null&&(n.flags|=64,G&&(n.flags|=8192),G=p.callbacks,G===null?p.callbacks=[z]:G.push(z))}else G={lane:z,tag:T.tag,payload:T.payload,callback:T.callback,next:null},X===null?(F=X=G,M=Q):X=X.next=G,A|=z;if(T=T.next,T===null){if(T=p.shared.pending,T===null)break;G=T,T=G.next,G.next=null,p.lastBaseUpdate=G,p.shared.pending=null}}while(!0);X===null&&(M=Q),p.baseState=M,p.firstBaseUpdate=F,p.lastBaseUpdate=X,y===null&&(p.shared.lanes=0),ss|=A,n.lanes=A,n.memoizedState=Q}}function Vm(n,s){if(typeof n!="function")throw Error(i(191,n));n.call(s)}function Gm(n,s){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)Vm(o[n],s)}var ka=k(null),jl=k(0);function qm(n,s){n=_i,Z(jl,n),Z(ka,s),_i=n|s.baseLanes}function vh(){Z(jl,_i),Z(ka,ka.current)}function wh(){_i=jl.current,V(ka),V(jl)}var on=k(null),Tn=null;function ts(n){var s=n.alternate;Z(ce,ce.current&1),Z(on,n),Tn===null&&(s===null||ka.current!==null||s.memoizedState!==null)&&(Tn=n)}function xh(n){Z(ce,ce.current),Z(on,n),Tn===null&&(Tn=n)}function $m(n){n.tag===22?(Z(ce,ce.current),Z(on,n),Tn===null&&(Tn=n)):es()}function es(){Z(ce,ce.current),Z(on,on.current)}function ln(n){V(on),Tn===n&&(Tn=null),V(ce)}var ce=k(0);function Bl(n){for(var s=n;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Cd(o)||Rd(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var gi=0,xt=null,Ut=null,pe=null,Ul=!1,La=!1,Hs=!1,Fl=0,qr=0,Oa=null,Lx=0;function oe(){throw Error(i(321))}function Ah(n,s){if(s===null)return!1;for(var o=0;o<s.length&&o<n.length;o++)if(!an(n[o],s[o]))return!1;return!0}function Sh(n,s,o,h,p,y){return gi=y,xt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,P.H=n===null||n.memoizedState===null?Dg:Bh,Hs=!1,y=o(h,p),Hs=!1,La&&(y=Xm(s,o,h,p)),Ym(n),y}function Ym(n){P.H=Xr;var s=Ut!==null&&Ut.next!==null;if(gi=0,pe=Ut=xt=null,Ul=!1,qr=0,Oa=null,s)throw Error(i(300));n===null||me||(n=n.dependencies,n!==null&&Nl(n)&&(me=!0))}function Xm(n,s,o,h){xt=n;var p=0;do{if(La&&(Oa=null),qr=0,La=!1,25<=p)throw Error(i(301));if(p+=1,pe=Ut=null,n.updateQueue!=null){var y=n.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}P.H=Ng,y=s(o,h)}while(La);return y}function Ox(){var n=P.H,s=n.useState()[0];return s=typeof s.then=="function"?$r(s):s,n=n.useState()[0],(Ut!==null?Ut.memoizedState:null)!==n&&(xt.flags|=1024),s}function _h(){var n=Fl!==0;return Fl=0,n}function Eh(n,s,o){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~o}function Th(n){if(Ul){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ul=!1}gi=0,pe=Ut=xt=null,La=!1,qr=Fl=0,Oa=null}function Be(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pe===null?xt.memoizedState=pe=n:pe=pe.next=n,pe}function ue(){if(Ut===null){var n=xt.alternate;n=n!==null?n.memoizedState:null}else n=Ut.next;var s=pe===null?xt.memoizedState:pe.next;if(s!==null)pe=s,Ut=n;else{if(n===null)throw xt.alternate===null?Error(i(467)):Error(i(310));Ut=n,n={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},pe===null?xt.memoizedState=pe=n:pe=pe.next=n}return pe}function zl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $r(n){var s=qr;return qr+=1,Oa===null&&(Oa=[]),n=Bm(Oa,n,s),s=xt,(pe===null?s.memoizedState:pe.next)===null&&(s=s.alternate,P.H=s===null||s.memoizedState===null?Dg:Bh),n}function Hl(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return $r(n);if(n.$$typeof===C)return Ne(n)}throw Error(i(438,String(n)))}function Ch(n){var s=null,o=xt.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var h=xt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=zl(),xt.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(n),h=0;h<n;h++)o[h]=$;return s.index++,o}function yi(n,s){return typeof s=="function"?s(n):s}function Vl(n){var s=ue();return Rh(s,Ut,n)}function Rh(n,s,o){var h=n.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=o;var p=n.baseQueue,y=h.pending;if(y!==null){if(p!==null){var A=p.next;p.next=y.next,y.next=A}s.baseQueue=p=y,h.pending=null}if(y=n.baseState,p===null)n.memoizedState=y;else{s=p.next;var T=A=null,M=null,F=s,X=!1;do{var Q=F.lane&-536870913;if(Q!==F.lane?(Tt&Q)===Q:(gi&Q)===Q){var z=F.revertLane;if(z===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),Q===Ra&&(X=!0);else if((gi&z)===z){F=F.next,z===Ra&&(X=!0);continue}else Q={lane:0,revertLane:F.revertLane,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},M===null?(T=M=Q,A=y):M=M.next=Q,xt.lanes|=z,ss|=z;Q=F.action,Hs&&o(y,Q),y=F.hasEagerState?F.eagerState:o(y,Q)}else z={lane:Q,revertLane:F.revertLane,gesture:F.gesture,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},M===null?(T=M=z,A=y):M=M.next=z,xt.lanes|=Q,ss|=Q;F=F.next}while(F!==null&&F!==s);if(M===null?A=y:M.next=T,!an(y,n.memoizedState)&&(me=!0,X&&(o=Da,o!==null)))throw o;n.memoizedState=y,n.baseState=A,n.baseQueue=M,h.lastRenderedState=y}return p===null&&(h.lanes=0),[n.memoizedState,h.dispatch]}function Dh(n){var s=ue(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var h=o.dispatch,p=o.pending,y=s.memoizedState;if(p!==null){o.pending=null;var A=p=p.next;do y=n(y,A.action),A=A.next;while(A!==p);an(y,s.memoizedState)||(me=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,h]}function Wm(n,s,o){var h=xt,p=ue(),y=Dt;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var A=!an((Ut||p).memoizedState,o);if(A&&(p.memoizedState=o,me=!0),p=p.queue,kh(Zm.bind(null,h,p,n),[n]),p.getSnapshot!==s||A||pe!==null&&pe.memoizedState.tag&1){if(h.flags|=2048,Ia(9,{destroy:void 0},Qm.bind(null,h,p,o,s),null),Vt===null)throw Error(i(349));y||(gi&127)!==0||Km(h,s,o)}return o}function Km(n,s,o){n.flags|=16384,n={getSnapshot:s,value:o},s=xt.updateQueue,s===null?(s=zl(),xt.updateQueue=s,s.stores=[n]):(o=s.stores,o===null?s.stores=[n]:o.push(n))}function Qm(n,s,o,h){s.value=o,s.getSnapshot=h,Jm(s)&&tg(n)}function Zm(n,s,o){return o(function(){Jm(s)&&tg(n)})}function Jm(n){var s=n.getSnapshot;n=n.value;try{var o=s();return!an(n,o)}catch{return!0}}function tg(n){var s=Ls(n,2);s!==null&&We(s,n,2)}function Nh(n){var s=Be();if(typeof n=="function"){var o=n;if(n=o(),Hs){Gi(!0);try{o()}finally{Gi(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:n},s}function eg(n,s,o,h){return n.baseState=o,Rh(n,Ut,typeof h=="function"?h:yi)}function Ix(n,s,o,h,p){if($l(n))throw Error(i(485));if(n=s.action,n!==null){var y={payload:p,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){y.listeners.push(A)}};P.T!==null?o(!0):y.isTransition=!1,h(y),o=s.pending,o===null?(y.next=s.pending=y,ng(s,y)):(y.next=o.next,s.pending=o.next=y)}}function ng(n,s){var o=s.action,h=s.payload,p=n.state;if(s.isTransition){var y=P.T,A={};P.T=A;try{var T=o(p,h),M=P.S;M!==null&&M(A,T),ig(n,s,T)}catch(F){Mh(n,s,F)}finally{y!==null&&A.types!==null&&(y.types=A.types),P.T=y}}else try{y=o(p,h),ig(n,s,y)}catch(F){Mh(n,s,F)}}function ig(n,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){sg(n,s,h)},function(h){return Mh(n,s,h)}):sg(n,s,o)}function sg(n,s,o){s.status="fulfilled",s.value=o,ag(s),n.state=o,s=n.pending,s!==null&&(o=s.next,o===s?n.pending=null:(o=o.next,s.next=o,ng(n,o)))}function Mh(n,s,o){var h=n.pending;if(n.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=o,ag(s),s=s.next;while(s!==h)}n.action=null}function ag(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function rg(n,s){return s}function og(n,s){if(Dt){var o=Vt.formState;if(o!==null){t:{var h=xt;if(Dt){if(Wt){e:{for(var p=Wt,y=En;p.nodeType!==8;){if(!y){p=null;break e}if(p=Cn(p.nextSibling),p===null){p=null;break e}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){Wt=Cn(p.nextSibling),h=p.data==="F!";break t}}Wi(h)}h=!1}h&&(s=o[0])}}return o=Be(),o.memoizedState=o.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rg,lastRenderedState:s},o.queue=h,o=Tg.bind(null,xt,h),h.dispatch=o,h=Nh(!1),y=jh.bind(null,xt,!1,h.queue),h=Be(),p={state:s,dispatch:null,action:n,pending:null},h.queue=p,o=Ix.bind(null,xt,p,y,o),p.dispatch=o,h.memoizedState=n,[s,o,!1]}function lg(n){var s=ue();return cg(s,Ut,n)}function cg(n,s,o){if(s=Rh(n,s,rg)[0],n=Vl(yi)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=$r(s)}catch(A){throw A===Na?Ll:A}else h=s;s=ue();var p=s.queue,y=p.dispatch;return o!==s.memoizedState&&(xt.flags|=2048,Ia(9,{destroy:void 0},Px.bind(null,p,o),null)),[h,y,n]}function Px(n,s){n.action=s}function ug(n){var s=ue(),o=Ut;if(o!==null)return cg(s,o,n);ue(),s=s.memoizedState,o=ue();var h=o.queue.dispatch;return o.memoizedState=n,[s,h,!1]}function Ia(n,s,o,h){return n={tag:n,create:o,deps:h,inst:s,next:null},s=xt.updateQueue,s===null&&(s=zl(),xt.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=n.next=n:(h=o.next,o.next=n,n.next=h,s.lastEffect=n),n}function hg(){return ue().memoizedState}function Gl(n,s,o,h){var p=Be();xt.flags|=n,p.memoizedState=Ia(1|s,{destroy:void 0},o,h===void 0?null:h)}function ql(n,s,o,h){var p=ue();h=h===void 0?null:h;var y=p.memoizedState.inst;Ut!==null&&h!==null&&Ah(h,Ut.memoizedState.deps)?p.memoizedState=Ia(s,y,o,h):(xt.flags|=n,p.memoizedState=Ia(1|s,y,o,h))}function dg(n,s){Gl(8390656,8,n,s)}function kh(n,s){ql(2048,8,n,s)}function jx(n){xt.flags|=4;var s=xt.updateQueue;if(s===null)s=zl(),xt.updateQueue=s,s.events=[n];else{var o=s.events;o===null?s.events=[n]:o.push(n)}}function fg(n){var s=ue().memoizedState;return jx({ref:s,nextImpl:n}),function(){if((Lt&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function pg(n,s){return ql(4,2,n,s)}function mg(n,s){return ql(4,4,n,s)}function gg(n,s){if(typeof s=="function"){n=n();var o=s(n);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function yg(n,s,o){o=o!=null?o.concat([n]):null,ql(4,4,gg.bind(null,s,n),o)}function Lh(){}function bg(n,s){var o=ue();s=s===void 0?null:s;var h=o.memoizedState;return s!==null&&Ah(s,h[1])?h[0]:(o.memoizedState=[n,s],n)}function vg(n,s){var o=ue();s=s===void 0?null:s;var h=o.memoizedState;if(s!==null&&Ah(s,h[1]))return h[0];if(h=n(),Hs){Gi(!0);try{n()}finally{Gi(!1)}}return o.memoizedState=[h,s],h}function Oh(n,s,o){return o===void 0||(gi&1073741824)!==0&&(Tt&261930)===0?n.memoizedState=s:(n.memoizedState=o,n=w0(),xt.lanes|=n,ss|=n,o)}function wg(n,s,o,h){return an(o,s)?o:ka.current!==null?(n=Oh(n,o,h),an(n,s)||(me=!0),n):(gi&42)===0||(gi&1073741824)!==0&&(Tt&261930)===0?(me=!0,n.memoizedState=o):(n=w0(),xt.lanes|=n,ss|=n,s)}function xg(n,s,o,h,p){var y=q.p;q.p=y!==0&&8>y?y:8;var A=P.T,T={};P.T=T,jh(n,!1,s,o);try{var M=p(),F=P.S;if(F!==null&&F(T,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var X=kx(M,h);Yr(n,s,X,hn(n))}else Yr(n,s,h,hn(n))}catch(Q){Yr(n,s,{then:function(){},status:"rejected",reason:Q},hn())}finally{q.p=y,A!==null&&T.types!==null&&(A.types=T.types),P.T=A}}function Bx(){}function Ih(n,s,o,h){if(n.tag!==5)throw Error(i(476));var p=Ag(n).queue;xg(n,p,s,tt,o===null?Bx:function(){return Sg(n),o(h)})}function Ag(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:tt,baseState:tt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:tt},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:o},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function Sg(n){var s=Ag(n);s.next===null&&(s=n.alternate.memoizedState),Yr(n,s.next.queue,{},hn())}function Ph(){return Ne(uo)}function _g(){return ue().memoizedState}function Eg(){return ue().memoizedState}function Ux(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var o=hn();n=Zi(o);var h=Ji(s,n,o);h!==null&&(We(h,s,o),Hr(h,s,o)),s={cache:hh()},n.payload=s;return}s=s.return}}function Fx(n,s,o){var h=hn();o={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},$l(n)?Cg(s,o):(o=th(n,s,o,h),o!==null&&(We(o,n,h),Rg(o,s,h)))}function Tg(n,s,o){var h=hn();Yr(n,s,o,h)}function Yr(n,s,o,h){var p={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if($l(n))Cg(s,p);else{var y=n.alternate;if(n.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var A=s.lastRenderedState,T=y(A,o);if(p.hasEagerState=!0,p.eagerState=T,an(T,A))return Tl(n,s,p,0),Vt===null&&El(),!1}catch{}if(o=th(n,s,p,h),o!==null)return We(o,n,h),Rg(o,s,h),!0}return!1}function jh(n,s,o,h){if(h={lane:2,revertLane:md(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},$l(n)){if(s)throw Error(i(479))}else s=th(n,o,h,2),s!==null&&We(s,n,2)}function $l(n){var s=n.alternate;return n===xt||s!==null&&s===xt}function Cg(n,s){La=Ul=!0;var o=n.pending;o===null?s.next=s:(s.next=o.next,o.next=s),n.pending=s}function Rg(n,s,o){if((o&4194048)!==0){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Lp(n,o)}}var Xr={readContext:Ne,use:Hl,useCallback:oe,useContext:oe,useEffect:oe,useImperativeHandle:oe,useLayoutEffect:oe,useInsertionEffect:oe,useMemo:oe,useReducer:oe,useRef:oe,useState:oe,useDebugValue:oe,useDeferredValue:oe,useTransition:oe,useSyncExternalStore:oe,useId:oe,useHostTransitionStatus:oe,useFormState:oe,useActionState:oe,useOptimistic:oe,useMemoCache:oe,useCacheRefresh:oe};Xr.useEffectEvent=oe;var Dg={readContext:Ne,use:Hl,useCallback:function(n,s){return Be().memoizedState=[n,s===void 0?null:s],n},useContext:Ne,useEffect:dg,useImperativeHandle:function(n,s,o){o=o!=null?o.concat([n]):null,Gl(4194308,4,gg.bind(null,s,n),o)},useLayoutEffect:function(n,s){return Gl(4194308,4,n,s)},useInsertionEffect:function(n,s){Gl(4,2,n,s)},useMemo:function(n,s){var o=Be();s=s===void 0?null:s;var h=n();if(Hs){Gi(!0);try{n()}finally{Gi(!1)}}return o.memoizedState=[h,s],h},useReducer:function(n,s,o){var h=Be();if(o!==void 0){var p=o(s);if(Hs){Gi(!0);try{o(s)}finally{Gi(!1)}}}else p=s;return h.memoizedState=h.baseState=p,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:p},h.queue=n,n=n.dispatch=Fx.bind(null,xt,n),[h.memoizedState,n]},useRef:function(n){var s=Be();return n={current:n},s.memoizedState=n},useState:function(n){n=Nh(n);var s=n.queue,o=Tg.bind(null,xt,s);return s.dispatch=o,[n.memoizedState,o]},useDebugValue:Lh,useDeferredValue:function(n,s){var o=Be();return Oh(o,n,s)},useTransition:function(){var n=Nh(!1);return n=xg.bind(null,xt,n.queue,!0,!1),Be().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,o){var h=xt,p=Be();if(Dt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),Vt===null)throw Error(i(349));(Tt&127)!==0||Km(h,s,o)}p.memoizedState=o;var y={value:o,getSnapshot:s};return p.queue=y,dg(Zm.bind(null,h,y,n),[n]),h.flags|=2048,Ia(9,{destroy:void 0},Qm.bind(null,h,y,o,s),null),o},useId:function(){var n=Be(),s=Vt.identifierPrefix;if(Dt){var o=Xn,h=Yn;o=(h&~(1<<32-sn(h)-1)).toString(32)+o,s="_"+s+"R_"+o,o=Fl++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=Lx++,s="_"+s+"r_"+o.toString(32)+"_";return n.memoizedState=s},useHostTransitionStatus:Ph,useFormState:og,useActionState:og,useOptimistic:function(n){var s=Be();s.memoizedState=s.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=jh.bind(null,xt,!0,o),o.dispatch=s,[n,s]},useMemoCache:Ch,useCacheRefresh:function(){return Be().memoizedState=Ux.bind(null,xt)},useEffectEvent:function(n){var s=Be(),o={impl:n};return s.memoizedState=o,function(){if((Lt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Bh={readContext:Ne,use:Hl,useCallback:bg,useContext:Ne,useEffect:kh,useImperativeHandle:yg,useInsertionEffect:pg,useLayoutEffect:mg,useMemo:vg,useReducer:Vl,useRef:hg,useState:function(){return Vl(yi)},useDebugValue:Lh,useDeferredValue:function(n,s){var o=ue();return wg(o,Ut.memoizedState,n,s)},useTransition:function(){var n=Vl(yi)[0],s=ue().memoizedState;return[typeof n=="boolean"?n:$r(n),s]},useSyncExternalStore:Wm,useId:_g,useHostTransitionStatus:Ph,useFormState:lg,useActionState:lg,useOptimistic:function(n,s){var o=ue();return eg(o,Ut,n,s)},useMemoCache:Ch,useCacheRefresh:Eg};Bh.useEffectEvent=fg;var Ng={readContext:Ne,use:Hl,useCallback:bg,useContext:Ne,useEffect:kh,useImperativeHandle:yg,useInsertionEffect:pg,useLayoutEffect:mg,useMemo:vg,useReducer:Dh,useRef:hg,useState:function(){return Dh(yi)},useDebugValue:Lh,useDeferredValue:function(n,s){var o=ue();return Ut===null?Oh(o,n,s):wg(o,Ut.memoizedState,n,s)},useTransition:function(){var n=Dh(yi)[0],s=ue().memoizedState;return[typeof n=="boolean"?n:$r(n),s]},useSyncExternalStore:Wm,useId:_g,useHostTransitionStatus:Ph,useFormState:ug,useActionState:ug,useOptimistic:function(n,s){var o=ue();return Ut!==null?eg(o,Ut,n,s):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Ch,useCacheRefresh:Eg};Ng.useEffectEvent=fg;function Uh(n,s,o,h){s=n.memoizedState,o=o(h,s),o=o==null?s:g({},s,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Fh={enqueueSetState:function(n,s,o){n=n._reactInternals;var h=hn(),p=Zi(h);p.payload=s,o!=null&&(p.callback=o),s=Ji(n,p,h),s!==null&&(We(s,n,h),Hr(s,n,h))},enqueueReplaceState:function(n,s,o){n=n._reactInternals;var h=hn(),p=Zi(h);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=Ji(n,p,h),s!==null&&(We(s,n,h),Hr(s,n,h))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var o=hn(),h=Zi(o);h.tag=2,s!=null&&(h.callback=s),s=Ji(n,h,o),s!==null&&(We(s,n,o),Hr(s,n,o))}};function Mg(n,s,o,h,p,y,A){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(h,y,A):s.prototype&&s.prototype.isPureReactComponent?!Or(o,h)||!Or(p,y):!0}function kg(n,s,o,h){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,h),s.state!==n&&Fh.enqueueReplaceState(s,s.state,null)}function Vs(n,s){var o=s;if("ref"in s){o={};for(var h in s)h!=="ref"&&(o[h]=s[h])}if(n=n.defaultProps){o===s&&(o=g({},o));for(var p in n)o[p]===void 0&&(o[p]=n[p])}return o}function Lg(n){_l(n)}function Og(n){console.error(n)}function Ig(n){_l(n)}function Yl(n,s){try{var o=n.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function Pg(n,s,o){try{var h=n.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function zh(n,s,o){return o=Zi(o),o.tag=3,o.payload={element:null},o.callback=function(){Yl(n,s)},o}function jg(n){return n=Zi(n),n.tag=3,n}function Bg(n,s,o,h){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=h.value;n.payload=function(){return p(y)},n.callback=function(){Pg(s,o,h)}}var A=o.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(n.callback=function(){Pg(s,o,h),typeof p!="function"&&(as===null?as=new Set([this]):as.add(this));var T=h.stack;this.componentDidCatch(h.value,{componentStack:T!==null?T:""})})}function zx(n,s,o,h,p){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=o.alternate,s!==null&&Ca(s,o,p,!0),o=on.current,o!==null){switch(o.tag){case 31:case 13:return Tn===null?ac():o.alternate===null&&le===0&&(le=3),o.flags&=-257,o.flags|=65536,o.lanes=p,h===Ol?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([h]):s.add(h),dd(n,h,p)),!1;case 22:return o.flags|=65536,h===Ol?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([h]):o.add(h)),dd(n,h,p)),!1}throw Error(i(435,o.tag))}return dd(n,h,p),ac(),!1}if(Dt)return s=on.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,h!==rh&&(n=Error(i(422),{cause:h}),jr(An(n,o)))):(h!==rh&&(s=Error(i(423),{cause:h}),jr(An(s,o))),n=n.current.alternate,n.flags|=65536,p&=-p,n.lanes|=p,h=An(h,o),p=zh(n.stateNode,h,p),yh(n,p),le!==4&&(le=2)),!1;var y=Error(i(520),{cause:h});if(y=An(y,o),no===null?no=[y]:no.push(y),le!==4&&(le=2),s===null)return!0;h=An(h,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,n=p&-p,o.lanes|=n,n=zh(o.stateNode,h,n),yh(o,n),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(as===null||!as.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=jg(p),Bg(p,n,o,h),yh(o,p),!1}o=o.return}while(o!==null);return!1}var Hh=Error(i(461)),me=!1;function Me(n,s,o,h){s.child=n===null?Hm(s,null,o,h):zs(s,n.child,o,h)}function Ug(n,s,o,h,p){o=o.render;var y=s.ref;if("ref"in h){var A={};for(var T in h)T!=="ref"&&(A[T]=h[T])}else A=h;return js(s),h=Sh(n,s,o,A,y,p),T=_h(),n!==null&&!me?(Eh(n,s,p),bi(n,s,p)):(Dt&&T&&sh(s),s.flags|=1,Me(n,s,h,p),s.child)}function Fg(n,s,o,h,p){if(n===null){var y=o.type;return typeof y=="function"&&!eh(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,zg(n,s,y,h,p)):(n=Rl(o.type,null,h,s,s.mode,p),n.ref=s.ref,n.return=s,s.child=n)}if(y=n.child,!Kh(n,p)){var A=y.memoizedProps;if(o=o.compare,o=o!==null?o:Or,o(A,h)&&n.ref===s.ref)return bi(n,s,p)}return s.flags|=1,n=di(y,h),n.ref=s.ref,n.return=s,s.child=n}function zg(n,s,o,h,p){if(n!==null){var y=n.memoizedProps;if(Or(y,h)&&n.ref===s.ref)if(me=!1,s.pendingProps=h=y,Kh(n,p))(n.flags&131072)!==0&&(me=!0);else return s.lanes=n.lanes,bi(n,s,p)}return Vh(n,s,o,h,p)}function Hg(n,s,o,h){var p=h.children,y=n!==null?n.memoizedState:null;if(n===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,n!==null){for(h=s.child=n.child,p=0;h!==null;)p=p|h.lanes|h.childLanes,h=h.sibling;h=p&~y}else h=0,s.child=null;return Vg(n,s,y,o,h)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&kl(s,y!==null?y.cachePool:null),y!==null?qm(s,y):vh(),$m(s);else return h=s.lanes=536870912,Vg(n,s,y!==null?y.baseLanes|o:o,o,h)}else y!==null?(kl(s,y.cachePool),qm(s,y),es(),s.memoizedState=null):(n!==null&&kl(s,null),vh(),es());return Me(n,s,p,o),s.child}function Wr(n,s){return n!==null&&n.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function Vg(n,s,o,h,p){var y=fh();return y=y===null?null:{parent:fe._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},n!==null&&kl(s,null),vh(),$m(s),n!==null&&Ca(n,s,h,!0),s.childLanes=p,null}function Xl(n,s){return s=Kl({mode:s.mode,children:s.children},n.mode),s.ref=n.ref,n.child=s,s.return=n,s}function Gg(n,s,o){return zs(s,n.child,null,o),n=Xl(s,s.pendingProps),n.flags|=2,ln(s),s.memoizedState=null,n}function Hx(n,s,o){var h=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,n===null){if(Dt){if(h.mode==="hidden")return n=Xl(s,h),s.lanes=536870912,Wr(null,n);if(xh(s),(n=Wt)?(n=ny(n,En),n=n!==null&&n.data==="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Yi!==null?{id:Yn,overflow:Xn}:null,retryLane:536870912,hydrationErrors:null},o=Cm(n),o.return=s,s.child=o,De=s,Wt=null)):n=null,n===null)throw Wi(s);return s.lanes=536870912,null}return Xl(s,h)}var y=n.memoizedState;if(y!==null){var A=y.dehydrated;if(xh(s),p)if(s.flags&256)s.flags&=-257,s=Gg(n,s,o);else if(s.memoizedState!==null)s.child=n.child,s.flags|=128,s=null;else throw Error(i(558));else if(me||Ca(n,s,o,!1),p=(o&n.childLanes)!==0,me||p){if(h=Vt,h!==null&&(A=Op(h,o),A!==0&&A!==y.retryLane))throw y.retryLane=A,Ls(n,A),We(h,n,A),Hh;ac(),s=Gg(n,s,o)}else n=y.treeContext,Wt=Cn(A.nextSibling),De=s,Dt=!0,Xi=null,En=!1,n!==null&&Nm(s,n),s=Xl(s,h),s.flags|=4096;return s}return n=di(n.child,{mode:h.mode,children:h.children}),n.ref=s.ref,s.child=n,n.return=s,n}function Wl(n,s){var o=s.ref;if(o===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(s.flags|=4194816)}}function Vh(n,s,o,h,p){return js(s),o=Sh(n,s,o,h,void 0,p),h=_h(),n!==null&&!me?(Eh(n,s,p),bi(n,s,p)):(Dt&&h&&sh(s),s.flags|=1,Me(n,s,o,p),s.child)}function qg(n,s,o,h,p,y){return js(s),s.updateQueue=null,o=Xm(s,h,o,p),Ym(n),h=_h(),n!==null&&!me?(Eh(n,s,y),bi(n,s,y)):(Dt&&h&&sh(s),s.flags|=1,Me(n,s,o,y),s.child)}function $g(n,s,o,h,p){if(js(s),s.stateNode===null){var y=Sa,A=o.contextType;typeof A=="object"&&A!==null&&(y=Ne(A)),y=new o(h,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Fh,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=h,y.state=s.memoizedState,y.refs={},mh(s),A=o.contextType,y.context=typeof A=="object"&&A!==null?Ne(A):Sa,y.state=s.memoizedState,A=o.getDerivedStateFromProps,typeof A=="function"&&(Uh(s,o,A,h),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(A=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),A!==y.state&&Fh.enqueueReplaceState(y,y.state,null),Gr(s,h,y,p),Vr(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(n===null){y=s.stateNode;var T=s.memoizedProps,M=Vs(o,T);y.props=M;var F=y.context,X=o.contextType;A=Sa,typeof X=="object"&&X!==null&&(A=Ne(X));var Q=o.getDerivedStateFromProps;X=typeof Q=="function"||typeof y.getSnapshotBeforeUpdate=="function",T=s.pendingProps!==T,X||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T||F!==A)&&kg(s,y,h,A),Qi=!1;var z=s.memoizedState;y.state=z,Gr(s,h,y,p),Vr(),F=s.memoizedState,T||z!==F||Qi?(typeof Q=="function"&&(Uh(s,o,Q,h),F=s.memoizedState),(M=Qi||Mg(s,o,M,h,z,F,A))?(X||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=F),y.props=h,y.state=F,y.context=A,h=M):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{y=s.stateNode,gh(n,s),A=s.memoizedProps,X=Vs(o,A),y.props=X,Q=s.pendingProps,z=y.context,F=o.contextType,M=Sa,typeof F=="object"&&F!==null&&(M=Ne(F)),T=o.getDerivedStateFromProps,(F=typeof T=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(A!==Q||z!==M)&&kg(s,y,h,M),Qi=!1,z=s.memoizedState,y.state=z,Gr(s,h,y,p),Vr();var G=s.memoizedState;A!==Q||z!==G||Qi||n!==null&&n.dependencies!==null&&Nl(n.dependencies)?(typeof T=="function"&&(Uh(s,o,T,h),G=s.memoizedState),(X=Qi||Mg(s,o,X,h,z,G,M)||n!==null&&n.dependencies!==null&&Nl(n.dependencies))?(F||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(h,G,M),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(h,G,M)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||A===n.memoizedProps&&z===n.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&z===n.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=G),y.props=h,y.state=G,y.context=M,h=X):(typeof y.componentDidUpdate!="function"||A===n.memoizedProps&&z===n.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&z===n.memoizedState||(s.flags|=1024),h=!1)}return y=h,Wl(n,s),h=(s.flags&128)!==0,y||h?(y=s.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,n!==null&&h?(s.child=zs(s,n.child,null,p),s.child=zs(s,null,o,p)):Me(n,s,o,p),s.memoizedState=y.state,n=s.child):n=bi(n,s,p),n}function Yg(n,s,o,h){return Is(),s.flags|=256,Me(n,s,o,h),s.child}var Gh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qh(n){return{baseLanes:n,cachePool:Pm()}}function $h(n,s,o){return n=n!==null?n.childLanes&~o:0,s&&(n|=un),n}function Xg(n,s,o){var h=s.pendingProps,p=!1,y=(s.flags&128)!==0,A;if((A=y)||(A=n!==null&&n.memoizedState===null?!1:(ce.current&2)!==0),A&&(p=!0,s.flags&=-129),A=(s.flags&32)!==0,s.flags&=-33,n===null){if(Dt){if(p?ts(s):es(),(n=Wt)?(n=ny(n,En),n=n!==null&&n.data!=="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Yi!==null?{id:Yn,overflow:Xn}:null,retryLane:536870912,hydrationErrors:null},o=Cm(n),o.return=s,s.child=o,De=s,Wt=null)):n=null,n===null)throw Wi(s);return Rd(n)?s.lanes=32:s.lanes=536870912,null}var T=h.children;return h=h.fallback,p?(es(),p=s.mode,T=Kl({mode:"hidden",children:T},p),h=Os(h,p,o,null),T.return=s,h.return=s,T.sibling=h,s.child=T,h=s.child,h.memoizedState=qh(o),h.childLanes=$h(n,A,o),s.memoizedState=Gh,Wr(null,h)):(ts(s),Yh(s,T))}var M=n.memoizedState;if(M!==null&&(T=M.dehydrated,T!==null)){if(y)s.flags&256?(ts(s),s.flags&=-257,s=Xh(n,s,o)):s.memoizedState!==null?(es(),s.child=n.child,s.flags|=128,s=null):(es(),T=h.fallback,p=s.mode,h=Kl({mode:"visible",children:h.children},p),T=Os(T,p,o,null),T.flags|=2,h.return=s,T.return=s,h.sibling=T,s.child=h,zs(s,n.child,null,o),h=s.child,h.memoizedState=qh(o),h.childLanes=$h(n,A,o),s.memoizedState=Gh,s=Wr(null,h));else if(ts(s),Rd(T)){if(A=T.nextSibling&&T.nextSibling.dataset,A)var F=A.dgst;A=F,h=Error(i(419)),h.stack="",h.digest=A,jr({value:h,source:null,stack:null}),s=Xh(n,s,o)}else if(me||Ca(n,s,o,!1),A=(o&n.childLanes)!==0,me||A){if(A=Vt,A!==null&&(h=Op(A,o),h!==0&&h!==M.retryLane))throw M.retryLane=h,Ls(n,h),We(A,n,h),Hh;Cd(T)||ac(),s=Xh(n,s,o)}else Cd(T)?(s.flags|=192,s.child=n.child,s=null):(n=M.treeContext,Wt=Cn(T.nextSibling),De=s,Dt=!0,Xi=null,En=!1,n!==null&&Nm(s,n),s=Yh(s,h.children),s.flags|=4096);return s}return p?(es(),T=h.fallback,p=s.mode,M=n.child,F=M.sibling,h=di(M,{mode:"hidden",children:h.children}),h.subtreeFlags=M.subtreeFlags&65011712,F!==null?T=di(F,T):(T=Os(T,p,o,null),T.flags|=2),T.return=s,h.return=s,h.sibling=T,s.child=h,Wr(null,h),h=s.child,T=n.child.memoizedState,T===null?T=qh(o):(p=T.cachePool,p!==null?(M=fe._currentValue,p=p.parent!==M?{parent:M,pool:M}:p):p=Pm(),T={baseLanes:T.baseLanes|o,cachePool:p}),h.memoizedState=T,h.childLanes=$h(n,A,o),s.memoizedState=Gh,Wr(n.child,h)):(ts(s),o=n.child,n=o.sibling,o=di(o,{mode:"visible",children:h.children}),o.return=s,o.sibling=null,n!==null&&(A=s.deletions,A===null?(s.deletions=[n],s.flags|=16):A.push(n)),s.child=o,s.memoizedState=null,o)}function Yh(n,s){return s=Kl({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function Kl(n,s){return n=rn(22,n,null,s),n.lanes=0,n}function Xh(n,s,o){return zs(s,n.child,null,o),n=Yh(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function Wg(n,s,o){n.lanes|=s;var h=n.alternate;h!==null&&(h.lanes|=s),ch(n.return,s,o)}function Wh(n,s,o,h,p,y){var A=n.memoizedState;A===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:p,treeForkCount:y}:(A.isBackwards=s,A.rendering=null,A.renderingStartTime=0,A.last=h,A.tail=o,A.tailMode=p,A.treeForkCount=y)}function Kg(n,s,o){var h=s.pendingProps,p=h.revealOrder,y=h.tail;h=h.children;var A=ce.current,T=(A&2)!==0;if(T?(A=A&1|2,s.flags|=128):A&=1,Z(ce,A),Me(n,s,h,o),h=Dt?Pr:0,!T&&n!==null&&(n.flags&128)!==0)t:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Wg(n,o,s);else if(n.tag===19)Wg(n,o,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break t;for(;n.sibling===null;){if(n.return===null||n.return===s)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)n=o.alternate,n!==null&&Bl(n)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),Wh(s,!1,p,o,y,h);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(n=p.alternate,n!==null&&Bl(n)===null){s.child=p;break}n=p.sibling,p.sibling=o,o=p,p=n}Wh(s,!0,o,null,y,h);break;case"together":Wh(s,!1,null,null,void 0,h);break;default:s.memoizedState=null}return s.child}function bi(n,s,o){if(n!==null&&(s.dependencies=n.dependencies),ss|=s.lanes,(o&s.childLanes)===0)if(n!==null){if(Ca(n,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(i(153));if(s.child!==null){for(n=s.child,o=di(n,n.pendingProps),s.child=o,o.return=s;n.sibling!==null;)n=n.sibling,o=o.sibling=di(n,n.pendingProps),o.return=s;o.sibling=null}return s.child}function Kh(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&Nl(n)))}function Vx(n,s,o){switch(s.tag){case 3:ae(s,s.stateNode.containerInfo),Ki(s,fe,n.memoizedState.cache),Is();break;case 27:case 5:Gn(s);break;case 4:ae(s,s.stateNode.containerInfo);break;case 10:Ki(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,xh(s),null;break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(ts(s),s.flags|=128,null):(o&s.child.childLanes)!==0?Xg(n,s,o):(ts(s),n=bi(n,s,o),n!==null?n.sibling:null);ts(s);break;case 19:var p=(n.flags&128)!==0;if(h=(o&s.childLanes)!==0,h||(Ca(n,s,o,!1),h=(o&s.childLanes)!==0),p){if(h)return Kg(n,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Z(ce,ce.current),h)break;return null;case 22:return s.lanes=0,Hg(n,s,o,s.pendingProps);case 24:Ki(s,fe,n.memoizedState.cache)}return bi(n,s,o)}function Qg(n,s,o){if(n!==null)if(n.memoizedProps!==s.pendingProps)me=!0;else{if(!Kh(n,o)&&(s.flags&128)===0)return me=!1,Vx(n,s,o);me=(n.flags&131072)!==0}else me=!1,Dt&&(s.flags&1048576)!==0&&Dm(s,Pr,s.index);switch(s.lanes=0,s.tag){case 16:t:{var h=s.pendingProps;if(n=Us(s.elementType),s.type=n,typeof n=="function")eh(n)?(h=Vs(n,h),s.tag=1,s=$g(null,s,n,h,o)):(s.tag=0,s=Vh(null,s,n,h,o));else{if(n!=null){var p=n.$$typeof;if(p===D){s.tag=11,s=Ug(null,s,n,h,o);break t}else if(p===j){s.tag=14,s=Fg(null,s,n,h,o);break t}}throw s=rt(n)||n,Error(i(306,s,""))}}return s;case 0:return Vh(n,s,s.type,s.pendingProps,o);case 1:return h=s.type,p=Vs(h,s.pendingProps),$g(n,s,h,p,o);case 3:t:{if(ae(s,s.stateNode.containerInfo),n===null)throw Error(i(387));h=s.pendingProps;var y=s.memoizedState;p=y.element,gh(n,s),Gr(s,h,null,o);var A=s.memoizedState;if(h=A.cache,Ki(s,fe,h),h!==y.cache&&uh(s,[fe],o,!0),Vr(),h=A.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:A.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=Yg(n,s,h,o);break t}else if(h!==p){p=An(Error(i(424)),s),jr(p),s=Yg(n,s,h,o);break t}else for(n=s.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Wt=Cn(n.firstChild),De=s,Dt=!0,Xi=null,En=!0,o=Hm(s,null,h,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Is(),h===p){s=bi(n,s,o);break t}Me(n,s,h,o)}s=s.child}return s;case 26:return Wl(n,s),n===null?(o=ly(s.type,null,s.pendingProps,null))?s.memoizedState=o:Dt||(o=s.type,n=s.pendingProps,h=dc(gt.current).createElement(o),h[Re]=s,h[Ve]=n,ke(h,o,n),Ae(h),s.stateNode=h):s.memoizedState=ly(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return Gn(s),n===null&&Dt&&(h=s.stateNode=ay(s.type,s.pendingProps,gt.current),De=s,En=!0,p=Wt,cs(s.type)?(Dd=p,Wt=Cn(h.firstChild)):Wt=p),Me(n,s,s.pendingProps.children,o),Wl(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&Dt&&((p=h=Wt)&&(h=vA(h,s.type,s.pendingProps,En),h!==null?(s.stateNode=h,De=s,Wt=Cn(h.firstChild),En=!1,p=!0):p=!1),p||Wi(s)),Gn(s),p=s.type,y=s.pendingProps,A=n!==null?n.memoizedProps:null,h=y.children,_d(p,y)?h=null:A!==null&&_d(p,A)&&(s.flags|=32),s.memoizedState!==null&&(p=Sh(n,s,Ox,null,null,o),uo._currentValue=p),Wl(n,s),Me(n,s,h,o),s.child;case 6:return n===null&&Dt&&((n=o=Wt)&&(o=wA(o,s.pendingProps,En),o!==null?(s.stateNode=o,De=s,Wt=null,n=!0):n=!1),n||Wi(s)),null;case 13:return Xg(n,s,o);case 4:return ae(s,s.stateNode.containerInfo),h=s.pendingProps,n===null?s.child=zs(s,null,h,o):Me(n,s,h,o),s.child;case 11:return Ug(n,s,s.type,s.pendingProps,o);case 7:return Me(n,s,s.pendingProps,o),s.child;case 8:return Me(n,s,s.pendingProps.children,o),s.child;case 12:return Me(n,s,s.pendingProps.children,o),s.child;case 10:return h=s.pendingProps,Ki(s,s.type,h.value),Me(n,s,h.children,o),s.child;case 9:return p=s.type._context,h=s.pendingProps.children,js(s),p=Ne(p),h=h(p),s.flags|=1,Me(n,s,h,o),s.child;case 14:return Fg(n,s,s.type,s.pendingProps,o);case 15:return zg(n,s,s.type,s.pendingProps,o);case 19:return Kg(n,s,o);case 31:return Hx(n,s,o);case 22:return Hg(n,s,o,s.pendingProps);case 24:return js(s),h=Ne(fe),n===null?(p=fh(),p===null&&(p=Vt,y=hh(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),s.memoizedState={parent:h,cache:p},mh(s),Ki(s,fe,p)):((n.lanes&o)!==0&&(gh(n,s),Gr(s,null,null,o),Vr()),p=n.memoizedState,y=s.memoizedState,p.parent!==h?(p={parent:h,cache:h},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),Ki(s,fe,h)):(h=y.cache,Ki(s,fe,h),h!==p.cache&&uh(s,[fe],o,!0))),Me(n,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function vi(n){n.flags|=4}function Qh(n,s,o,h,p){if((s=(n.mode&32)!==0)&&(s=!1),s){if(n.flags|=16777216,(p&335544128)===p)if(n.stateNode.complete)n.flags|=8192;else if(_0())n.flags|=8192;else throw Fs=Ol,ph}else n.flags&=-16777217}function Zg(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!fy(s))if(_0())n.flags|=8192;else throw Fs=Ol,ph}function Ql(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?Mp():536870912,n.lanes|=s,Ua|=s)}function Kr(n,s){if(!Dt)switch(n.tailMode){case"hidden":s=n.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:h.sibling=null}}function Kt(n){var s=n.alternate!==null&&n.alternate.child===n.child,o=0,h=0;if(s)for(var p=n.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags&65011712,h|=p.flags&65011712,p.return=n,p=p.sibling;else for(p=n.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=n,p=p.sibling;return n.subtreeFlags|=h,n.childLanes=o,s}function Gx(n,s,o){var h=s.pendingProps;switch(ah(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(s),null;case 1:return Kt(s),null;case 3:return o=s.stateNode,h=null,n!==null&&(h=n.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),mi(fe),Pt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(Ta(s)?vi(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,oh())),Kt(s),null;case 26:var p=s.type,y=s.memoizedState;return n===null?(vi(s),y!==null?(Kt(s),Zg(s,y)):(Kt(s),Qh(s,p,null,h,o))):y?y!==n.memoizedState?(vi(s),Kt(s),Zg(s,y)):(Kt(s),s.flags&=-16777217):(n=n.memoizedProps,n!==h&&vi(s),Kt(s),Qh(s,p,n,h,o)),null;case 27:if(qn(s),o=gt.current,p=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&vi(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Kt(s),null}n=et.current,Ta(s)?Mm(s):(n=ay(p,h,o),s.stateNode=n,vi(s))}return Kt(s),null;case 5:if(qn(s),p=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&vi(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Kt(s),null}if(y=et.current,Ta(s))Mm(s);else{var A=dc(gt.current);switch(y){case 1:y=A.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=A.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=A.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof h.is=="string"?A.createElement("select",{is:h.is}):A.createElement("select"),h.multiple?y.multiple=!0:h.size&&(y.size=h.size);break;default:y=typeof h.is=="string"?A.createElement(p,{is:h.is}):A.createElement(p)}}y[Re]=s,y[Ve]=h;t:for(A=s.child;A!==null;){if(A.tag===5||A.tag===6)y.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===s)break t;for(;A.sibling===null;){if(A.return===null||A.return===s)break t;A=A.return}A.sibling.return=A.return,A=A.sibling}s.stateNode=y;t:switch(ke(y,p,h),p){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&vi(s)}}return Kt(s),Qh(s,s.type,n===null?null:n.memoizedProps,s.pendingProps,o),null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==h&&vi(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(i(166));if(n=gt.current,Ta(s)){if(n=s.stateNode,o=s.memoizedProps,h=null,p=De,p!==null)switch(p.tag){case 27:case 5:h=p.memoizedProps}n[Re]=s,n=!!(n.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||X0(n.nodeValue,o)),n||Wi(s,!0)}else n=dc(n).createTextNode(h),n[Re]=s,s.stateNode=n}return Kt(s),null;case 31:if(o=s.memoizedState,n===null||n.memoizedState!==null){if(h=Ta(s),o!==null){if(n===null){if(!h)throw Error(i(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Re]=s}else Is(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Kt(s),n=!1}else o=oh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return s.flags&256?(ln(s),s):(ln(s),null);if((s.flags&128)!==0)throw Error(i(558))}return Kt(s),null;case 13:if(h=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(p=Ta(s),h!==null&&h.dehydrated!==null){if(n===null){if(!p)throw Error(i(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Re]=s}else Is(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Kt(s),p=!1}else p=oh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(ln(s),s):(ln(s),null)}return ln(s),(s.flags&128)!==0?(s.lanes=o,s):(o=h!==null,n=n!==null&&n.memoizedState!==null,o&&(h=s.child,p=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(p=h.alternate.memoizedState.cachePool.pool),y=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==p&&(h.flags|=2048)),o!==n&&o&&(s.child.flags|=8192),Ql(s,s.updateQueue),Kt(s),null);case 4:return Pt(),n===null&&vd(s.stateNode.containerInfo),Kt(s),null;case 10:return mi(s.type),Kt(s),null;case 19:if(V(ce),h=s.memoizedState,h===null)return Kt(s),null;if(p=(s.flags&128)!==0,y=h.rendering,y===null)if(p)Kr(h,!1);else{if(le!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(y=Bl(n),y!==null){for(s.flags|=128,Kr(h,!1),n=y.updateQueue,s.updateQueue=n,Ql(s,n),s.subtreeFlags=0,n=o,o=s.child;o!==null;)Tm(o,n),o=o.sibling;return Z(ce,ce.current&1|2),Dt&&fi(s,h.treeForkCount),s.child}n=n.sibling}h.tail!==null&&je()>nc&&(s.flags|=128,p=!0,Kr(h,!1),s.lanes=4194304)}else{if(!p)if(n=Bl(y),n!==null){if(s.flags|=128,p=!0,n=n.updateQueue,s.updateQueue=n,Ql(s,n),Kr(h,!0),h.tail===null&&h.tailMode==="hidden"&&!y.alternate&&!Dt)return Kt(s),null}else 2*je()-h.renderingStartTime>nc&&o!==536870912&&(s.flags|=128,p=!0,Kr(h,!1),s.lanes=4194304);h.isBackwards?(y.sibling=s.child,s.child=y):(n=h.last,n!==null?n.sibling=y:s.child=y,h.last=y)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=je(),n.sibling=null,o=ce.current,Z(ce,p?o&1|2:o&1),Dt&&fi(s,h.treeForkCount),n):(Kt(s),null);case 22:case 23:return ln(s),wh(),h=s.memoizedState!==null,n!==null?n.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(o&536870912)!==0&&(s.flags&128)===0&&(Kt(s),s.subtreeFlags&6&&(s.flags|=8192)):Kt(s),o=s.updateQueue,o!==null&&Ql(s,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==o&&(s.flags|=2048),n!==null&&V(Bs),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),mi(fe),Kt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function qx(n,s){switch(ah(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return mi(fe),Pt(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return qn(s),null;case 31:if(s.memoizedState!==null){if(ln(s),s.alternate===null)throw Error(i(340));Is()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 13:if(ln(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Is()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return V(ce),null;case 4:return Pt(),null;case 10:return mi(s.type),null;case 22:case 23:return ln(s),wh(),n!==null&&V(Bs),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return mi(fe),null;case 25:return null;default:return null}}function Jg(n,s){switch(ah(s),s.tag){case 3:mi(fe),Pt();break;case 26:case 27:case 5:qn(s);break;case 4:Pt();break;case 31:s.memoizedState!==null&&ln(s);break;case 13:ln(s);break;case 19:V(ce);break;case 10:mi(s.type);break;case 22:case 23:ln(s),wh(),n!==null&&V(Bs);break;case 24:mi(fe)}}function Qr(n,s){try{var o=s.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var p=h.next;o=p;do{if((o.tag&n)===n){h=void 0;var y=o.create,A=o.inst;h=y(),A.destroy=h}o=o.next}while(o!==p)}}catch(T){Bt(s,s.return,T)}}function ns(n,s,o){try{var h=s.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var y=p.next;h=y;do{if((h.tag&n)===n){var A=h.inst,T=A.destroy;if(T!==void 0){A.destroy=void 0,p=s;var M=o,F=T;try{F()}catch(X){Bt(p,M,X)}}}h=h.next}while(h!==y)}}catch(X){Bt(s,s.return,X)}}function t0(n){var s=n.updateQueue;if(s!==null){var o=n.stateNode;try{Gm(s,o)}catch(h){Bt(n,n.return,h)}}}function e0(n,s,o){o.props=Vs(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(h){Bt(n,s,h)}}function Zr(n,s){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var h=n.stateNode;break;case 30:h=n.stateNode;break;default:h=n.stateNode}typeof o=="function"?n.refCleanup=o(h):o.current=h}}catch(p){Bt(n,s,p)}}function Wn(n,s){var o=n.ref,h=n.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(p){Bt(n,s,p)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){Bt(n,s,p)}else o.current=null}function n0(n){var s=n.type,o=n.memoizedProps,h=n.stateNode;try{t:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break t;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(p){Bt(n,n.return,p)}}function Zh(n,s,o){try{var h=n.stateNode;fA(h,n.type,o,s),h[Ve]=s}catch(p){Bt(n,n.return,p)}}function i0(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&cs(n.type)||n.tag===4}function Jh(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||i0(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&cs(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function td(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(n),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=ui));else if(h!==4&&(h===27&&cs(n.type)&&(o=n.stateNode,s=null),n=n.child,n!==null))for(td(n,s,o),n=n.sibling;n!==null;)td(n,s,o),n=n.sibling}function Zl(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?o.insertBefore(n,s):o.appendChild(n);else if(h!==4&&(h===27&&cs(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Zl(n,s,o),n=n.sibling;n!==null;)Zl(n,s,o),n=n.sibling}function s0(n){var s=n.stateNode,o=n.memoizedProps;try{for(var h=n.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);ke(s,h,o),s[Re]=n,s[Ve]=o}catch(y){Bt(n,n.return,y)}}var wi=!1,ge=!1,ed=!1,a0=typeof WeakSet=="function"?WeakSet:Set,Se=null;function $x(n,s){if(n=n.containerInfo,Ad=vc,n=ym(n),Xu(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else t:{o=(o=n.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break t}var A=0,T=-1,M=-1,F=0,X=0,Q=n,z=null;e:for(;;){for(var G;Q!==o||p!==0&&Q.nodeType!==3||(T=A+p),Q!==y||h!==0&&Q.nodeType!==3||(M=A+h),Q.nodeType===3&&(A+=Q.nodeValue.length),(G=Q.firstChild)!==null;)z=Q,Q=G;for(;;){if(Q===n)break e;if(z===o&&++F===p&&(T=A),z===y&&++X===h&&(M=A),(G=Q.nextSibling)!==null)break;Q=z,z=Q.parentNode}Q=G}o=T===-1||M===-1?null:{start:T,end:M}}else o=null}o=o||{start:0,end:0}}else o=null;for(Sd={focusedElem:n,selectionRange:o},vc=!1,Se=s;Se!==null;)if(s=Se,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Se=n;else for(;Se!==null;){switch(s=Se,y=s.alternate,n=s.flags,s.tag){case 0:if((n&4)!==0&&(n=s.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)p=n[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&y!==null){n=void 0,o=s,p=y.memoizedProps,y=y.memoizedState,h=o.stateNode;try{var st=Vs(o.type,p);n=h.getSnapshotBeforeUpdate(st,y),h.__reactInternalSnapshotBeforeUpdate=n}catch(ft){Bt(o,o.return,ft)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,o=n.nodeType,o===9)Td(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Td(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=s.sibling,n!==null){n.return=s.return,Se=n;break}Se=s.return}}function r0(n,s,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:Ai(n,o),h&4&&Qr(5,o);break;case 1:if(Ai(n,o),h&4)if(n=o.stateNode,s===null)try{n.componentDidMount()}catch(A){Bt(o,o.return,A)}else{var p=Vs(o.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(p,s,n.__reactInternalSnapshotBeforeUpdate)}catch(A){Bt(o,o.return,A)}}h&64&&t0(o),h&512&&Zr(o,o.return);break;case 3:if(Ai(n,o),h&64&&(n=o.updateQueue,n!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{Gm(n,s)}catch(A){Bt(o,o.return,A)}}break;case 27:s===null&&h&4&&s0(o);case 26:case 5:Ai(n,o),s===null&&h&4&&n0(o),h&512&&Zr(o,o.return);break;case 12:Ai(n,o);break;case 31:Ai(n,o),h&4&&c0(n,o);break;case 13:Ai(n,o),h&4&&u0(n,o),h&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=eA.bind(null,o),xA(n,o))));break;case 22:if(h=o.memoizedState!==null||wi,!h){s=s!==null&&s.memoizedState!==null||ge,p=wi;var y=ge;wi=h,(ge=s)&&!y?Si(n,o,(o.subtreeFlags&8772)!==0):Ai(n,o),wi=p,ge=y}break;case 30:break;default:Ai(n,o)}}function o0(n){var s=n.alternate;s!==null&&(n.alternate=null,o0(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&Mu(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Qt=null,qe=!1;function xi(n,s,o){for(o=o.child;o!==null;)l0(n,s,o),o=o.sibling}function l0(n,s,o){if(nn&&typeof nn.onCommitFiberUnmount=="function")try{nn.onCommitFiberUnmount(Vi,o)}catch{}switch(o.tag){case 26:ge||Wn(o,s),xi(n,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ge||Wn(o,s);var h=Qt,p=qe;cs(o.type)&&(Qt=o.stateNode,qe=!1),xi(n,s,o),oo(o.stateNode),Qt=h,qe=p;break;case 5:ge||Wn(o,s);case 6:if(h=Qt,p=qe,Qt=null,xi(n,s,o),Qt=h,qe=p,Qt!==null)if(qe)try{(Qt.nodeType===9?Qt.body:Qt.nodeName==="HTML"?Qt.ownerDocument.body:Qt).removeChild(o.stateNode)}catch(y){Bt(o,s,y)}else try{Qt.removeChild(o.stateNode)}catch(y){Bt(o,s,y)}break;case 18:Qt!==null&&(qe?(n=Qt,ty(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Ya(n)):ty(Qt,o.stateNode));break;case 4:h=Qt,p=qe,Qt=o.stateNode.containerInfo,qe=!0,xi(n,s,o),Qt=h,qe=p;break;case 0:case 11:case 14:case 15:ns(2,o,s),ge||ns(4,o,s),xi(n,s,o);break;case 1:ge||(Wn(o,s),h=o.stateNode,typeof h.componentWillUnmount=="function"&&e0(o,s,h)),xi(n,s,o);break;case 21:xi(n,s,o);break;case 22:ge=(h=ge)||o.memoizedState!==null,xi(n,s,o),ge=h;break;default:xi(n,s,o)}}function c0(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Ya(n)}catch(o){Bt(s,s.return,o)}}}function u0(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Ya(n)}catch(o){Bt(s,s.return,o)}}function Yx(n){switch(n.tag){case 31:case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new a0),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new a0),s;default:throw Error(i(435,n.tag))}}function Jl(n,s){var o=Yx(n);s.forEach(function(h){if(!o.has(h)){o.add(h);var p=nA.bind(null,n,h);h.then(p,p)}})}function $e(n,s){var o=s.deletions;if(o!==null)for(var h=0;h<o.length;h++){var p=o[h],y=n,A=s,T=A;t:for(;T!==null;){switch(T.tag){case 27:if(cs(T.type)){Qt=T.stateNode,qe=!1;break t}break;case 5:Qt=T.stateNode,qe=!1;break t;case 3:case 4:Qt=T.stateNode.containerInfo,qe=!0;break t}T=T.return}if(Qt===null)throw Error(i(160));l0(y,A,p),Qt=null,qe=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)h0(s,n),s=s.sibling}var In=null;function h0(n,s){var o=n.alternate,h=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:$e(s,n),Ye(n),h&4&&(ns(3,n,n.return),Qr(3,n),ns(5,n,n.return));break;case 1:$e(s,n),Ye(n),h&512&&(ge||o===null||Wn(o,o.return)),h&64&&wi&&(n=n.updateQueue,n!==null&&(h=n.callbacks,h!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var p=In;if($e(s,n),Ye(n),h&512&&(ge||o===null||Wn(o,o.return)),h&4){var y=o!==null?o.memoizedState:null;if(h=n.memoizedState,o===null)if(h===null)if(n.stateNode===null){t:{h=n.type,o=n.memoizedProps,p=p.ownerDocument||p;e:switch(h){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Er]||y[Re]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(h),p.head.insertBefore(y,p.querySelector("head > title"))),ke(y,h,o),y[Re]=n,Ae(y),h=y;break t;case"link":var A=hy("link","href",p).get(h+(o.href||""));if(A){for(var T=0;T<A.length;T++)if(y=A[T],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){A.splice(T,1);break e}}y=p.createElement(h),ke(y,h,o),p.head.appendChild(y);break;case"meta":if(A=hy("meta","content",p).get(h+(o.content||""))){for(T=0;T<A.length;T++)if(y=A[T],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){A.splice(T,1);break e}}y=p.createElement(h),ke(y,h,o),p.head.appendChild(y);break;default:throw Error(i(468,h))}y[Re]=n,Ae(y),h=y}n.stateNode=h}else dy(p,n.type,n.stateNode);else n.stateNode=uy(p,h,n.memoizedProps);else y!==h?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,h===null?dy(p,n.type,n.stateNode):uy(p,h,n.memoizedProps)):h===null&&n.stateNode!==null&&Zh(n,n.memoizedProps,o.memoizedProps)}break;case 27:$e(s,n),Ye(n),h&512&&(ge||o===null||Wn(o,o.return)),o!==null&&h&4&&Zh(n,n.memoizedProps,o.memoizedProps);break;case 5:if($e(s,n),Ye(n),h&512&&(ge||o===null||Wn(o,o.return)),n.flags&32){p=n.stateNode;try{ga(p,"")}catch(st){Bt(n,n.return,st)}}h&4&&n.stateNode!=null&&(p=n.memoizedProps,Zh(n,p,o!==null?o.memoizedProps:p)),h&1024&&(ed=!0);break;case 6:if($e(s,n),Ye(n),h&4){if(n.stateNode===null)throw Error(i(162));h=n.memoizedProps,o=n.stateNode;try{o.nodeValue=h}catch(st){Bt(n,n.return,st)}}break;case 3:if(mc=null,p=In,In=fc(s.containerInfo),$e(s,n),In=p,Ye(n),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Ya(s.containerInfo)}catch(st){Bt(n,n.return,st)}ed&&(ed=!1,d0(n));break;case 4:h=In,In=fc(n.stateNode.containerInfo),$e(s,n),Ye(n),In=h;break;case 12:$e(s,n),Ye(n);break;case 31:$e(s,n),Ye(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Jl(n,h)));break;case 13:$e(s,n),Ye(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(ec=je()),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Jl(n,h)));break;case 22:p=n.memoizedState!==null;var M=o!==null&&o.memoizedState!==null,F=wi,X=ge;if(wi=F||p,ge=X||M,$e(s,n),ge=X,wi=F,Ye(n),h&8192)t:for(s=n.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||M||wi||ge||Gs(n)),o=null,s=n;;){if(s.tag===5||s.tag===26){if(o===null){M=o=s;try{if(y=M.stateNode,p)A=y.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{T=M.stateNode;var Q=M.memoizedProps.style,z=Q!=null&&Q.hasOwnProperty("display")?Q.display:null;T.style.display=z==null||typeof z=="boolean"?"":(""+z).trim()}}catch(st){Bt(M,M.return,st)}}}else if(s.tag===6){if(o===null){M=s;try{M.stateNode.nodeValue=p?"":M.memoizedProps}catch(st){Bt(M,M.return,st)}}}else if(s.tag===18){if(o===null){M=s;try{var G=M.stateNode;p?ey(G,!0):ey(M.stateNode,!1)}catch(st){Bt(M,M.return,st)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break t;for(;s.sibling===null;){if(s.return===null||s.return===n)break t;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=n.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,Jl(n,o))));break;case 19:$e(s,n),Ye(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Jl(n,h)));break;case 30:break;case 21:break;default:$e(s,n),Ye(n)}}function Ye(n){var s=n.flags;if(s&2){try{for(var o,h=n.return;h!==null;){if(i0(h)){o=h;break}h=h.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var p=o.stateNode,y=Jh(n);Zl(n,y,p);break;case 5:var A=o.stateNode;o.flags&32&&(ga(A,""),o.flags&=-33);var T=Jh(n);Zl(n,T,A);break;case 3:case 4:var M=o.stateNode.containerInfo,F=Jh(n);td(n,F,M);break;default:throw Error(i(161))}}catch(X){Bt(n,n.return,X)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function d0(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;d0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function Ai(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)r0(n,s.alternate,s),s=s.sibling}function Gs(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:ns(4,s,s.return),Gs(s);break;case 1:Wn(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&e0(s,s.return,o),Gs(s);break;case 27:oo(s.stateNode);case 26:case 5:Wn(s,s.return),Gs(s);break;case 22:s.memoizedState===null&&Gs(s);break;case 30:Gs(s);break;default:Gs(s)}n=n.sibling}}function Si(n,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,p=n,y=s,A=y.flags;switch(y.tag){case 0:case 11:case 15:Si(p,y,o),Qr(4,y);break;case 1:if(Si(p,y,o),h=y,p=h.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(F){Bt(h,h.return,F)}if(h=y,p=h.updateQueue,p!==null){var T=h.stateNode;try{var M=p.shared.hiddenCallbacks;if(M!==null)for(p.shared.hiddenCallbacks=null,p=0;p<M.length;p++)Vm(M[p],T)}catch(F){Bt(h,h.return,F)}}o&&A&64&&t0(y),Zr(y,y.return);break;case 27:s0(y);case 26:case 5:Si(p,y,o),o&&h===null&&A&4&&n0(y),Zr(y,y.return);break;case 12:Si(p,y,o);break;case 31:Si(p,y,o),o&&A&4&&c0(p,y);break;case 13:Si(p,y,o),o&&A&4&&u0(p,y);break;case 22:y.memoizedState===null&&Si(p,y,o),Zr(y,y.return);break;case 30:break;default:Si(p,y,o)}s=s.sibling}}function nd(n,s){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Br(o))}function id(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Br(n))}function Pn(n,s,o,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)f0(n,s,o,h),s=s.sibling}function f0(n,s,o,h){var p=s.flags;switch(s.tag){case 0:case 11:case 15:Pn(n,s,o,h),p&2048&&Qr(9,s);break;case 1:Pn(n,s,o,h);break;case 3:Pn(n,s,o,h),p&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Br(n)));break;case 12:if(p&2048){Pn(n,s,o,h),n=s.stateNode;try{var y=s.memoizedProps,A=y.id,T=y.onPostCommit;typeof T=="function"&&T(A,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(M){Bt(s,s.return,M)}}else Pn(n,s,o,h);break;case 31:Pn(n,s,o,h);break;case 13:Pn(n,s,o,h);break;case 23:break;case 22:y=s.stateNode,A=s.alternate,s.memoizedState!==null?y._visibility&2?Pn(n,s,o,h):Jr(n,s):y._visibility&2?Pn(n,s,o,h):(y._visibility|=2,Pa(n,s,o,h,(s.subtreeFlags&10256)!==0||!1)),p&2048&&nd(A,s);break;case 24:Pn(n,s,o,h),p&2048&&id(s.alternate,s);break;default:Pn(n,s,o,h)}}function Pa(n,s,o,h,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=n,A=s,T=o,M=h,F=A.flags;switch(A.tag){case 0:case 11:case 15:Pa(y,A,T,M,p),Qr(8,A);break;case 23:break;case 22:var X=A.stateNode;A.memoizedState!==null?X._visibility&2?Pa(y,A,T,M,p):Jr(y,A):(X._visibility|=2,Pa(y,A,T,M,p)),p&&F&2048&&nd(A.alternate,A);break;case 24:Pa(y,A,T,M,p),p&&F&2048&&id(A.alternate,A);break;default:Pa(y,A,T,M,p)}s=s.sibling}}function Jr(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=n,h=s,p=h.flags;switch(h.tag){case 22:Jr(o,h),p&2048&&nd(h.alternate,h);break;case 24:Jr(o,h),p&2048&&id(h.alternate,h);break;default:Jr(o,h)}s=s.sibling}}var to=8192;function ja(n,s,o){if(n.subtreeFlags&to)for(n=n.child;n!==null;)p0(n,s,o),n=n.sibling}function p0(n,s,o){switch(n.tag){case 26:ja(n,s,o),n.flags&to&&n.memoizedState!==null&&LA(o,In,n.memoizedState,n.memoizedProps);break;case 5:ja(n,s,o);break;case 3:case 4:var h=In;In=fc(n.stateNode.containerInfo),ja(n,s,o),In=h;break;case 22:n.memoizedState===null&&(h=n.alternate,h!==null&&h.memoizedState!==null?(h=to,to=16777216,ja(n,s,o),to=h):ja(n,s,o));break;default:ja(n,s,o)}}function m0(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function eo(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Se=h,y0(h,n)}m0(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)g0(n),n=n.sibling}function g0(n){switch(n.tag){case 0:case 11:case 15:eo(n),n.flags&2048&&ns(9,n,n.return);break;case 3:eo(n);break;case 12:eo(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,tc(n)):eo(n);break;default:eo(n)}}function tc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Se=h,y0(h,n)}m0(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:ns(8,s,s.return),tc(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,tc(s));break;default:tc(s)}n=n.sibling}}function y0(n,s){for(;Se!==null;){var o=Se;switch(o.tag){case 0:case 11:case 15:ns(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Br(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,Se=h;else t:for(o=n;Se!==null;){h=Se;var p=h.sibling,y=h.return;if(o0(h),h===o){Se=null;break t}if(p!==null){p.return=y,Se=p;break t}Se=y}}}var Xx={getCacheForType:function(n){var s=Ne(fe),o=s.data.get(n);return o===void 0&&(o=n(),s.data.set(n,o)),o},cacheSignal:function(){return Ne(fe).controller.signal}},Wx=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Vt=null,_t=null,Tt=0,jt=0,cn=null,is=!1,Ba=!1,sd=!1,_i=0,le=0,ss=0,qs=0,ad=0,un=0,Ua=0,no=null,Xe=null,rd=!1,ec=0,b0=0,nc=1/0,ic=null,as=null,we=0,rs=null,Fa=null,Ei=0,od=0,ld=null,v0=null,io=0,cd=null;function hn(){return(Lt&2)!==0&&Tt!==0?Tt&-Tt:P.T!==null?md():Ip()}function w0(){if(un===0)if((Tt&536870912)===0||Dt){var n=hl;hl<<=1,(hl&3932160)===0&&(hl=262144),un=n}else un=536870912;return n=on.current,n!==null&&(n.flags|=32),un}function We(n,s,o){(n===Vt&&(jt===2||jt===9)||n.cancelPendingCommit!==null)&&(za(n,0),os(n,Tt,un,!1)),_r(n,o),((Lt&2)===0||n!==Vt)&&(n===Vt&&((Lt&2)===0&&(qs|=o),le===4&&os(n,Tt,un,!1)),Kn(n))}function x0(n,s,o){if((Lt&6)!==0)throw Error(i(327));var h=!o&&(s&127)===0&&(s&n.expiredLanes)===0||Sr(n,s),p=h?Zx(n,s):hd(n,s,!0),y=h;do{if(p===0){Ba&&!h&&os(n,s,0,!1);break}else{if(o=n.current.alternate,y&&!Kx(o)){p=hd(n,s,!1),y=!1;continue}if(p===2){if(y=s,n.errorRecoveryDisabledLanes&y)var A=0;else A=n.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){s=A;t:{var T=n;p=no;var M=T.current.memoizedState.isDehydrated;if(M&&(za(T,A).flags|=256),A=hd(T,A,!1),A!==2){if(sd&&!M){T.errorRecoveryDisabledLanes|=y,qs|=y,p=4;break t}y=Xe,Xe=p,y!==null&&(Xe===null?Xe=y:Xe.push.apply(Xe,y))}p=A}if(y=!1,p!==2)continue}}if(p===1){za(n,0),os(n,s,0,!0);break}t:{switch(h=n,y=p,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:os(h,s,un,!is);break t;case 2:Xe=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(p=ec+300-je(),10<p)){if(os(h,s,un,!is),fl(h,0,!0)!==0)break t;Ei=s,h.timeoutHandle=Z0(A0.bind(null,h,o,Xe,ic,rd,s,un,qs,Ua,is,y,"Throttled",-0,0),p);break t}A0(h,o,Xe,ic,rd,s,un,qs,Ua,is,y,null,-0,0)}}break}while(!0);Kn(n)}function A0(n,s,o,h,p,y,A,T,M,F,X,Q,z,G){if(n.timeoutHandle=-1,Q=s.subtreeFlags,Q&8192||(Q&16785408)===16785408){Q={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ui},p0(s,y,Q);var st=(y&62914560)===y?ec-je():(y&4194048)===y?b0-je():0;if(st=OA(Q,st),st!==null){Ei=y,n.cancelPendingCommit=st(N0.bind(null,n,s,y,o,h,p,A,T,M,X,Q,null,z,G)),os(n,y,A,!F);return}}N0(n,s,y,o,h,p,A,T,M)}function Kx(n){for(var s=n;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var p=o[h],y=p.getSnapshot;p=p.value;try{if(!an(y(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function os(n,s,o,h){s&=~ad,s&=~qs,n.suspendedLanes|=s,n.pingedLanes&=~s,h&&(n.warmLanes|=s),h=n.expirationTimes;for(var p=s;0<p;){var y=31-sn(p),A=1<<y;h[y]=-1,p&=~A}o!==0&&kp(n,o,s)}function sc(){return(Lt&6)===0?(so(0),!1):!0}function ud(){if(_t!==null){if(jt===0)var n=_t.return;else n=_t,pi=Ps=null,Th(n),Ma=null,Fr=0,n=_t;for(;n!==null;)Jg(n.alternate,n),n=n.return;_t=null}}function za(n,s){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,gA(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Ei=0,ud(),Vt=n,_t=o=di(n.current,null),Tt=s,jt=0,cn=null,is=!1,Ba=Sr(n,s),sd=!1,Ua=un=ad=qs=ss=le=0,Xe=no=null,rd=!1,(s&8)!==0&&(s|=s&32);var h=n.entangledLanes;if(h!==0)for(n=n.entanglements,h&=s;0<h;){var p=31-sn(h),y=1<<p;s|=n[p],h&=~y}return _i=s,El(),o}function S0(n,s){xt=null,P.H=Xr,s===Na||s===Ll?(s=Um(),jt=3):s===ph?(s=Um(),jt=4):jt=s===Hh?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,cn=s,_t===null&&(le=1,Yl(n,An(s,n.current)))}function _0(){var n=on.current;return n===null?!0:(Tt&4194048)===Tt?Tn===null:(Tt&62914560)===Tt||(Tt&536870912)!==0?n===Tn:!1}function E0(){var n=P.H;return P.H=Xr,n===null?Xr:n}function T0(){var n=P.A;return P.A=Xx,n}function ac(){le=4,is||(Tt&4194048)!==Tt&&on.current!==null||(Ba=!0),(ss&134217727)===0&&(qs&134217727)===0||Vt===null||os(Vt,Tt,un,!1)}function hd(n,s,o){var h=Lt;Lt|=2;var p=E0(),y=T0();(Vt!==n||Tt!==s)&&(ic=null,za(n,s)),s=!1;var A=le;t:do try{if(jt!==0&&_t!==null){var T=_t,M=cn;switch(jt){case 8:ud(),A=6;break t;case 3:case 2:case 9:case 6:on.current===null&&(s=!0);var F=jt;if(jt=0,cn=null,Ha(n,T,M,F),o&&Ba){A=0;break t}break;default:F=jt,jt=0,cn=null,Ha(n,T,M,F)}}Qx(),A=le;break}catch(X){S0(n,X)}while(!0);return s&&n.shellSuspendCounter++,pi=Ps=null,Lt=h,P.H=p,P.A=y,_t===null&&(Vt=null,Tt=0,El()),A}function Qx(){for(;_t!==null;)C0(_t)}function Zx(n,s){var o=Lt;Lt|=2;var h=E0(),p=T0();Vt!==n||Tt!==s?(ic=null,nc=je()+500,za(n,s)):Ba=Sr(n,s);t:do try{if(jt!==0&&_t!==null){s=_t;var y=cn;e:switch(jt){case 1:jt=0,cn=null,Ha(n,s,y,1);break;case 2:case 9:if(jm(y)){jt=0,cn=null,R0(s);break}s=function(){jt!==2&&jt!==9||Vt!==n||(jt=7),Kn(n)},y.then(s,s);break t;case 3:jt=7;break t;case 4:jt=5;break t;case 7:jm(y)?(jt=0,cn=null,R0(s)):(jt=0,cn=null,Ha(n,s,y,7));break;case 5:var A=null;switch(_t.tag){case 26:A=_t.memoizedState;case 5:case 27:var T=_t;if(A?fy(A):T.stateNode.complete){jt=0,cn=null;var M=T.sibling;if(M!==null)_t=M;else{var F=T.return;F!==null?(_t=F,rc(F)):_t=null}break e}}jt=0,cn=null,Ha(n,s,y,5);break;case 6:jt=0,cn=null,Ha(n,s,y,6);break;case 8:ud(),le=6;break t;default:throw Error(i(462))}}Jx();break}catch(X){S0(n,X)}while(!0);return pi=Ps=null,P.H=h,P.A=p,Lt=o,_t!==null?0:(Vt=null,Tt=0,El(),le)}function Jx(){for(;_t!==null&&!_u();)C0(_t)}function C0(n){var s=Qg(n.alternate,n,_i);n.memoizedProps=n.pendingProps,s===null?rc(n):_t=s}function R0(n){var s=n,o=s.alternate;switch(s.tag){case 15:case 0:s=qg(o,s,s.pendingProps,s.type,void 0,Tt);break;case 11:s=qg(o,s,s.pendingProps,s.type.render,s.ref,Tt);break;case 5:Th(s);default:Jg(o,s),s=_t=Tm(s,_i),s=Qg(o,s,_i)}n.memoizedProps=n.pendingProps,s===null?rc(n):_t=s}function Ha(n,s,o,h){pi=Ps=null,Th(s),Ma=null,Fr=0;var p=s.return;try{if(zx(n,p,s,o,Tt)){le=1,Yl(n,An(o,n.current)),_t=null;return}}catch(y){if(p!==null)throw _t=p,y;le=1,Yl(n,An(o,n.current)),_t=null;return}s.flags&32768?(Dt||h===1?n=!0:Ba||(Tt&536870912)!==0?n=!1:(is=n=!0,(h===2||h===9||h===3||h===6)&&(h=on.current,h!==null&&h.tag===13&&(h.flags|=16384))),D0(s,n)):rc(s)}function rc(n){var s=n;do{if((s.flags&32768)!==0){D0(s,is);return}n=s.return;var o=Gx(s.alternate,s,_i);if(o!==null){_t=o;return}if(s=s.sibling,s!==null){_t=s;return}_t=s=n}while(s!==null);le===0&&(le=5)}function D0(n,s){do{var o=qx(n.alternate,n);if(o!==null){o.flags&=32767,_t=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(n=n.sibling,n!==null)){_t=n;return}_t=n=o}while(n!==null);le=6,_t=null}function N0(n,s,o,h,p,y,A,T,M){n.cancelPendingCommit=null;do oc();while(we!==0);if((Lt&6)!==0)throw Error(i(327));if(s!==null){if(s===n.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=Ju,kw(n,o,y,A,T,M),n===Vt&&(_t=Vt=null,Tt=0),Fa=s,rs=n,Ei=o,od=y,ld=p,v0=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,iA(ca,function(){return I0(),null})):(n.callbackNode=null,n.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=P.T,P.T=null,p=q.p,q.p=2,A=Lt,Lt|=4;try{$x(n,s,o)}finally{Lt=A,q.p=p,P.T=h}}we=1,M0(),k0(),L0()}}function M0(){if(we===1){we=0;var n=rs,s=Fa,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=P.T,P.T=null;var h=q.p;q.p=2;var p=Lt;Lt|=4;try{h0(s,n);var y=Sd,A=ym(n.containerInfo),T=y.focusedElem,M=y.selectionRange;if(A!==T&&T&&T.ownerDocument&&gm(T.ownerDocument.documentElement,T)){if(M!==null&&Xu(T)){var F=M.start,X=M.end;if(X===void 0&&(X=F),"selectionStart"in T)T.selectionStart=F,T.selectionEnd=Math.min(X,T.value.length);else{var Q=T.ownerDocument||document,z=Q&&Q.defaultView||window;if(z.getSelection){var G=z.getSelection(),st=T.textContent.length,ft=Math.min(M.start,st),zt=M.end===void 0?ft:Math.min(M.end,st);!G.extend&&ft>zt&&(A=zt,zt=ft,ft=A);var B=mm(T,ft),O=mm(T,zt);if(B&&O&&(G.rangeCount!==1||G.anchorNode!==B.node||G.anchorOffset!==B.offset||G.focusNode!==O.node||G.focusOffset!==O.offset)){var U=Q.createRange();U.setStart(B.node,B.offset),G.removeAllRanges(),ft>zt?(G.addRange(U),G.extend(O.node,O.offset)):(U.setEnd(O.node,O.offset),G.addRange(U))}}}}for(Q=[],G=T;G=G.parentNode;)G.nodeType===1&&Q.push({element:G,left:G.scrollLeft,top:G.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<Q.length;T++){var W=Q[T];W.element.scrollLeft=W.left,W.element.scrollTop=W.top}}vc=!!Ad,Sd=Ad=null}finally{Lt=p,q.p=h,P.T=o}}n.current=s,we=2}}function k0(){if(we===2){we=0;var n=rs,s=Fa,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=P.T,P.T=null;var h=q.p;q.p=2;var p=Lt;Lt|=4;try{r0(n,s.alternate,s)}finally{Lt=p,q.p=h,P.T=o}}we=3}}function L0(){if(we===4||we===3){we=0,Eu();var n=rs,s=Fa,o=Ei,h=v0;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?we=5:(we=0,Fa=rs=null,O0(n,n.pendingLanes));var p=n.pendingLanes;if(p===0&&(as=null),Du(o),s=s.stateNode,nn&&typeof nn.onCommitFiberRoot=="function")try{nn.onCommitFiberRoot(Vi,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=P.T,p=q.p,q.p=2,P.T=null;try{for(var y=n.onRecoverableError,A=0;A<h.length;A++){var T=h[A];y(T.value,{componentStack:T.stack})}}finally{P.T=s,q.p=p}}(Ei&3)!==0&&oc(),Kn(n),p=n.pendingLanes,(o&261930)!==0&&(p&42)!==0?n===cd?io++:(io=0,cd=n):io=0,so(0)}}function O0(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,Br(s)))}function oc(){return M0(),k0(),L0(),I0()}function I0(){if(we!==5)return!1;var n=rs,s=od;od=0;var o=Du(Ei),h=P.T,p=q.p;try{q.p=32>o?32:o,P.T=null,o=ld,ld=null;var y=rs,A=Ei;if(we=0,Fa=rs=null,Ei=0,(Lt&6)!==0)throw Error(i(331));var T=Lt;if(Lt|=4,g0(y.current),f0(y,y.current,A,o),Lt=T,so(0,!1),nn&&typeof nn.onPostCommitFiberRoot=="function")try{nn.onPostCommitFiberRoot(Vi,y)}catch{}return!0}finally{q.p=p,P.T=h,O0(n,s)}}function P0(n,s,o){s=An(o,s),s=zh(n.stateNode,s,2),n=Ji(n,s,2),n!==null&&(_r(n,2),Kn(n))}function Bt(n,s,o){if(n.tag===3)P0(n,n,o);else for(;s!==null;){if(s.tag===3){P0(s,n,o);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(as===null||!as.has(h))){n=An(o,n),o=jg(2),h=Ji(s,o,2),h!==null&&(Bg(o,h,s,n),_r(h,2),Kn(h));break}}s=s.return}}function dd(n,s,o){var h=n.pingCache;if(h===null){h=n.pingCache=new Wx;var p=new Set;h.set(s,p)}else p=h.get(s),p===void 0&&(p=new Set,h.set(s,p));p.has(o)||(sd=!0,p.add(o),n=tA.bind(null,n,s,o),s.then(n,n))}function tA(n,s,o){var h=n.pingCache;h!==null&&h.delete(s),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Vt===n&&(Tt&o)===o&&(le===4||le===3&&(Tt&62914560)===Tt&&300>je()-ec?(Lt&2)===0&&za(n,0):ad|=o,Ua===Tt&&(Ua=0)),Kn(n)}function j0(n,s){s===0&&(s=Mp()),n=Ls(n,s),n!==null&&(_r(n,s),Kn(n))}function eA(n){var s=n.memoizedState,o=0;s!==null&&(o=s.retryLane),j0(n,o)}function nA(n,s){var o=0;switch(n.tag){case 31:case 13:var h=n.stateNode,p=n.memoizedState;p!==null&&(o=p.retryLane);break;case 19:h=n.stateNode;break;case 22:h=n.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(s),j0(n,o)}function iA(n,s){return ll(n,s)}var lc=null,Va=null,fd=!1,cc=!1,pd=!1,ls=0;function Kn(n){n!==Va&&n.next===null&&(Va===null?lc=Va=n:Va=Va.next=n),cc=!0,fd||(fd=!0,aA())}function so(n,s){if(!pd&&cc){pd=!0;do for(var o=!1,h=lc;h!==null;){if(n!==0){var p=h.pendingLanes;if(p===0)var y=0;else{var A=h.suspendedLanes,T=h.pingedLanes;y=(1<<31-sn(42|n)+1)-1,y&=p&~(A&~T),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,z0(h,y))}else y=Tt,y=fl(h,h===Vt?y:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(y&3)===0||Sr(h,y)||(o=!0,z0(h,y));h=h.next}while(o);pd=!1}}function sA(){B0()}function B0(){cc=fd=!1;var n=0;ls!==0&&mA()&&(n=ls);for(var s=je(),o=null,h=lc;h!==null;){var p=h.next,y=U0(h,s);y===0?(h.next=null,o===null?lc=p:o.next=p,p===null&&(Va=o)):(o=h,(n!==0||(y&3)!==0)&&(cc=!0)),h=p}we!==0&&we!==5||so(n),ls!==0&&(ls=0)}function U0(n,s){for(var o=n.suspendedLanes,h=n.pingedLanes,p=n.expirationTimes,y=n.pendingLanes&-62914561;0<y;){var A=31-sn(y),T=1<<A,M=p[A];M===-1?((T&o)===0||(T&h)!==0)&&(p[A]=Mw(T,s)):M<=s&&(n.expiredLanes|=T),y&=~T}if(s=Vt,o=Tt,o=fl(n,n===s?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h=n.callbackNode,o===0||n===s&&(jt===2||jt===9)||n.cancelPendingCommit!==null)return h!==null&&h!==null&&la(h),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Sr(n,o)){if(s=o&-o,s===n.callbackPriority)return s;switch(h!==null&&la(h),Du(o)){case 2:case 8:o=cl;break;case 32:o=ca;break;case 268435456:o=re;break;default:o=ca}return h=F0.bind(null,n),o=ll(o,h),n.callbackPriority=s,n.callbackNode=o,s}return h!==null&&h!==null&&la(h),n.callbackPriority=2,n.callbackNode=null,2}function F0(n,s){if(we!==0&&we!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(oc()&&n.callbackNode!==o)return null;var h=Tt;return h=fl(n,n===Vt?h:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h===0?null:(x0(n,h,s),U0(n,je()),n.callbackNode!=null&&n.callbackNode===o?F0.bind(null,n):null)}function z0(n,s){if(oc())return null;x0(n,s,!0)}function aA(){yA(function(){(Lt&6)!==0?ll(Ar,sA):B0()})}function md(){if(ls===0){var n=Ra;n===0&&(n=ul,ul<<=1,(ul&261888)===0&&(ul=256)),ls=n}return ls}function H0(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:yl(""+n)}function V0(n,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,n.id&&o.setAttribute("form",n.id),s.parentNode.insertBefore(o,s),n=new FormData(n),o.parentNode.removeChild(o),n}function rA(n,s,o,h,p){if(s==="submit"&&o&&o.stateNode===p){var y=H0((p[Ve]||null).action),A=h.submitter;A&&(s=(s=A[Ve]||null)?H0(s.formAction):A.getAttribute("formAction"),s!==null&&(y=s,A=null));var T=new xl("action","action",null,h,p);n.push({event:T,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(ls!==0){var M=A?V0(p,A):new FormData(p);Ih(o,{pending:!0,data:M,method:p.method,action:y},null,M)}}else typeof y=="function"&&(T.preventDefault(),M=A?V0(p,A):new FormData(p),Ih(o,{pending:!0,data:M,method:p.method,action:y},y,M))},currentTarget:p}]})}}for(var gd=0;gd<Zu.length;gd++){var yd=Zu[gd],oA=yd.toLowerCase(),lA=yd[0].toUpperCase()+yd.slice(1);On(oA,"on"+lA)}On(wm,"onAnimationEnd"),On(xm,"onAnimationIteration"),On(Am,"onAnimationStart"),On("dblclick","onDoubleClick"),On("focusin","onFocus"),On("focusout","onBlur"),On(_x,"onTransitionRun"),On(Ex,"onTransitionStart"),On(Tx,"onTransitionCancel"),On(Sm,"onTransitionEnd"),pa("onMouseEnter",["mouseout","mouseover"]),pa("onMouseLeave",["mouseout","mouseover"]),pa("onPointerEnter",["pointerout","pointerover"]),pa("onPointerLeave",["pointerout","pointerover"]),Ds("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ds("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ds("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ds("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ds("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ds("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ao));function G0(n,s){s=(s&4)!==0;for(var o=0;o<n.length;o++){var h=n[o],p=h.event;h=h.listeners;t:{var y=void 0;if(s)for(var A=h.length-1;0<=A;A--){var T=h[A],M=T.instance,F=T.currentTarget;if(T=T.listener,M!==y&&p.isPropagationStopped())break t;y=T,p.currentTarget=F;try{y(p)}catch(X){_l(X)}p.currentTarget=null,y=M}else for(A=0;A<h.length;A++){if(T=h[A],M=T.instance,F=T.currentTarget,T=T.listener,M!==y&&p.isPropagationStopped())break t;y=T,p.currentTarget=F;try{y(p)}catch(X){_l(X)}p.currentTarget=null,y=M}}}}function Et(n,s){var o=s[Nu];o===void 0&&(o=s[Nu]=new Set);var h=n+"__bubble";o.has(h)||(q0(s,n,2,!1),o.add(h))}function bd(n,s,o){var h=0;s&&(h|=4),q0(o,n,h,s)}var uc="_reactListening"+Math.random().toString(36).slice(2);function vd(n){if(!n[uc]){n[uc]=!0,Bp.forEach(function(o){o!=="selectionchange"&&(cA.has(o)||bd(o,!1,n),bd(o,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[uc]||(s[uc]=!0,bd("selectionchange",!1,s))}}function q0(n,s,o,h){switch(wy(s)){case 2:var p=jA;break;case 8:p=BA;break;default:p=Od}o=p.bind(null,s,o,n),p=void 0,!Uu||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),h?p!==void 0?n.addEventListener(s,o,{capture:!0,passive:p}):n.addEventListener(s,o,!0):p!==void 0?n.addEventListener(s,o,{passive:p}):n.addEventListener(s,o,!1)}function wd(n,s,o,h,p){var y=h;if((s&1)===0&&(s&2)===0&&h!==null)t:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var T=h.stateNode.containerInfo;if(T===p)break;if(A===4)for(A=h.return;A!==null;){var M=A.tag;if((M===3||M===4)&&A.stateNode.containerInfo===p)return;A=A.return}for(;T!==null;){if(A=ha(T),A===null)return;if(M=A.tag,M===5||M===6||M===26||M===27){h=y=A;continue t}T=T.parentNode}}h=h.return}Kp(function(){var F=y,X=ju(o),Q=[];t:{var z=_m.get(n);if(z!==void 0){var G=xl,st=n;switch(n){case"keypress":if(vl(o)===0)break t;case"keydown":case"keyup":G=nx;break;case"focusin":st="focus",G=Vu;break;case"focusout":st="blur",G=Vu;break;case"beforeblur":case"afterblur":G=Vu;break;case"click":if(o.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":G=Jp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":G=Gw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":G=ax;break;case wm:case xm:case Am:G=Yw;break;case Sm:G=ox;break;case"scroll":case"scrollend":G=Hw;break;case"wheel":G=cx;break;case"copy":case"cut":case"paste":G=Ww;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":G=em;break;case"toggle":case"beforetoggle":G=hx}var ft=(s&4)!==0,zt=!ft&&(n==="scroll"||n==="scrollend"),B=ft?z!==null?z+"Capture":null:z;ft=[];for(var O=F,U;O!==null;){var W=O;if(U=W.stateNode,W=W.tag,W!==5&&W!==26&&W!==27||U===null||B===null||(W=Cr(O,B),W!=null&&ft.push(ro(O,W,U))),zt)break;O=O.return}0<ft.length&&(z=new G(z,st,null,o,X),Q.push({event:z,listeners:ft}))}}if((s&7)===0){t:{if(z=n==="mouseover"||n==="pointerover",G=n==="mouseout"||n==="pointerout",z&&o!==Pu&&(st=o.relatedTarget||o.fromElement)&&(ha(st)||st[ua]))break t;if((G||z)&&(z=X.window===X?X:(z=X.ownerDocument)?z.defaultView||z.parentWindow:window,G?(st=o.relatedTarget||o.toElement,G=F,st=st?ha(st):null,st!==null&&(zt=l(st),ft=st.tag,st!==zt||ft!==5&&ft!==27&&ft!==6)&&(st=null)):(G=null,st=F),G!==st)){if(ft=Jp,W="onMouseLeave",B="onMouseEnter",O="mouse",(n==="pointerout"||n==="pointerover")&&(ft=em,W="onPointerLeave",B="onPointerEnter",O="pointer"),zt=G==null?z:Tr(G),U=st==null?z:Tr(st),z=new ft(W,O+"leave",G,o,X),z.target=zt,z.relatedTarget=U,W=null,ha(X)===F&&(ft=new ft(B,O+"enter",st,o,X),ft.target=U,ft.relatedTarget=zt,W=ft),zt=W,G&&st)e:{for(ft=uA,B=G,O=st,U=0,W=B;W;W=ft(W))U++;W=0;for(var lt=O;lt;lt=ft(lt))W++;for(;0<U-W;)B=ft(B),U--;for(;0<W-U;)O=ft(O),W--;for(;U--;){if(B===O||O!==null&&B===O.alternate){ft=B;break e}B=ft(B),O=ft(O)}ft=null}else ft=null;G!==null&&$0(Q,z,G,ft,!1),st!==null&&zt!==null&&$0(Q,zt,st,ft,!0)}}t:{if(z=F?Tr(F):window,G=z.nodeName&&z.nodeName.toLowerCase(),G==="select"||G==="input"&&z.type==="file")var Mt=cm;else if(om(z))if(um)Mt=xx;else{Mt=vx;var ot=bx}else G=z.nodeName,!G||G.toLowerCase()!=="input"||z.type!=="checkbox"&&z.type!=="radio"?F&&Iu(F.elementType)&&(Mt=cm):Mt=wx;if(Mt&&(Mt=Mt(n,F))){lm(Q,Mt,o,X);break t}ot&&ot(n,z,F),n==="focusout"&&F&&z.type==="number"&&F.memoizedProps.value!=null&&Ou(z,"number",z.value)}switch(ot=F?Tr(F):window,n){case"focusin":(om(ot)||ot.contentEditable==="true")&&(wa=ot,Wu=F,Ir=null);break;case"focusout":Ir=Wu=wa=null;break;case"mousedown":Ku=!0;break;case"contextmenu":case"mouseup":case"dragend":Ku=!1,bm(Q,o,X);break;case"selectionchange":if(Sx)break;case"keydown":case"keyup":bm(Q,o,X)}var At;if(qu)t:{switch(n){case"compositionstart":var Ct="onCompositionStart";break t;case"compositionend":Ct="onCompositionEnd";break t;case"compositionupdate":Ct="onCompositionUpdate";break t}Ct=void 0}else va?am(n,o)&&(Ct="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Ct="onCompositionStart");Ct&&(nm&&o.locale!=="ko"&&(va||Ct!=="onCompositionStart"?Ct==="onCompositionEnd"&&va&&(At=Qp()):($i=X,Fu="value"in $i?$i.value:$i.textContent,va=!0)),ot=hc(F,Ct),0<ot.length&&(Ct=new tm(Ct,n,null,o,X),Q.push({event:Ct,listeners:ot}),At?Ct.data=At:(At=rm(o),At!==null&&(Ct.data=At)))),(At=fx?px(n,o):mx(n,o))&&(Ct=hc(F,"onBeforeInput"),0<Ct.length&&(ot=new tm("onBeforeInput","beforeinput",null,o,X),Q.push({event:ot,listeners:Ct}),ot.data=At)),rA(Q,n,F,o,X)}G0(Q,s)})}function ro(n,s,o){return{instance:n,listener:s,currentTarget:o}}function hc(n,s){for(var o=s+"Capture",h=[];n!==null;){var p=n,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Cr(n,o),p!=null&&h.unshift(ro(n,p,y)),p=Cr(n,s),p!=null&&h.push(ro(n,p,y))),n.tag===3)return h;n=n.return}return[]}function uA(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function $0(n,s,o,h,p){for(var y=s._reactName,A=[];o!==null&&o!==h;){var T=o,M=T.alternate,F=T.stateNode;if(T=T.tag,M!==null&&M===h)break;T!==5&&T!==26&&T!==27||F===null||(M=F,p?(F=Cr(o,y),F!=null&&A.unshift(ro(o,F,M))):p||(F=Cr(o,y),F!=null&&A.push(ro(o,F,M)))),o=o.return}A.length!==0&&n.push({event:s,listeners:A})}var hA=/\r\n?/g,dA=/\u0000|\uFFFD/g;function Y0(n){return(typeof n=="string"?n:""+n).replace(hA,`
`).replace(dA,"")}function X0(n,s){return s=Y0(s),Y0(n)===s}function Ft(n,s,o,h,p,y){switch(o){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||ga(n,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&ga(n,""+h);break;case"className":ml(n,"class",h);break;case"tabIndex":ml(n,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ml(n,o,h);break;case"style":Xp(n,h,y);break;case"data":if(s!=="object"){ml(n,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||o!=="href")){n.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=yl(""+h),n.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&Ft(n,s,"name",p.name,p,null),Ft(n,s,"formEncType",p.formEncType,p,null),Ft(n,s,"formMethod",p.formMethod,p,null),Ft(n,s,"formTarget",p.formTarget,p,null)):(Ft(n,s,"encType",p.encType,p,null),Ft(n,s,"method",p.method,p,null),Ft(n,s,"target",p.target,p,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=yl(""+h),n.setAttribute(o,h);break;case"onClick":h!=null&&(n.onclick=ui);break;case"onScroll":h!=null&&Et("scroll",n);break;case"onScrollEnd":h!=null&&Et("scrollend",n);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(p.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":n.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){n.removeAttribute("xlink:href");break}o=yl(""+h),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""+h):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":h===!0?n.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,h):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?n.setAttribute(o,h):n.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?n.removeAttribute(o):n.setAttribute(o,h);break;case"popover":Et("beforetoggle",n),Et("toggle",n),pl(n,"popover",h);break;case"xlinkActuate":ci(n,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":ci(n,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":ci(n,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":ci(n,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":ci(n,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":ci(n,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":ci(n,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":ci(n,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":ci(n,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":pl(n,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Fw.get(o)||o,pl(n,o,h))}}function xd(n,s,o,h,p,y){switch(o){case"style":Xp(n,h,y);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(p.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof h=="string"?ga(n,h):(typeof h=="number"||typeof h=="bigint")&&ga(n,""+h);break;case"onScroll":h!=null&&Et("scroll",n);break;case"onScrollEnd":h!=null&&Et("scrollend",n);break;case"onClick":h!=null&&(n.onclick=ui);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Up.hasOwnProperty(o))t:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),y=n[Ve]||null,y=y!=null?y[o]:null,typeof y=="function"&&n.removeEventListener(s,y,p),typeof h=="function")){typeof y!="function"&&y!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(s,h,p);break t}o in n?n[o]=h:h===!0?n.setAttribute(o,""):pl(n,o,h)}}}function ke(n,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",n),Et("load",n);var h=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var A=o[y];if(A!=null)switch(y){case"src":h=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Ft(n,s,y,A,o,null)}}p&&Ft(n,s,"srcSet",o.srcSet,o,null),h&&Ft(n,s,"src",o.src,o,null);return;case"input":Et("invalid",n);var T=y=A=p=null,M=null,F=null;for(h in o)if(o.hasOwnProperty(h)){var X=o[h];if(X!=null)switch(h){case"name":p=X;break;case"type":A=X;break;case"checked":M=X;break;case"defaultChecked":F=X;break;case"value":y=X;break;case"defaultValue":T=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,s));break;default:Ft(n,s,h,X,o,null)}}Gp(n,y,T,M,F,A,p,!1);return;case"select":Et("invalid",n),h=A=y=null;for(p in o)if(o.hasOwnProperty(p)&&(T=o[p],T!=null))switch(p){case"value":y=T;break;case"defaultValue":A=T;break;case"multiple":h=T;default:Ft(n,s,p,T,o,null)}s=y,o=A,n.multiple=!!h,s!=null?ma(n,!!h,s,!1):o!=null&&ma(n,!!h,o,!0);return;case"textarea":Et("invalid",n),y=p=h=null;for(A in o)if(o.hasOwnProperty(A)&&(T=o[A],T!=null))switch(A){case"value":h=T;break;case"defaultValue":p=T;break;case"children":y=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(i(91));break;default:Ft(n,s,A,T,o,null)}$p(n,h,p,y);return;case"option":for(M in o)o.hasOwnProperty(M)&&(h=o[M],h!=null)&&(M==="selected"?n.selected=h&&typeof h!="function"&&typeof h!="symbol":Ft(n,s,M,h,o,null));return;case"dialog":Et("beforetoggle",n),Et("toggle",n),Et("cancel",n),Et("close",n);break;case"iframe":case"object":Et("load",n);break;case"video":case"audio":for(h=0;h<ao.length;h++)Et(ao[h],n);break;case"image":Et("error",n),Et("load",n);break;case"details":Et("toggle",n);break;case"embed":case"source":case"link":Et("error",n),Et("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in o)if(o.hasOwnProperty(F)&&(h=o[F],h!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Ft(n,s,F,h,o,null)}return;default:if(Iu(s)){for(X in o)o.hasOwnProperty(X)&&(h=o[X],h!==void 0&&xd(n,s,X,h,o,void 0));return}}for(T in o)o.hasOwnProperty(T)&&(h=o[T],h!=null&&Ft(n,s,T,h,o,null))}function fA(n,s,o,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,A=null,T=null,M=null,F=null,X=null;for(G in o){var Q=o[G];if(o.hasOwnProperty(G)&&Q!=null)switch(G){case"checked":break;case"value":break;case"defaultValue":M=Q;default:h.hasOwnProperty(G)||Ft(n,s,G,null,h,Q)}}for(var z in h){var G=h[z];if(Q=o[z],h.hasOwnProperty(z)&&(G!=null||Q!=null))switch(z){case"type":y=G;break;case"name":p=G;break;case"checked":F=G;break;case"defaultChecked":X=G;break;case"value":A=G;break;case"defaultValue":T=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(i(137,s));break;default:G!==Q&&Ft(n,s,z,G,h,Q)}}Lu(n,A,T,M,F,X,y,p);return;case"select":G=A=T=z=null;for(y in o)if(M=o[y],o.hasOwnProperty(y)&&M!=null)switch(y){case"value":break;case"multiple":G=M;default:h.hasOwnProperty(y)||Ft(n,s,y,null,h,M)}for(p in h)if(y=h[p],M=o[p],h.hasOwnProperty(p)&&(y!=null||M!=null))switch(p){case"value":z=y;break;case"defaultValue":T=y;break;case"multiple":A=y;default:y!==M&&Ft(n,s,p,y,h,M)}s=T,o=A,h=G,z!=null?ma(n,!!o,z,!1):!!h!=!!o&&(s!=null?ma(n,!!o,s,!0):ma(n,!!o,o?[]:"",!1));return;case"textarea":G=z=null;for(T in o)if(p=o[T],o.hasOwnProperty(T)&&p!=null&&!h.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:Ft(n,s,T,null,h,p)}for(A in h)if(p=h[A],y=o[A],h.hasOwnProperty(A)&&(p!=null||y!=null))switch(A){case"value":z=p;break;case"defaultValue":G=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==y&&Ft(n,s,A,p,h,y)}qp(n,z,G);return;case"option":for(var st in o)z=o[st],o.hasOwnProperty(st)&&z!=null&&!h.hasOwnProperty(st)&&(st==="selected"?n.selected=!1:Ft(n,s,st,null,h,z));for(M in h)z=h[M],G=o[M],h.hasOwnProperty(M)&&z!==G&&(z!=null||G!=null)&&(M==="selected"?n.selected=z&&typeof z!="function"&&typeof z!="symbol":Ft(n,s,M,z,h,G));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ft in o)z=o[ft],o.hasOwnProperty(ft)&&z!=null&&!h.hasOwnProperty(ft)&&Ft(n,s,ft,null,h,z);for(F in h)if(z=h[F],G=o[F],h.hasOwnProperty(F)&&z!==G&&(z!=null||G!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(z!=null)throw Error(i(137,s));break;default:Ft(n,s,F,z,h,G)}return;default:if(Iu(s)){for(var zt in o)z=o[zt],o.hasOwnProperty(zt)&&z!==void 0&&!h.hasOwnProperty(zt)&&xd(n,s,zt,void 0,h,z);for(X in h)z=h[X],G=o[X],!h.hasOwnProperty(X)||z===G||z===void 0&&G===void 0||xd(n,s,X,z,h,G);return}}for(var B in o)z=o[B],o.hasOwnProperty(B)&&z!=null&&!h.hasOwnProperty(B)&&Ft(n,s,B,null,h,z);for(Q in h)z=h[Q],G=o[Q],!h.hasOwnProperty(Q)||z===G||z==null&&G==null||Ft(n,s,Q,z,h,G)}function W0(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function pA(){if(typeof performance.getEntriesByType=="function"){for(var n=0,s=0,o=performance.getEntriesByType("resource"),h=0;h<o.length;h++){var p=o[h],y=p.transferSize,A=p.initiatorType,T=p.duration;if(y&&T&&W0(A)){for(A=0,T=p.responseEnd,h+=1;h<o.length;h++){var M=o[h],F=M.startTime;if(F>T)break;var X=M.transferSize,Q=M.initiatorType;X&&W0(Q)&&(M=M.responseEnd,A+=X*(M<T?1:(T-F)/(M-F)))}if(--h,s+=8*(y+A)/(p.duration/1e3),n++,10<n)break}}if(0<n)return s/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Ad=null,Sd=null;function dc(n){return n.nodeType===9?n:n.ownerDocument}function K0(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Q0(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function _d(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Ed=null;function mA(){var n=window.event;return n&&n.type==="popstate"?n===Ed?!1:(Ed=n,!0):(Ed=null,!1)}var Z0=typeof setTimeout=="function"?setTimeout:void 0,gA=typeof clearTimeout=="function"?clearTimeout:void 0,J0=typeof Promise=="function"?Promise:void 0,yA=typeof queueMicrotask=="function"?queueMicrotask:typeof J0<"u"?function(n){return J0.resolve(null).then(n).catch(bA)}:Z0;function bA(n){setTimeout(function(){throw n})}function cs(n){return n==="head"}function ty(n,s){var o=s,h=0;do{var p=o.nextSibling;if(n.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(h===0){n.removeChild(p),Ya(s);return}h--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")h++;else if(o==="html")oo(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,oo(o);for(var y=o.firstChild;y;){var A=y.nextSibling,T=y.nodeName;y[Er]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=A}}else o==="body"&&oo(n.ownerDocument.body);o=p}while(o);Ya(s)}function ey(n,s){var o=n;n=0;do{var h=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=h}while(o)}function Td(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Td(o),Mu(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function vA(n,s,o,h){for(;n.nodeType===1;){var p=o;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(h){if(!n[Er])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(y=n.getAttribute("rel"),y==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(y!==p.rel||n.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||n.getAttribute("title")!==(p.title==null?null:p.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(y=n.getAttribute("src"),(y!==(p.src==null?null:p.src)||n.getAttribute("type")!==(p.type==null?null:p.type)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&n.getAttribute("name")===y)return n}else return n;if(n=Cn(n.nextSibling),n===null)break}return null}function wA(n,s,o){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Cn(n.nextSibling),n===null))return null;return n}function ny(n,s){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=Cn(n.nextSibling),n===null))return null;return n}function Cd(n){return n.data==="$?"||n.data==="$~"}function Rd(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function xA(n,s){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=s;else if(n.data!=="$?"||o.readyState!=="loading")s();else{var h=function(){s(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),n._reactRetry=h}}function Cn(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return n}var Dd=null;function iy(n){n=n.nextSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(s===0)return Cn(n.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}n=n.nextSibling}return null}function sy(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return n;s--}else o!=="/$"&&o!=="/&"||s++}n=n.previousSibling}return null}function ay(n,s,o){switch(s=dc(o),n){case"html":if(n=s.documentElement,!n)throw Error(i(452));return n;case"head":if(n=s.head,!n)throw Error(i(453));return n;case"body":if(n=s.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function oo(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);Mu(n)}var Rn=new Map,ry=new Set;function fc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ti=q.d;q.d={f:AA,r:SA,D:_A,C:EA,L:TA,m:CA,X:DA,S:RA,M:NA};function AA(){var n=Ti.f(),s=sc();return n||s}function SA(n){var s=da(n);s!==null&&s.tag===5&&s.type==="form"?Sg(s):Ti.r(n)}var Ga=typeof document>"u"?null:document;function oy(n,s,o){var h=Ga;if(h&&typeof s=="string"&&s){var p=wn(s);p='link[rel="'+n+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),ry.has(p)||(ry.add(p),n={rel:n,crossOrigin:o,href:s},h.querySelector(p)===null&&(s=h.createElement("link"),ke(s,"link",n),Ae(s),h.head.appendChild(s)))}}function _A(n){Ti.D(n),oy("dns-prefetch",n,null)}function EA(n,s){Ti.C(n,s),oy("preconnect",n,s)}function TA(n,s,o){Ti.L(n,s,o);var h=Ga;if(h&&n&&s){var p='link[rel="preload"][as="'+wn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+wn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+wn(o.imageSizes)+'"]')):p+='[href="'+wn(n)+'"]';var y=p;switch(s){case"style":y=qa(n);break;case"script":y=$a(n)}Rn.has(y)||(n=g({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:n,as:s},o),Rn.set(y,n),h.querySelector(p)!==null||s==="style"&&h.querySelector(lo(y))||s==="script"&&h.querySelector(co(y))||(s=h.createElement("link"),ke(s,"link",n),Ae(s),h.head.appendChild(s)))}}function CA(n,s){Ti.m(n,s);var o=Ga;if(o&&n){var h=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+wn(h)+'"][href="'+wn(n)+'"]',y=p;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=$a(n)}if(!Rn.has(y)&&(n=g({rel:"modulepreload",href:n},s),Rn.set(y,n),o.querySelector(p)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(co(y)))return}h=o.createElement("link"),ke(h,"link",n),Ae(h),o.head.appendChild(h)}}}function RA(n,s,o){Ti.S(n,s,o);var h=Ga;if(h&&n){var p=fa(h).hoistableStyles,y=qa(n);s=s||"default";var A=p.get(y);if(!A){var T={loading:0,preload:null};if(A=h.querySelector(lo(y)))T.loading=5;else{n=g({rel:"stylesheet",href:n,"data-precedence":s},o),(o=Rn.get(y))&&Nd(n,o);var M=A=h.createElement("link");Ae(M),ke(M,"link",n),M._p=new Promise(function(F,X){M.onload=F,M.onerror=X}),M.addEventListener("load",function(){T.loading|=1}),M.addEventListener("error",function(){T.loading|=2}),T.loading|=4,pc(A,s,h)}A={type:"stylesheet",instance:A,count:1,state:T},p.set(y,A)}}}function DA(n,s){Ti.X(n,s);var o=Ga;if(o&&n){var h=fa(o).hoistableScripts,p=$a(n),y=h.get(p);y||(y=o.querySelector(co(p)),y||(n=g({src:n,async:!0},s),(s=Rn.get(p))&&Md(n,s),y=o.createElement("script"),Ae(y),ke(y,"link",n),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(p,y))}}function NA(n,s){Ti.M(n,s);var o=Ga;if(o&&n){var h=fa(o).hoistableScripts,p=$a(n),y=h.get(p);y||(y=o.querySelector(co(p)),y||(n=g({src:n,async:!0,type:"module"},s),(s=Rn.get(p))&&Md(n,s),y=o.createElement("script"),Ae(y),ke(y,"link",n),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(p,y))}}function ly(n,s,o,h){var p=(p=gt.current)?fc(p):null;if(!p)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=qa(o.href),o=fa(p).hoistableStyles,h=o.get(s),h||(h={type:"style",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=qa(o.href);var y=fa(p).hoistableStyles,A=y.get(n);if(A||(p=p.ownerDocument||p,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(n,A),(y=p.querySelector(lo(n)))&&!y._p&&(A.instance=y,A.state.loading=5),Rn.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Rn.set(n,o),y||MA(p,n,o,A.state))),s&&h===null)throw Error(i(528,""));return A}if(s&&h!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=$a(o),o=fa(p).hoistableScripts,h=o.get(s),h||(h={type:"script",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function qa(n){return'href="'+wn(n)+'"'}function lo(n){return'link[rel="stylesheet"]['+n+"]"}function cy(n){return g({},n,{"data-precedence":n.precedence,precedence:null})}function MA(n,s,o,h){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=n.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),ke(s,"link",o),Ae(s),n.head.appendChild(s))}function $a(n){return'[src="'+wn(n)+'"]'}function co(n){return"script[async]"+n}function uy(n,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var h=n.querySelector('style[data-href~="'+wn(o.href)+'"]');if(h)return s.instance=h,Ae(h),h;var p=g({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(n.ownerDocument||n).createElement("style"),Ae(h),ke(h,"style",p),pc(h,o.precedence,n),s.instance=h;case"stylesheet":p=qa(o.href);var y=n.querySelector(lo(p));if(y)return s.state.loading|=4,s.instance=y,Ae(y),y;h=cy(o),(p=Rn.get(p))&&Nd(h,p),y=(n.ownerDocument||n).createElement("link"),Ae(y);var A=y;return A._p=new Promise(function(T,M){A.onload=T,A.onerror=M}),ke(y,"link",h),s.state.loading|=4,pc(y,o.precedence,n),s.instance=y;case"script":return y=$a(o.src),(p=n.querySelector(co(y)))?(s.instance=p,Ae(p),p):(h=o,(p=Rn.get(y))&&(h=g({},o),Md(h,p)),n=n.ownerDocument||n,p=n.createElement("script"),Ae(p),ke(p,"link",h),n.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,pc(h,o.precedence,n));return s.instance}function pc(n,s,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=h.length?h[h.length-1]:null,y=p,A=0;A<h.length;A++){var T=h[A];if(T.dataset.precedence===s)y=T;else if(y!==p)break}y?y.parentNode.insertBefore(n,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(n,s.firstChild))}function Nd(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function Md(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var mc=null;function hy(n,s,o){if(mc===null){var h=new Map,p=mc=new Map;p.set(o,h)}else p=mc,h=p.get(o),h||(h=new Map,p.set(o,h));if(h.has(n))return h;for(h.set(n,null),o=o.getElementsByTagName(n),p=0;p<o.length;p++){var y=o[p];if(!(y[Er]||y[Re]||n==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var A=y.getAttribute(s)||"";A=n+A;var T=h.get(A);T?T.push(y):h.set(A,[y])}}return h}function dy(n,s,o){n=n.ownerDocument||n,n.head.insertBefore(o,s==="title"?n.querySelector("head > title"):null)}function kA(n,s,o){if(o===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(n=s.disabled,typeof s.precedence=="string"&&n==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function fy(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function LA(n,s,o,h){if(o.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=qa(h.href),y=s.querySelector(lo(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(n.count++,n=gc.bind(n),s.then(n,n)),o.state.loading|=4,o.instance=y,Ae(y);return}y=s.ownerDocument||s,h=cy(h),(p=Rn.get(p))&&Nd(h,p),y=y.createElement("link"),Ae(y);var A=y;A._p=new Promise(function(T,M){A.onload=T,A.onerror=M}),ke(y,"link",h),o.instance=y}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=gc.bind(n),s.addEventListener("load",o),s.addEventListener("error",o))}}var kd=0;function OA(n,s){return n.stylesheets&&n.count===0&&bc(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var h=setTimeout(function(){if(n.stylesheets&&bc(n,n.stylesheets),n.unsuspend){var y=n.unsuspend;n.unsuspend=null,y()}},6e4+s);0<n.imgBytes&&kd===0&&(kd=62500*pA());var p=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&bc(n,n.stylesheets),n.unsuspend)){var y=n.unsuspend;n.unsuspend=null,y()}},(n.imgBytes>kd?50:800)+s);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(h),clearTimeout(p)}}:null}function gc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bc(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var yc=null;function bc(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,yc=new Map,s.forEach(IA,n),yc=null,gc.call(n))}function IA(n,s){if(!(s.state.loading&4)){var o=yc.get(n);if(o)var h=o.get(null);else{o=new Map,yc.set(n,o);for(var p=n.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var A=p[y];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(o.set(A.dataset.precedence,A),h=A)}h&&o.set(null,h)}p=s.instance,A=p.getAttribute("data-precedence"),y=o.get(A)||h,y===h&&o.set(null,p),o.set(A,p),this.count++,h=gc.bind(this),p.addEventListener("load",h),p.addEventListener("error",h),y?y.parentNode.insertBefore(p,y.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(p,n.firstChild)),s.state.loading|=4}}var uo={$$typeof:C,Provider:null,Consumer:null,_currentValue:tt,_currentValue2:tt,_threadCount:0};function PA(n,s,o,h,p,y,A,T,M){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Cu(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cu(0),this.hiddenUpdates=Cu(null),this.identifierPrefix=h,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function py(n,s,o,h,p,y,A,T,M,F,X,Q){return n=new PA(n,s,o,A,M,F,X,Q,T),s=1,y===!0&&(s|=24),y=rn(3,null,null,s),n.current=y,y.stateNode=n,s=hh(),s.refCount++,n.pooledCache=s,s.refCount++,y.memoizedState={element:h,isDehydrated:o,cache:s},mh(y),n}function my(n){return n?(n=Sa,n):Sa}function gy(n,s,o,h,p,y){p=my(p),h.context===null?h.context=p:h.pendingContext=p,h=Zi(s),h.payload={element:o},y=y===void 0?null:y,y!==null&&(h.callback=y),o=Ji(n,h,s),o!==null&&(We(o,n,s),Hr(o,n,s))}function yy(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<s?o:s}}function Ld(n,s){yy(n,s),(n=n.alternate)&&yy(n,s)}function by(n){if(n.tag===13||n.tag===31){var s=Ls(n,67108864);s!==null&&We(s,n,67108864),Ld(n,67108864)}}function vy(n){if(n.tag===13||n.tag===31){var s=hn();s=Ru(s);var o=Ls(n,s);o!==null&&We(o,n,s),Ld(n,s)}}var vc=!0;function jA(n,s,o,h){var p=P.T;P.T=null;var y=q.p;try{q.p=2,Od(n,s,o,h)}finally{q.p=y,P.T=p}}function BA(n,s,o,h){var p=P.T;P.T=null;var y=q.p;try{q.p=8,Od(n,s,o,h)}finally{q.p=y,P.T=p}}function Od(n,s,o,h){if(vc){var p=Id(h);if(p===null)wd(n,s,h,wc,o),xy(n,h);else if(FA(p,n,s,o,h))h.stopPropagation();else if(xy(n,h),s&4&&-1<UA.indexOf(n)){for(;p!==null;){var y=da(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var A=Rs(y.pendingLanes);if(A!==0){var T=y;for(T.pendingLanes|=2,T.entangledLanes|=2;A;){var M=1<<31-sn(A);T.entanglements[1]|=M,A&=~M}Kn(y),(Lt&6)===0&&(nc=je()+500,so(0))}}break;case 31:case 13:T=Ls(y,2),T!==null&&We(T,y,2),sc(),Ld(y,2)}if(y=Id(h),y===null&&wd(n,s,h,wc,o),y===p)break;p=y}p!==null&&h.stopPropagation()}else wd(n,s,h,null,o)}}function Id(n){return n=ju(n),Pd(n)}var wc=null;function Pd(n){if(wc=null,n=ha(n),n!==null){var s=l(n);if(s===null)n=null;else{var o=s.tag;if(o===13){if(n=c(s),n!==null)return n;n=null}else if(o===31){if(n=u(s),n!==null)return n;n=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return wc=n,null}function wy(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Tu()){case Ar:return 2;case cl:return 8;case ca:case Yt:return 32;case re:return 268435456;default:return 32}default:return 32}}var jd=!1,us=null,hs=null,ds=null,ho=new Map,fo=new Map,fs=[],UA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xy(n,s){switch(n){case"focusin":case"focusout":us=null;break;case"dragenter":case"dragleave":hs=null;break;case"mouseover":case"mouseout":ds=null;break;case"pointerover":case"pointerout":ho.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":fo.delete(s.pointerId)}}function po(n,s,o,h,p,y){return n===null||n.nativeEvent!==y?(n={blockedOn:s,domEventName:o,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},s!==null&&(s=da(s),s!==null&&by(s)),n):(n.eventSystemFlags|=h,s=n.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),n)}function FA(n,s,o,h,p){switch(s){case"focusin":return us=po(us,n,s,o,h,p),!0;case"dragenter":return hs=po(hs,n,s,o,h,p),!0;case"mouseover":return ds=po(ds,n,s,o,h,p),!0;case"pointerover":var y=p.pointerId;return ho.set(y,po(ho.get(y)||null,n,s,o,h,p)),!0;case"gotpointercapture":return y=p.pointerId,fo.set(y,po(fo.get(y)||null,n,s,o,h,p)),!0}return!1}function Ay(n){var s=ha(n.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){n.blockedOn=s,Pp(n.priority,function(){vy(o)});return}}else if(s===31){if(s=u(o),s!==null){n.blockedOn=s,Pp(n.priority,function(){vy(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function xc(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var o=Id(n.nativeEvent);if(o===null){o=n.nativeEvent;var h=new o.constructor(o.type,o);Pu=h,o.target.dispatchEvent(h),Pu=null}else return s=da(o),s!==null&&by(s),n.blockedOn=o,!1;s.shift()}return!0}function Sy(n,s,o){xc(n)&&o.delete(s)}function zA(){jd=!1,us!==null&&xc(us)&&(us=null),hs!==null&&xc(hs)&&(hs=null),ds!==null&&xc(ds)&&(ds=null),ho.forEach(Sy),fo.forEach(Sy)}function Ac(n,s){n.blockedOn===s&&(n.blockedOn=null,jd||(jd=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zA)))}var Sc=null;function _y(n){Sc!==n&&(Sc=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Sc===n&&(Sc=null);for(var s=0;s<n.length;s+=3){var o=n[s],h=n[s+1],p=n[s+2];if(typeof h!="function"){if(Pd(h||o)===null)continue;break}var y=da(o);y!==null&&(n.splice(s,3),s-=3,Ih(y,{pending:!0,data:p,method:o.method,action:h},h,p))}}))}function Ya(n){function s(M){return Ac(M,n)}us!==null&&Ac(us,n),hs!==null&&Ac(hs,n),ds!==null&&Ac(ds,n),ho.forEach(s),fo.forEach(s);for(var o=0;o<fs.length;o++){var h=fs[o];h.blockedOn===n&&(h.blockedOn=null)}for(;0<fs.length&&(o=fs[0],o.blockedOn===null);)Ay(o),o.blockedOn===null&&fs.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var p=o[h],y=o[h+1],A=p[Ve]||null;if(typeof y=="function")A||_y(o);else if(A){var T=null;if(y&&y.hasAttribute("formAction")){if(p=y,A=y[Ve]||null)T=A.formAction;else if(Pd(p)!==null)continue}else T=A.action;typeof T=="function"?o[h+1]=T:(o.splice(h,3),h-=3),_y(o)}}}function Ey(){function n(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(A){return p=A})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),h||setTimeout(o,20)}function o(){if(!h&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,p=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){h=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function Bd(n){this._internalRoot=n}_c.prototype.render=Bd.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,h=hn();gy(o,h,n,s,null,null)},_c.prototype.unmount=Bd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;gy(n.current,2,null,n,null,null),sc(),s[ua]=null}};function _c(n){this._internalRoot=n}_c.prototype.unstable_scheduleHydration=function(n){if(n){var s=Ip();n={blockedOn:null,target:n,priority:s};for(var o=0;o<fs.length&&s!==0&&s<fs[o].priority;o++);fs.splice(o,0,n),o===0&&Ay(n)}};var Ty=t.version;if(Ty!=="19.2.4")throw Error(i(527,Ty,"19.2.4"));q.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=f(s),n=n!==null?m(n):null,n=n===null?null:n.stateNode,n};var HA={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ec=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ec.isDisabled&&Ec.supportsFiber)try{Vi=Ec.inject(HA),nn=Ec}catch{}}return go.createRoot=function(n,s){if(!a(n))throw Error(i(299));var o=!1,h="",p=Lg,y=Og,A=Ig;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(A=s.onRecoverableError)),s=py(n,1,!1,null,null,o,h,null,p,y,A,Ey),n[ua]=s.current,vd(n),new Bd(s)},go.hydrateRoot=function(n,s,o){if(!a(n))throw Error(i(299));var h=!1,p="",y=Lg,A=Og,T=Ig,M=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(A=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError),o.formState!==void 0&&(M=o.formState)),s=py(n,1,!0,s,o??null,h,p,M,y,A,T,Ey),s.context=my(null),o=s.current,h=hn(),h=Ru(h),p=Zi(h),p.callback=null,Ji(o,p,h),o=h,s.current.lanes=o,_r(s,o),Kn(s),n[ua]=s.current,vd(n),new _c(s)},go.version="19.2.4",go}var By;function ZA(){if(By)return Hd.exports;By=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Hd.exports=QA(),Hd.exports}var JA=ZA();const tS=lv(JA);var Uy="popstate";function eS(r={}){function t(i,a){let{pathname:l,search:c,hash:u}=i.location;return bf("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(i,a){return typeof a=="string"?a:Lo(a)}return iS(t,e,null,r)}function te(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function zn(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function nS(){return Math.random().toString(36).substring(2,10)}function Fy(r,t){return{usr:r.state,key:r.key,idx:t}}function bf(r,t,e=null,i){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?fr(t):t,state:e,key:t&&t.key||i||nS()}}function Lo({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function fr(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let i=r.indexOf("?");i>=0&&(t.search=r.substring(i),r=r.substring(0,i)),r&&(t.pathname=r)}return t}function iS(r,t,e,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,u="POP",d=null,f=m();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function m(){return(c.state||{idx:null}).idx}function g(){u="POP";let S=m(),E=S==null?null:S-f;f=S,d&&d({action:u,location:x.location,delta:E})}function v(S,E){u="PUSH";let R=bf(x.location,S,E);f=m()+1;let C=Fy(R,f),D=x.createHref(R);try{c.pushState(C,"",D)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;a.location.assign(D)}l&&d&&d({action:u,location:x.location,delta:1})}function w(S,E){u="REPLACE";let R=bf(x.location,S,E);f=m();let C=Fy(R,f),D=x.createHref(R);c.replaceState(C,"",D),l&&d&&d({action:u,location:x.location,delta:0})}function _(S){return sS(S)}let x={get action(){return u},get location(){return r(a,c)},listen(S){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(Uy,g),d=S,()=>{a.removeEventListener(Uy,g),d=null}},createHref(S){return t(a,S)},createURL:_,encodeLocation(S){let E=_(S);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:v,replace:w,go(S){return c.go(S)}};return x}function sS(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),te(e,"No window.location.(origin|href) available to create URL");let i=typeof r=="string"?r:Lo(r);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function cv(r,t,e="/"){return aS(r,t,e,!1)}function aS(r,t,e,i){let a=typeof t=="string"?fr(t):t,l=Li(a.pathname||"/",e);if(l==null)return null;let c=uv(r);rS(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let f=yS(l);u=mS(c[d],f,i)}return u}function uv(r,t=[],e=[],i="",a=!1){let l=(c,u,d=a,f)=>{let m={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(i)&&d)return;te(m.relativePath.startsWith(i),`Absolute route path "${m.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(i.length)}let g=ki([i,m.relativePath]),v=e.concat(m);c.children&&c.children.length>0&&(te(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),uv(c.children,t,v,g,d)),!(c.path==null&&!c.index)&&t.push({path:g,score:fS(g,c.index),routesMeta:v})};return r.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let d of hv(c.path))l(c,u,!0,d)}),t}function hv(r){let t=r.split("/");if(t.length===0)return[];let[e,...i]=t,a=e.endsWith("?"),l=e.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=hv(i.join("/")),u=[];return u.push(...c.map(d=>d===""?l:[l,d].join("/"))),a&&u.push(...c),u.map(d=>r.startsWith("/")&&d===""?"/":d)}function rS(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:pS(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var oS=/^:[\w-]+$/,lS=3,cS=2,uS=1,hS=10,dS=-2,zy=r=>r==="*";function fS(r,t){let e=r.split("/"),i=e.length;return e.some(zy)&&(i+=dS),t&&(i+=cS),e.filter(a=>!zy(a)).reduce((a,l)=>a+(oS.test(l)?lS:l===""?uS:hS),i)}function pS(r,t){return r.length===t.length&&r.slice(0,-1).every((i,a)=>i===t[a])?r[r.length-1]-t[t.length-1]:0}function mS(r,t,e=!1){let{routesMeta:i}=r,a={},l="/",c=[];for(let u=0;u<i.length;++u){let d=i[u],f=u===i.length-1,m=l==="/"?t:t.slice(l.length)||"/",g=Yc({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},m),v=d.route;if(!g&&f&&e&&!i[i.length-1].route.index&&(g=Yc({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!g)return null;Object.assign(a,g.params),c.push({params:a,pathname:ki([l,g.pathname]),pathnameBase:xS(ki([l,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(l=ki([l,g.pathnameBase]))}return c}function Yc(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,i]=gS(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:i.reduce((f,{paramName:m,isOptional:g},v)=>{if(m==="*"){let _=u[v]||"";c=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const w=u[v];return g&&!w?f[m]=void 0:f[m]=(w||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:r}}function gS(r,t=!1,e=!0){zn(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let i=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(i.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}function yS(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return zn(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function Li(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=r.charAt(e);return i&&i!=="/"?null:r.slice(e)||"/"}var bS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function vS(r,t="/"){let{pathname:e,search:i="",hash:a=""}=typeof r=="string"?fr(r):r,l;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?l=Hy(e.substring(1),"/"):l=Hy(e,t)):l=t,{pathname:l,search:AS(i),hash:SS(a)}}function Hy(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function $d(r,t,e,i){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wS(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function Hf(r){let t=wS(r);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function Vf(r,t,e,i=!1){let a;typeof r=="string"?a=fr(r):(a={...r},te(!a.pathname||!a.pathname.includes("?"),$d("?","pathname","search",a)),te(!a.pathname||!a.pathname.includes("#"),$d("#","pathname","hash",a)),te(!a.search||!a.search.includes("#"),$d("#","search","hash",a)));let l=r===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=e;else{let g=t.length-1;if(!i&&c.startsWith("..")){let v=c.split("/");for(;v[0]==="..";)v.shift(),g-=1;a.pathname=v.join("/")}u=g>=0?t[g]:"/"}let d=vS(a,u),f=c&&c!=="/"&&c.endsWith("/"),m=(l||c===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||m)&&(d.pathname+="/"),d}var ki=r=>r.join("/").replace(/\/\/+/g,"/"),xS=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),AS=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,SS=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,_S=class{constructor(r,t,e,i=!1){this.status=r,this.statusText=t||"",this.internal=i,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function ES(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function TS(r){return r.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var dv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function fv(r,t){let e=r;if(typeof e!="string"||!bS.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let i=e,a=!1;if(dv)try{let l=new URL(window.location.href),c=e.startsWith("//")?new URL(l.protocol+e):new URL(e),u=Li(c.pathname,t);c.origin===l.origin&&u!=null?e=u+c.search+c.hash:a=!0}catch{zn(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var pv=["POST","PUT","PATCH","DELETE"];new Set(pv);var CS=["GET",...pv];new Set(CS);var pr=I.createContext(null);pr.displayName="DataRouter";var hu=I.createContext(null);hu.displayName="DataRouterState";var RS=I.createContext(!1),mv=I.createContext({isTransitioning:!1});mv.displayName="ViewTransition";var DS=I.createContext(new Map);DS.displayName="Fetchers";var NS=I.createContext(null);NS.displayName="Await";var gn=I.createContext(null);gn.displayName="Navigation";var Go=I.createContext(null);Go.displayName="Location";var Vn=I.createContext({outlet:null,matches:[],isDataRoute:!1});Vn.displayName="Route";var Gf=I.createContext(null);Gf.displayName="RouteError";var gv="REACT_ROUTER_ERROR",MS="REDIRECT",kS="ROUTE_ERROR_RESPONSE";function LS(r){if(r.startsWith(`${gv}:${MS}:{`))try{let t=JSON.parse(r.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function OS(r){if(r.startsWith(`${gv}:${kS}:{`))try{let t=JSON.parse(r.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new _S(t.status,t.statusText,t.data)}catch{}}function IS(r,{relative:t}={}){te(mr(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=I.useContext(gn),{hash:a,pathname:l,search:c}=qo(r,{relative:t}),u=l;return e!=="/"&&(u=l==="/"?e:ki([e,l])),i.createHref({pathname:u,search:c,hash:a})}function mr(){return I.useContext(Go)!=null}function yn(){return te(mr(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(Go).location}var yv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function bv(r){I.useContext(gn).static||I.useLayoutEffect(r)}function Ts(){let{isDataRoute:r}=I.useContext(Vn);return r?XS():PS()}function PS(){te(mr(),"useNavigate() may be used only in the context of a <Router> component.");let r=I.useContext(pr),{basename:t,navigator:e}=I.useContext(gn),{matches:i}=I.useContext(Vn),{pathname:a}=yn(),l=JSON.stringify(Hf(i)),c=I.useRef(!1);return bv(()=>{c.current=!0}),I.useCallback((d,f={})=>{if(zn(c.current,yv),!c.current)return;if(typeof d=="number"){e.go(d);return}let m=Vf(d,JSON.parse(l),a,f.relative==="path");r==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:ki([t,m.pathname])),(f.replace?e.replace:e.push)(m,f.state,f)},[t,e,l,a,r])}I.createContext(null);function vv(){let{matches:r}=I.useContext(Vn),t=r[r.length-1];return t?t.params:{}}function qo(r,{relative:t}={}){let{matches:e}=I.useContext(Vn),{pathname:i}=yn(),a=JSON.stringify(Hf(e));return I.useMemo(()=>Vf(r,JSON.parse(a),i,t==="path"),[r,a,i,t])}function jS(r,t){return wv(r,t)}function wv(r,t,e,i,a){te(mr(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=I.useContext(gn),{matches:c}=I.useContext(Vn),u=c[c.length-1],d=u?u.params:{},f=u?u.pathname:"/",m=u?u.pathnameBase:"/",g=u&&u.route;{let R=g&&g.path||"";Av(f,!g||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let v=yn(),w;if(t){let R=typeof t=="string"?fr(t):t;te(m==="/"||R.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${R.pathname}" was given in the \`location\` prop.`),w=R}else w=v;let _=w.pathname||"/",x=_;if(m!=="/"){let R=m.replace(/^\//,"").split("/");x="/"+_.replace(/^\//,"").split("/").slice(R.length).join("/")}let S=cv(r,{pathname:x});zn(g||S!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),zn(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=HS(S&&S.map(R=>Object.assign({},R,{params:Object.assign({},d,R.params),pathname:ki([m,l.encodeLocation?l.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?m:ki([m,l.encodeLocation?l.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),c,e,i,a);return t&&E?I.createElement(Go.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},E):E}function BS(){let r=YS(),t=ES(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",r),c=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:l},"ErrorBoundary")," or"," ",I.createElement("code",{style:l},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),e?I.createElement("pre",{style:a},e):null,c)}var US=I.createElement(BS,null),xv=class extends I.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.onError?this.props.onError(r,t):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const e=OS(r.digest);e&&(r=e)}let t=r!==void 0?I.createElement(Vn.Provider,{value:this.props.routeContext},I.createElement(Gf.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?I.createElement(FS,{error:r},t):t}};xv.contextType=RS;var Yd=new WeakMap;function FS({children:r,error:t}){let{basename:e}=I.useContext(gn);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let i=LS(t.digest);if(i){let a=Yd.get(t);if(a)throw a;let l=fv(i.location,e);if(dv&&!Yd.get(t))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw Yd.set(t,c),c}return I.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return r}function zS({routeContext:r,match:t,children:e}){let i=I.useContext(pr);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),I.createElement(Vn.Provider,{value:r},e)}function HS(r,t=[],e=null,i=null,a=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let l=r,c=e?.errors;if(c!=null){let m=l.findIndex(g=>g.route.id&&c?.[g.route.id]!==void 0);te(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,m+1))}let u=!1,d=-1;if(e)for(let m=0;m<l.length;m++){let g=l[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(d=m),g.route.id){let{loaderData:v,errors:w}=e,_=g.route.loader&&!v.hasOwnProperty(g.route.id)&&(!w||w[g.route.id]===void 0);if(g.route.lazy||_){u=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}let f=e&&i?(m,g)=>{i(m,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:TS(e.matches),errorInfo:g})}:void 0;return l.reduceRight((m,g,v)=>{let w,_=!1,x=null,S=null;e&&(w=c&&g.route.id?c[g.route.id]:void 0,x=g.route.errorElement||US,u&&(d<0&&v===0?(Av("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,S=null):d===v&&(_=!0,S=g.route.hydrateFallbackElement||null)));let E=t.concat(l.slice(0,v+1)),R=()=>{let C;return w?C=x:_?C=S:g.route.Component?C=I.createElement(g.route.Component,null):g.route.element?C=g.route.element:C=m,I.createElement(zS,{match:g,routeContext:{outlet:m,matches:E,isDataRoute:e!=null},children:C})};return e&&(g.route.ErrorBoundary||g.route.errorElement||v===0)?I.createElement(xv,{location:e.location,revalidation:e.revalidation,component:x,error:w,children:R(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:f}):R()},null)}function qf(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function VS(r){let t=I.useContext(pr);return te(t,qf(r)),t}function GS(r){let t=I.useContext(hu);return te(t,qf(r)),t}function qS(r){let t=I.useContext(Vn);return te(t,qf(r)),t}function $f(r){let t=qS(r),e=t.matches[t.matches.length-1];return te(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function $S(){return $f("useRouteId")}function YS(){let r=I.useContext(Gf),t=GS("useRouteError"),e=$f("useRouteError");return r!==void 0?r:t.errors?.[e]}function XS(){let{router:r}=VS("useNavigate"),t=$f("useNavigate"),e=I.useRef(!1);return bv(()=>{e.current=!0}),I.useCallback(async(a,l={})=>{zn(e.current,yv),e.current&&(typeof a=="number"?await r.navigate(a):await r.navigate(a,{fromRouteId:t,...l}))},[r,t])}var Vy={};function Av(r,t,e){!t&&!Vy[r]&&(Vy[r]=!0,zn(!1,e))}I.memo(WS);function WS({routes:r,future:t,state:e,onError:i}){return wv(r,void 0,e,i,t)}function Gy({to:r,replace:t,state:e,relative:i}){te(mr(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=I.useContext(gn);zn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=I.useContext(Vn),{pathname:c}=yn(),u=Ts(),d=Vf(r,Hf(l),c,i==="path"),f=JSON.stringify(d);return I.useEffect(()=>{u(JSON.parse(f),{replace:t,state:e,relative:i})},[u,f,i,t,e]),null}function _e(r){te(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KS({basename:r="/",children:t=null,location:e,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){te(!mr(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=r.replace(/^\/*/,"/"),d=I.useMemo(()=>({basename:u,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[u,a,l,c]);typeof e=="string"&&(e=fr(e));let{pathname:f="/",search:m="",hash:g="",state:v=null,key:w="default"}=e,_=I.useMemo(()=>{let x=Li(f,u);return x==null?null:{location:{pathname:x,search:m,hash:g,state:v,key:w},navigationType:i}},[u,f,m,g,v,w,i]);return zn(_!=null,`<Router basename="${u}"> is not able to match the URL "${f}${m}${g}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:I.createElement(gn.Provider,{value:d},I.createElement(Go.Provider,{children:t,value:_}))}function QS({children:r,location:t}){return jS(vf(r),t)}function vf(r,t=[]){let e=[];return I.Children.forEach(r,(i,a)=>{if(!I.isValidElement(i))return;let l=[...t,a];if(i.type===I.Fragment){e.push.apply(e,vf(i.props.children,l));return}te(i.type===_e,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),te(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=vf(i.props.children,l)),e.push(c)}),e}var Uc="get",Fc="application/x-www-form-urlencoded";function du(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function ZS(r){return du(r)&&r.tagName.toLowerCase()==="button"}function JS(r){return du(r)&&r.tagName.toLowerCase()==="form"}function t_(r){return du(r)&&r.tagName.toLowerCase()==="input"}function e_(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function n_(r,t){return r.button===0&&(!t||t==="_self")&&!e_(r)}var Tc=null;function i_(){if(Tc===null)try{new FormData(document.createElement("form"),0),Tc=!1}catch{Tc=!0}return Tc}var s_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Xd(r){return r!=null&&!s_.has(r)?(zn(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Fc}"`),null):r}function a_(r,t){let e,i,a,l,c;if(JS(r)){let u=r.getAttribute("action");i=u?Li(u,t):null,e=r.getAttribute("method")||Uc,a=Xd(r.getAttribute("enctype"))||Fc,l=new FormData(r)}else if(ZS(r)||t_(r)&&(r.type==="submit"||r.type==="image")){let u=r.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=r.getAttribute("formaction")||u.getAttribute("action");if(i=d?Li(d,t):null,e=r.getAttribute("formmethod")||u.getAttribute("method")||Uc,a=Xd(r.getAttribute("formenctype"))||Xd(u.getAttribute("enctype"))||Fc,l=new FormData(u,r),!i_()){let{name:f,type:m,value:g}=r;if(m==="image"){let v=f?`${f}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else f&&l.append(f,g)}}else{if(du(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Uc,i=null,a=Fc,c=r}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:e.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Yf(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function r_(r,t,e,i){let a=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${i}`:a.pathname=`${a.pathname}.${i}`:a.pathname==="/"?a.pathname=`_root.${i}`:t&&Li(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${i}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${i}`,a}async function o_(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function l_(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function c_(r,t,e){let i=await Promise.all(r.map(async a=>{let l=t.routes[a.route.id];if(l){let c=await o_(l,e);return c.links?c.links():[]}return[]}));return f_(i.flat(1).filter(l_).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function qy(r,t,e,i,a,l){let c=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,u=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return l==="assets"?t.filter((d,f)=>c(d,f)||u(d,f)):l==="data"?t.filter((d,f)=>{let m=i.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(c(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let g=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function u_(r,t,{includeHydrateFallback:e}={}){return h_(r.map(i=>{let a=t.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function h_(r){return[...new Set(r)]}function d_(r){let t={},e=Object.keys(r).sort();for(let i of e)t[i]=r[i];return t}function f_(r,t){let e=new Set;return new Set(t),r.reduce((i,a)=>{let l=JSON.stringify(d_(a));return e.has(l)||(e.add(l),i.push({key:l,link:a})),i},[])}function Sv(){let r=I.useContext(pr);return Yf(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function p_(){let r=I.useContext(hu);return Yf(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var Xf=I.createContext(void 0);Xf.displayName="FrameworkContext";function _v(){let r=I.useContext(Xf);return Yf(r,"You must render this element inside a <HydratedRouter> element"),r}function m_(r,t){let e=I.useContext(Xf),[i,a]=I.useState(!1),[l,c]=I.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:m,onTouchStart:g}=t,v=I.useRef(null);I.useEffect(()=>{if(r==="render"&&c(!0),r==="viewport"){let x=E=>{E.forEach(R=>{c(R.isIntersecting)})},S=new IntersectionObserver(x,{threshold:.5});return v.current&&S.observe(v.current),()=>{S.disconnect()}}},[r]),I.useEffect(()=>{if(i){let x=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(x)}}},[i]);let w=()=>{a(!0)},_=()=>{a(!1),c(!1)};return e?r!=="intent"?[l,v,{}]:[l,v,{onFocus:yo(u,w),onBlur:yo(d,_),onMouseEnter:yo(f,w),onMouseLeave:yo(m,_),onTouchStart:yo(g,w)}]:[!1,v,{}]}function yo(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function g_({page:r,...t}){let{router:e}=Sv(),i=I.useMemo(()=>cv(e.routes,r,e.basename),[e.routes,r,e.basename]);return i?I.createElement(b_,{page:r,matches:i,...t}):null}function y_(r){let{manifest:t,routeModules:e}=_v(),[i,a]=I.useState([]);return I.useEffect(()=>{let l=!1;return c_(r,t,e).then(c=>{l||a(c)}),()=>{l=!0}},[r,t,e]),i}function b_({page:r,matches:t,...e}){let i=yn(),{future:a,manifest:l,routeModules:c}=_v(),{basename:u}=Sv(),{loaderData:d,matches:f}=p_(),m=I.useMemo(()=>qy(r,t,f,l,i,"data"),[r,t,f,l,i]),g=I.useMemo(()=>qy(r,t,f,l,i,"assets"),[r,t,f,l,i]),v=I.useMemo(()=>{if(r===i.pathname+i.search+i.hash)return[];let x=new Set,S=!1;if(t.forEach(R=>{let C=l.routes[R.route.id];!C||!C.hasLoader||(!m.some(D=>D.route.id===R.route.id)&&R.route.id in d&&c[R.route.id]?.shouldRevalidate||C.hasClientLoader?S=!0:x.add(R.route.id))}),x.size===0)return[];let E=r_(r,u,a.unstable_trailingSlashAwareDataRequests,"data");return S&&x.size>0&&E.searchParams.set("_routes",t.filter(R=>x.has(R.route.id)).map(R=>R.route.id).join(",")),[E.pathname+E.search]},[u,a.unstable_trailingSlashAwareDataRequests,d,i,l,m,t,r,c]),w=I.useMemo(()=>u_(g,l),[g,l]),_=y_(g);return I.createElement(I.Fragment,null,v.map(x=>I.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...e})),w.map(x=>I.createElement("link",{key:x,rel:"modulepreload",href:x,...e})),_.map(({key:x,link:S})=>I.createElement("link",{key:x,nonce:e.nonce,...S,crossOrigin:S.crossOrigin??e.crossOrigin})))}function v_(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var w_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{w_&&(window.__reactRouterVersion="7.13.0")}catch{}function x_({basename:r,children:t,unstable_useTransitions:e,window:i}){let a=I.useRef();a.current==null&&(a.current=eS({window:i,v5Compat:!0}));let l=a.current,[c,u]=I.useState({action:l.action,location:l.location}),d=I.useCallback(f=>{e===!1?u(f):I.startTransition(()=>u(f))},[e]);return I.useLayoutEffect(()=>l.listen(d),[l,d]),I.createElement(KS,{basename:r,children:t,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:e})}var Ev=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xt=I.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:u,target:d,to:f,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:v,...w},_){let{basename:x,unstable_useTransitions:S}=I.useContext(gn),E=typeof f=="string"&&Ev.test(f),R=fv(f,x);f=R.to;let C=IS(f,{relative:a}),[D,N,L]=m_(i,w),j=E_(f,{replace:c,state:u,target:d,preventScrollReset:m,relative:a,viewTransition:g,unstable_defaultShouldRevalidate:v,unstable_useTransitions:S});function K($){t&&t($),$.defaultPrevented||j($)}let Y=I.createElement("a",{...w,...L,href:R.absoluteURL||C,onClick:R.isExternal||l?t:K,ref:v_(_,N),target:d,"data-discover":!E&&e==="render"?"true":void 0});return D&&!E?I.createElement(I.Fragment,null,Y,I.createElement(g_,{page:C})):Y});Xt.displayName="Link";var A_=I.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:u,children:d,...f},m){let g=qo(c,{relative:f.relative}),v=yn(),w=I.useContext(hu),{navigator:_,basename:x}=I.useContext(gn),S=w!=null&&N_(g)&&u===!0,E=_.encodeLocation?_.encodeLocation(g).pathname:g.pathname,R=v.pathname,C=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;e||(R=R.toLowerCase(),C=C?C.toLowerCase():null,E=E.toLowerCase()),C&&x&&(C=Li(C,x)||C);const D=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let N=R===E||!a&&R.startsWith(E)&&R.charAt(D)==="/",L=C!=null&&(C===E||!a&&C.startsWith(E)&&C.charAt(E.length)==="/"),j={isActive:N,isPending:L,isTransitioning:S},K=N?t:void 0,Y;typeof i=="function"?Y=i(j):Y=[i,N?"active":null,L?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let $=typeof l=="function"?l(j):l;return I.createElement(Xt,{...f,"aria-current":K,className:Y,ref:m,style:$,to:c,viewTransition:u},typeof d=="function"?d(j):d)});A_.displayName="NavLink";var S_=I.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:a,state:l,method:c=Uc,action:u,onSubmit:d,relative:f,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:v,...w},_)=>{let{unstable_useTransitions:x}=I.useContext(gn),S=R_(),E=D_(u,{relative:f}),R=c.toLowerCase()==="get"?"get":"post",C=typeof u=="string"&&Ev.test(u),D=N=>{if(d&&d(N),N.defaultPrevented)return;N.preventDefault();let L=N.nativeEvent.submitter,j=L?.getAttribute("formmethod")||c,K=()=>S(L||N.currentTarget,{fetcherKey:t,method:j,navigate:e,replace:a,state:l,relative:f,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:v});x&&e!==!1?I.startTransition(()=>K()):K()};return I.createElement("form",{ref:_,method:R,action:E,onSubmit:i?d:D,...w,"data-discover":!C&&r==="render"?"true":void 0})});S_.displayName="Form";function __(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Tv(r){let t=I.useContext(pr);return te(t,__(r)),t}function E_(r,{target:t,replace:e,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let f=Ts(),m=yn(),g=qo(r,{relative:l});return I.useCallback(v=>{if(n_(v,t)){v.preventDefault();let w=e!==void 0?e:Lo(m)===Lo(g),_=()=>f(r,{replace:w,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u});d?I.startTransition(()=>_()):_()}},[m,f,g,e,i,t,r,a,l,c,u,d])}var T_=0,C_=()=>`__${String(++T_)}__`;function R_(){let{router:r}=Tv("useSubmit"),{basename:t}=I.useContext(gn),e=$S(),i=r.fetch,a=r.navigate;return I.useCallback(async(l,c={})=>{let{action:u,method:d,encType:f,formData:m,body:g}=a_(l,t);if(c.navigate===!1){let v=c.fetcherKey||C_();await i(v,e,c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:m,body:g,formMethod:c.method||d,formEncType:c.encType||f,flushSync:c.flushSync})}else await a(c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:m,body:g,formMethod:c.method||d,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:e,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,t,e])}function D_(r,{relative:t}={}){let{basename:e}=I.useContext(gn),i=I.useContext(Vn);te(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...qo(r||".",{relative:t})},c=yn();if(r==null){l.search=c.search;let u=new URLSearchParams(l.search),d=u.getAll("index");if(d.some(m=>m==="")){u.delete("index"),d.filter(g=>g).forEach(g=>u.append("index",g));let m=u.toString();l.search=m?`?${m}`:""}}return(!r||r===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(l.pathname=l.pathname==="/"?e:ki([e,l.pathname])),Lo(l)}function N_(r,{relative:t}={}){let e=I.useContext(mv);te(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Tv("useViewTransitionState"),a=qo(r,{relative:t});if(!e.isTransitioning)return!1;let l=Li(e.currentLocation.pathname,i)||e.currentLocation.pathname,c=Li(e.nextLocation.pathname,i)||e.nextLocation.pathname;return Yc(a.pathname,c)!=null||Yc(a.pathname,l)!=null}const $y={primary:"bg-slate-900 text-white border border-transparent hover:bg-slate-800 shadow-lg shadow-slate-900/20",secondary:"bg-white text-slate-900 border border-slate-200 hover:bg-slate-50 shadow-sm",outline:"bg-transparent text-slate-600 border border-slate-200 hover:border-slate-300 hover:text-slate-900",ghost:"bg-transparent text-slate-600 border border-transparent hover:bg-slate-100 hover:text-slate-900"},Yy={sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-sm",lg:"px-8 py-4 text-base"},Xc=({variant:r="primary",size:t="md",className:e="",href:i,to:a,onClick:l,children:c,type:u="button",...d})=>{const f="inline-flex items-center justify-center font-bold rounded-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",m=$y[r]||$y.primary,g=Yy[t]||Yy.md,v=`${f} ${m} ${g} ${e}`;return a?b.jsx(Xt,{to:a,className:v,...d,children:c}):i?b.jsx("a",{href:i,className:v,...d,children:c}):b.jsx("button",{type:u,onClick:l,className:v,...d,children:c})},Wf="data:image/svg+xml,%3csvg%20width='630'%20height='718'%20viewBox='0%200%20630%20718'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M507.588%20467.968V382.194L437.065%20422.437V508.279L507.588%20467.968Z'%20fill='%2315D6E3'/%3e%3cpath%20d='M507.588%20247.995L434.559%20206.201L315.313%20274.417L196.068%20206.201L123.038%20247.995V323.966L244.293%20393.349V537.261L315.313%20577.888L386.334%20537.261V393.349L507.588%20323.966V247.995Z'%20fill='%233A36FF'/%3e%3cpath%20d='M630.006%20254.748V178.525L557.185%20136.592L486.298%20177.354L559.119%20219.288V295.511L630.006%20254.748Z'%20fill='%233A36FF'/%3e%3cpath%20d='M71.5074%20295.511V219.288L144.328%20177.354L73.4419%20136.592L0.620972%20178.525V254.748L71.5074%20295.511Z'%20fill='%233A36FF'/%3e%3cpath%20d='M123.038%20467.968L193.561%20508.279V422.437L123.038%20382.194V467.968Z'%20fill='%233998FF'/%3e%3cpath%20d='M386.502%20594.962L315.313%20635.677L244.125%20594.962V676.392L315.313%20717.107L386.502%20676.392V594.962Z'%20fill='%233A36FF'/%3e%3cpath%20d='M383.84%20177.307L315.313%20137.905L246.786%20177.307L315.313%20216.708L383.84%20177.307Z'%20fill='%238A88FF'/%3e%3cpath%20d='M558.695%20353.18V496.979L437.065%20566.307V647.497L630.006%20537.574V312.585L558.695%20353.18Z'%20fill='%2315D7E3'/%3e%3cpath%20d='M193.561%20566.307L71.931%20496.979V353.18L0.620972%20312.585V537.574L193.561%20647.497V566.307Z'%20fill='%233998FF'/%3e%3cpath%20d='M195.686%20148.412L315.313%2080.7477L434.94%20148.412L506.258%20108.072L315.313%200L124.369%20108.072L195.686%20148.412Z'%20fill='%238A88FF'/%3e%3c/svg%3e",M_=["Northwind Legal","Acme Ventures","Solaris Health","Beacon Realty","Atlas Finance","Bluebird Energy"],k_=[{label:"Docs decoded",value:"42k+"},{label:"Average time saved",value:"3.4 hrs"},{label:"Risk flags identified",value:"128k+"}],L_=[{title:"Upload or open a PDF",description:"Drop in a contract, policy, or report. No setup required."},{title:"Decode with AI",description:"We translate the text, highlight obligations, and surface risks."},{title:"Act with clarity",description:"Export notes or send for signature only when you are ready."}],O_=[{title:"Plain-language summaries",description:"Every section is rewritten into clear, actionable language."},{title:"Risk and obligation flags",description:"Spot penalties, expiry traps, and one-sided clauses fast."},{title:"Side-by-side evidence",description:"See the original text next to the AI explanation."},{title:"Shareable decision reports",description:"Create a clean, board-ready summary in one click."},{title:"Structured highlights",description:"Tag sections as financial, legal, or operational."},{title:"Secure by design",description:"Free mode never stores files. Pro adds private vaults."}],I_=[{title:"Procurement teams",description:"Speed up vendor reviews without missing hidden liabilities."},{title:"Startup founders",description:"Understand term sheets and SaaS agreements fast."},{title:"HR & people ops",description:"Review contracts, handbooks, and compliance updates with confidence."},{title:"Property managers",description:"Decode leases, maintenance agreements, and building policies."}],Wd={product:[{label:"How it works",href:"#how-it-works"},{label:"Use cases",href:"#use-cases"},{label:"Pricing",href:"#pricing"}],company:[{label:"About",href:"/about"},{label:"Contact",href:"/contact"}],legal:[{label:"Privacy",href:"/privacy"},{label:"Terms",href:"/terms"}]},P_="0.1.0+ec871fb-2026-02-10T11:13:40.019Z",Kd=({href:r,children:t})=>{const e=typeof r=="string"&&/^https?:\/\//.test(r),i=typeof r=="string"&&r.startsWith("#");return e?b.jsx("a",{className:"text-slate-600 no-underline hover:text-slate-900 hover:underline",href:r,children:t}):i?b.jsx(Xt,{className:"text-slate-600 no-underline hover:text-slate-900 hover:underline",to:{pathname:"/",hash:r},children:t}):b.jsx(Xt,{className:"text-slate-600 no-underline hover:text-slate-900 hover:underline",to:r,children:t})},Cv=()=>{const t=yn().pathname==="/";return b.jsx("footer",{className:"border-t border-slate-200 bg-white px-6 py-12",children:b.jsxs("div",{className:"mx-auto grid w-full max-w-6xl gap-10 md:grid-cols-[1.2fr_0.8fr_0.8fr_0.8fr]",children:[b.jsxs("div",{className:"flex flex-col gap-4",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("img",{src:Wf,alt:"DecoDocs",className:"h-10 w-10"}),b.jsxs("div",{children:[b.jsx("p",{className:"text-base font-semibold text-slate-900",children:"DecoDocs"}),b.jsx("p",{className:"text-xs text-slate-500",children:"Understand documents before you sign"})]})]}),b.jsx("p",{className:"text-sm text-slate-600",children:"Privacy-first document understanding by Snap Sign Pty Ltd."}),b.jsxs("p",{className:"text-xs text-slate-500",children:[" ",new Date().getFullYear()," Snap Sign Pty Ltd. All rights reserved."]}),b.jsxs("p",{className:"text-xs text-slate-400",children:["Version: ",P_]})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Product"}),b.jsx("ul",{className:"mt-4 space-y-3 text-sm text-slate-600 list-none p-0 m-0",children:Wd.product.map(e=>b.jsx("li",{className:"m-0",children:t&&typeof e.href=="string"&&e.href.startsWith("#")?b.jsx("a",{className:"text-slate-600 no-underline hover:text-slate-900 hover:underline",href:e.href,children:e.label}):b.jsx(Kd,{href:e.href,children:e.label})},e.label))})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Company"}),b.jsx("ul",{className:"mt-4 space-y-3 text-sm text-slate-600 list-none p-0 m-0",children:Wd.company.map(e=>b.jsx("li",{className:"m-0",children:b.jsx(Kd,{href:e.href,children:e.label})},e.label))})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Legal"}),b.jsx("ul",{className:"mt-4 space-y-3 text-sm text-slate-600 list-none p-0 m-0",children:Wd.legal.map(e=>b.jsx("li",{className:"m-0",children:b.jsx(Kd,{href:e.href,children:e.label})},e.label))})]})]})})},j_=()=>{};var Xy={};const Rv=function(r){const t=[];let e=0;for(let i=0;i<r.length;i++){let a=r.charCodeAt(i);a<128?t[e++]=a:a<2048?(t[e++]=a>>6|192,t[e++]=a&63|128):(a&64512)===55296&&i+1<r.length&&(r.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(r.charCodeAt(++i)&1023),t[e++]=a>>18|240,t[e++]=a>>12&63|128,t[e++]=a>>6&63|128,t[e++]=a&63|128):(t[e++]=a>>12|224,t[e++]=a>>6&63|128,t[e++]=a&63|128)}return t},B_=function(r){const t=[];let e=0,i=0;for(;e<r.length;){const a=r[e++];if(a<128)t[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=r[e++];t[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=r[e++],c=r[e++],u=r[e++],d=((a&7)<<18|(l&63)<<12|(c&63)<<6|u&63)-65536;t[i++]=String.fromCharCode(55296+(d>>10)),t[i++]=String.fromCharCode(56320+(d&1023))}else{const l=r[e++],c=r[e++];t[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return t.join("")},Dv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<r.length;a+=3){const l=r[a],c=a+1<r.length,u=c?r[a+1]:0,d=a+2<r.length,f=d?r[a+2]:0,m=l>>2,g=(l&3)<<4|u>>4;let v=(u&15)<<2|f>>6,w=f&63;d||(w=64,c||(v=64)),i.push(e[m],e[g],e[v],e[w])}return i.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(Rv(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):B_(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<r.length;){const l=e[r.charAt(a++)],u=a<r.length?e[r.charAt(a)]:0;++a;const f=a<r.length?e[r.charAt(a)]:64;++a;const g=a<r.length?e[r.charAt(a)]:64;if(++a,l==null||u==null||f==null||g==null)throw new U_;const v=l<<2|u>>4;if(i.push(v),f!==64){const w=u<<4&240|f>>2;if(i.push(w),g!==64){const _=f<<6&192|g;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class U_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const F_=function(r){const t=Rv(r);return Dv.encodeByteArray(t,!0)},Nv=function(r){return F_(r).replace(/\./g,"")},Mv=function(r){try{return Dv.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function z_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const H_=()=>z_().__FIREBASE_DEFAULTS__,V_=()=>{if(typeof process>"u"||typeof Xy>"u")return;const r=Xy.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},G_=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=r&&Mv(r[1]);return t&&JSON.parse(t)},Kf=()=>{try{return j_()||H_()||V_()||G_()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},kv=r=>Kf()?.emulatorHosts?.[r],q_=r=>{const t=kv(r);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},Lv=()=>Kf()?.config,Ov=r=>Kf()?.[`_${r}`];class $_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}function gr(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Iv(r){return(await fetch(r,{credentials:"include"})).ok}const Do={};function Y_(){const r={prod:[],emulator:[]};for(const t of Object.keys(Do))Do[t]?r.emulator.push(t):r.prod.push(t);return r}function X_(r){let t=document.getElementById(r),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",r),e=!0),{created:e,element:t}}let Wy=!1;function Pv(r,t){if(typeof window>"u"||typeof document>"u"||!gr(window.location.host)||Do[r]===t||Do[r]||Wy)return;Do[r]=t;function e(v){return`__firebase__banner__${v}`}const i="__firebase__banner",l=Y_().prod.length>0;function c(){const v=document.getElementById(i);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function d(v,w){v.setAttribute("width","24"),v.setAttribute("id",w),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function f(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{Wy=!0,c()},v}function m(v,w){v.setAttribute("id",w),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function g(){const v=X_(i),w=e("text"),_=document.getElementById(w)||document.createElement("span"),x=e("learnmore"),S=document.getElementById(x)||document.createElement("a"),E=e("preprendIcon"),R=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const C=v.element;u(C),m(S,x);const D=f();d(R,E),C.append(R,_,S,D),document.body.appendChild(C)}l?(_.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function He(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function W_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(He())}function K_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Q_(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Z_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function J_(){const r=He();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function tE(){try{return typeof indexedDB=="object"}catch{return!1}}function eE(){return new Promise((r,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),e||self.indexedDB.deleteDatabase(i),r(!0)},a.onupgradeneeded=()=>{e=!1},a.onerror=()=>{t(a.error?.message||"")}}catch(e){t(e)}})}const nE="FirebaseError";class Fi extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=nE,Object.setPrototypeOf(this,Fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$o.prototype.create)}}class $o{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},a=`${this.service}/${t}`,l=this.errors[t],c=l?iE(l,i):"Error",u=`${this.serviceName}: ${c} (${a}).`;return new Fi(a,u,i)}}function iE(r,t){return r.replace(sE,(e,i)=>{const a=t[i];return a!=null?String(a):`<${i}?>`})}const sE=/\{\$([^}]+)}/g;function aE(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}function lr(r,t){if(r===t)return!0;const e=Object.keys(r),i=Object.keys(t);for(const a of e){if(!i.includes(a))return!1;const l=r[a],c=t[a];if(Ky(l)&&Ky(c)){if(!lr(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!e.includes(a))return!1;return!0}function Ky(r){return r!==null&&typeof r=="object"}function Yo(r){const t=[];for(const[e,i]of Object.entries(r))Array.isArray(i)?i.forEach(a=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(a))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function _o(r){const t={};return r.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");t[decodeURIComponent(a)]=decodeURIComponent(l)}}),t}function Eo(r){const t=r.indexOf("?");if(!t)return"";const e=r.indexOf("#",t);return r.substring(t,e>0?e:void 0)}function rE(r,t){const e=new oE(r,t);return e.subscribe.bind(e)}class oE{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,i){let a;if(t===void 0&&e===void 0&&i===void 0)throw new Error("Missing Observer.");lE(t,["next","error","complete"])?a=t:a={next:t,error:e,complete:i},a.next===void 0&&(a.next=Qd),a.error===void 0&&(a.error=Qd),a.complete===void 0&&(a.complete=Qd);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lE(r,t){if(typeof r!="object"||r===null)return!1;for(const e of t)if(e in r&&typeof r[e]=="function")return!0;return!1}function Qd(){}function en(r){return r&&r._delegate?r._delegate:r}class Js{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const $s="[DEFAULT]";class cE{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new $_;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:e});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),i=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(hE(t))try{this.getOrInitializeService({instanceIdentifier:$s})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(e);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(t=$s){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=$s){return this.instances.has(t)}getOptions(t=$s){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[l,c]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(l);i===u&&c.resolve(a)}return a}onInit(t,e){const i=this.normalizeInstanceIdentifier(e),a=this.onInitCallbacks.get(i)??new Set;a.add(t),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&t(l,i),()=>{a.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const a of i)try{a(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:uE(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=$s){return this.component?this.component.multipleInstances?t:$s:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uE(r){return r===$s?void 0:r}function hE(r){return r.instantiationMode==="EAGER"}class dE{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new cE(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var Gt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Gt||(Gt={}));const fE={debug:Gt.DEBUG,verbose:Gt.VERBOSE,info:Gt.INFO,warn:Gt.WARN,error:Gt.ERROR,silent:Gt.SILENT},pE=Gt.INFO,mE={[Gt.DEBUG]:"log",[Gt.VERBOSE]:"log",[Gt.INFO]:"info",[Gt.WARN]:"warn",[Gt.ERROR]:"error"},gE=(r,t,...e)=>{if(t<r.logLevel)return;const i=new Date().toISOString(),a=mE[t];if(a)console[a](`[${i}]  ${r.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class jv{constructor(t){this.name=t,this._logLevel=pE,this._logHandler=gE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Gt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?fE[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Gt.DEBUG,...t),this._logHandler(this,Gt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Gt.VERBOSE,...t),this._logHandler(this,Gt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Gt.INFO,...t),this._logHandler(this,Gt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Gt.WARN,...t),this._logHandler(this,Gt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Gt.ERROR,...t),this._logHandler(this,Gt.ERROR,...t)}}const yE=(r,t)=>t.some(e=>r instanceof e);let Qy,Zy;function bE(){return Qy||(Qy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vE(){return Zy||(Zy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Bv=new WeakMap,wf=new WeakMap,Uv=new WeakMap,Zd=new WeakMap,Qf=new WeakMap;function wE(r){const t=new Promise((e,i)=>{const a=()=>{r.removeEventListener("success",l),r.removeEventListener("error",c)},l=()=>{e(xs(r.result)),a()},c=()=>{i(r.error),a()};r.addEventListener("success",l),r.addEventListener("error",c)});return t.then(e=>{e instanceof IDBCursor&&Bv.set(e,r)}).catch(()=>{}),Qf.set(t,r),t}function xE(r){if(wf.has(r))return;const t=new Promise((e,i)=>{const a=()=>{r.removeEventListener("complete",l),r.removeEventListener("error",c),r.removeEventListener("abort",c)},l=()=>{e(),a()},c=()=>{i(r.error||new DOMException("AbortError","AbortError")),a()};r.addEventListener("complete",l),r.addEventListener("error",c),r.addEventListener("abort",c)});wf.set(r,t)}let xf={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return wf.get(r);if(t==="objectStoreNames")return r.objectStoreNames||Uv.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return xs(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function AE(r){xf=r(xf)}function SE(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=r.call(Jd(this),t,...e);return Uv.set(i,t.sort?t.sort():[t]),xs(i)}:vE().includes(r)?function(...t){return r.apply(Jd(this),t),xs(Bv.get(this))}:function(...t){return xs(r.apply(Jd(this),t))}}function _E(r){return typeof r=="function"?SE(r):(r instanceof IDBTransaction&&xE(r),yE(r,bE())?new Proxy(r,xf):r)}function xs(r){if(r instanceof IDBRequest)return wE(r);if(Zd.has(r))return Zd.get(r);const t=_E(r);return t!==r&&(Zd.set(r,t),Qf.set(t,r)),t}const Jd=r=>Qf.get(r);function EE(r,t,{blocked:e,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(r,t),u=xs(c);return i&&c.addEventListener("upgradeneeded",d=>{i(xs(c.result),d.oldVersion,d.newVersion,xs(c.transaction),d)}),e&&c.addEventListener("blocked",d=>e(d.oldVersion,d.newVersion,d)),u.then(d=>{l&&d.addEventListener("close",()=>l()),a&&d.addEventListener("versionchange",f=>a(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const TE=["get","getKey","getAll","getAllKeys","count"],CE=["put","add","delete","clear"],tf=new Map;function Jy(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(tf.get(t))return tf.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,a=CE.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(a||TE.includes(e)))return;const l=async function(c,...u){const d=this.transaction(c,a?"readwrite":"readonly");let f=d.store;return i&&(f=f.index(u.shift())),(await Promise.all([f[e](...u),a&&d.done]))[0]};return tf.set(t,l),l}AE(r=>({...r,get:(t,e,i)=>Jy(t,e)||r.get(t,e,i),has:(t,e)=>!!Jy(t,e)||r.has(t,e)}));class RE{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(DE(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function DE(r){return r.getComponent()?.type==="VERSION"}const Af="@firebase/app",tb="0.14.7";const Oi=new jv("@firebase/app"),NE="@firebase/app-compat",ME="@firebase/analytics-compat",kE="@firebase/analytics",LE="@firebase/app-check-compat",OE="@firebase/app-check",IE="@firebase/auth",PE="@firebase/auth-compat",jE="@firebase/database",BE="@firebase/data-connect",UE="@firebase/database-compat",FE="@firebase/functions",zE="@firebase/functions-compat",HE="@firebase/installations",VE="@firebase/installations-compat",GE="@firebase/messaging",qE="@firebase/messaging-compat",$E="@firebase/performance",YE="@firebase/performance-compat",XE="@firebase/remote-config",WE="@firebase/remote-config-compat",KE="@firebase/storage",QE="@firebase/storage-compat",ZE="@firebase/firestore",JE="@firebase/ai",t2="@firebase/firestore-compat",e2="firebase",n2="12.8.0";const Sf="[DEFAULT]",i2={[Af]:"fire-core",[NE]:"fire-core-compat",[kE]:"fire-analytics",[ME]:"fire-analytics-compat",[OE]:"fire-app-check",[LE]:"fire-app-check-compat",[IE]:"fire-auth",[PE]:"fire-auth-compat",[jE]:"fire-rtdb",[BE]:"fire-data-connect",[UE]:"fire-rtdb-compat",[FE]:"fire-fn",[zE]:"fire-fn-compat",[HE]:"fire-iid",[VE]:"fire-iid-compat",[GE]:"fire-fcm",[qE]:"fire-fcm-compat",[$E]:"fire-perf",[YE]:"fire-perf-compat",[XE]:"fire-rc",[WE]:"fire-rc-compat",[KE]:"fire-gcs",[QE]:"fire-gcs-compat",[ZE]:"fire-fst",[t2]:"fire-fst-compat",[JE]:"fire-vertex","fire-js":"fire-js",[e2]:"fire-js-all"};const Oo=new Map,s2=new Map,_f=new Map;function eb(r,t){try{r.container.addComponent(t)}catch(e){Oi.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,e)}}function cr(r){const t=r.name;if(_f.has(t))return Oi.debug(`There were multiple attempts to register component ${t}.`),!1;_f.set(t,r);for(const e of Oo.values())eb(e,r);for(const e of s2.values())eb(e,r);return!0}function Zf(r,t){const e=r.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),r.container.getProvider(t)}function tn(r){return r==null?!1:r.settings!==void 0}const a2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},As=new $o("app","Firebase",a2);class r2{constructor(t,e,i){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Js("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw As.create("app-deleted",{appName:this._name})}}const Xo=n2;function Fv(r,t={}){let e=r;typeof t!="object"&&(t={name:t});const i={name:Sf,automaticDataCollectionEnabled:!0,...t},a=i.name;if(typeof a!="string"||!a)throw As.create("bad-app-name",{appName:String(a)});if(e||(e=Lv()),!e)throw As.create("no-options");const l=Oo.get(a);if(l){if(lr(e,l.options)&&lr(i,l.config))return l;throw As.create("duplicate-app",{appName:a})}const c=new dE(a);for(const d of _f.values())c.addComponent(d);const u=new r2(e,i,c);return Oo.set(a,u),u}function Jf(r=Sf){const t=Oo.get(r);if(!t&&r===Sf&&Lv())return Fv();if(!t)throw As.create("no-app",{appName:r});return t}function o2(){return Array.from(Oo.values())}function Ss(r,t,e){let i=i2[r]??r;e&&(i+=`-${e}`);const a=i.match(/\s|\//),l=t.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${t}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Oi.warn(c.join(" "));return}cr(new Js(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const l2="firebase-heartbeat-database",c2=1,Io="firebase-heartbeat-store";let ef=null;function zv(){return ef||(ef=EE(l2,c2,{upgrade:(r,t)=>{switch(t){case 0:try{r.createObjectStore(Io)}catch(e){console.warn(e)}}}}).catch(r=>{throw As.create("idb-open",{originalErrorMessage:r.message})})),ef}async function u2(r){try{const e=(await zv()).transaction(Io),i=await e.objectStore(Io).get(Hv(r));return await e.done,i}catch(t){if(t instanceof Fi)Oi.warn(t.message);else{const e=As.create("idb-get",{originalErrorMessage:t?.message});Oi.warn(e.message)}}}async function nb(r,t){try{const i=(await zv()).transaction(Io,"readwrite");await i.objectStore(Io).put(t,Hv(r)),await i.done}catch(e){if(e instanceof Fi)Oi.warn(e.message);else{const i=As.create("idb-set",{originalErrorMessage:e?.message});Oi.warn(i.message)}}}function Hv(r){return`${r.name}!${r.options.appId}`}const h2=1024,d2=30;class f2{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new m2(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ib();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:e}),this._heartbeatsCache.heartbeats.length>d2){const a=g2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){Oi.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ib(),{heartbeatsToSend:e,unsentEntries:i}=p2(this._heartbeatsCache.heartbeats),a=Nv(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Oi.warn(t),""}}}function ib(){return new Date().toISOString().substring(0,10)}function p2(r,t=h2){const e=[];let i=r.slice();for(const a of r){const l=e.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),sb(e)>t){l.dates.pop();break}}else if(e.push({agent:a.agent,dates:[a.date]}),sb(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class m2{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return tE()?eE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await u2(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return nb(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return nb(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function sb(r){return Nv(JSON.stringify({version:2,heartbeats:r})).length}function g2(r){if(r.length===0)return-1;let t=0,e=r[0].date;for(let i=1;i<r.length;i++)r[i].date<e&&(e=r[i].date,t=i);return t}function y2(r){cr(new Js("platform-logger",t=>new RE(t),"PRIVATE")),cr(new Js("heartbeat",t=>new f2(t),"PRIVATE")),Ss(Af,tb,r),Ss(Af,tb,"esm2020"),Ss("fire-js","")}y2("");function Vv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const b2=Vv,Gv=new $o("auth","Firebase",Vv());const Wc=new jv("@firebase/auth");function v2(r,...t){Wc.logLevel<=Gt.WARN&&Wc.warn(`Auth (${Xo}): ${r}`,...t)}function zc(r,...t){Wc.logLevel<=Gt.ERROR&&Wc.error(`Auth (${Xo}): ${r}`,...t)}function kn(r,...t){throw ep(r,...t)}function Fn(r,...t){return ep(r,...t)}function tp(r,t,e){const i={...b2(),[t]:e};return new $o("auth","Firebase",i).create(t,{appName:r.name})}function ai(r){return tp(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qv(r,t,e){const i=e;if(!(t instanceof i))throw i.name!==t.constructor.name&&kn(r,"argument-error"),tp(r,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ep(r,...t){if(typeof r!="string"){const e=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=r.name),r._errorFactory.create(e,...i)}return Gv.create(r,...t)}function dt(r,t,...e){if(!r)throw ep(t,...e)}function Ni(r){const t="INTERNAL ASSERTION FAILED: "+r;throw zc(t),new Error(t)}function Ii(r,t){r||Ni(t)}function Ef(){return typeof self<"u"&&self.location?.href||""}function w2(){return ab()==="http:"||ab()==="https:"}function ab(){return typeof self<"u"&&self.location?.protocol||null}function x2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(w2()||Q_()||"connection"in navigator)?navigator.onLine:!0}function A2(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}class Wo{constructor(t,e){this.shortDelay=t,this.longDelay=e,Ii(e>t,"Short delay should be less than long delay!"),this.isMobile=W_()||Z_()}get(){return x2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function np(r,t){Ii(r.emulator,"Emulator should always be set here");const{url:e}=r.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class $v{static initialize(t,e,i){this.fetchImpl=t,e&&(this.headersImpl=e),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const S2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const _2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],E2=new Wo(3e4,6e4);function zi(r,t){return r.tenantId&&!t.tenantId?{...t,tenantId:r.tenantId}:t}async function Hi(r,t,e,i,a={}){return Yv(r,a,async()=>{let l={},c={};i&&(t==="GET"?c=i:l={body:JSON.stringify(i)});const u=Yo({key:r.config.apiKey,...c}).slice(1),d=await r._getAdditionalHeaders();d["Content-Type"]="application/json",r.languageCode&&(d["X-Firebase-Locale"]=r.languageCode);const f={method:t,headers:d,...l};return K_()||(f.referrerPolicy="no-referrer"),r.emulatorConfig&&gr(r.emulatorConfig.host)&&(f.credentials="include"),$v.fetch()(await Xv(r,r.config.apiHost,e,u),f)})}async function Yv(r,t,e){r._canInitEmulator=!1;const i={...S2,...t};try{const a=new C2(r),l=await Promise.race([e(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Cc(r,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const u=l.ok?c.errorMessage:c.error.message,[d,f]=u.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cc(r,"credential-already-in-use",c);if(d==="EMAIL_EXISTS")throw Cc(r,"email-already-in-use",c);if(d==="USER_DISABLED")throw Cc(r,"user-disabled",c);const m=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw tp(r,m,f);kn(r,m)}}catch(a){if(a instanceof Fi)throw a;kn(r,"network-request-failed",{message:String(a)})}}async function Ko(r,t,e,i,a={}){const l=await Hi(r,t,e,i,a);return"mfaPendingCredential"in l&&kn(r,"multi-factor-auth-required",{_serverResponse:l}),l}async function Xv(r,t,e,i){const a=`${t}${e}?${i}`,l=r,c=l.config.emulator?np(r.config,a):`${r.config.apiScheme}://${a}`;return _2.includes(e)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function T2(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class C2{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,i)=>{this.timer=setTimeout(()=>i(Fn(this.auth,"network-request-failed")),E2.get())})}}function Cc(r,t,e){const i={appName:r.name};e.email&&(i.email=e.email),e.phoneNumber&&(i.phoneNumber=e.phoneNumber);const a=Fn(r,t,i);return a.customData._tokenResponse=e,a}function rb(r){return r!==void 0&&r.enterprise!==void 0}class R2{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return T2(e.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function D2(r,t){return Hi(r,"GET","/v2/recaptchaConfig",zi(r,t))}async function N2(r,t){return Hi(r,"POST","/v1/accounts:delete",t)}async function Kc(r,t){return Hi(r,"POST","/v1/accounts:lookup",t)}function No(r){if(r)try{const t=new Date(Number(r));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function M2(r,t=!1){const e=en(r),i=await e.getIdToken(t),a=ip(i);dt(a&&a.exp&&a.auth_time&&a.iat,e.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:i,authTime:No(nf(a.auth_time)),issuedAtTime:No(nf(a.iat)),expirationTime:No(nf(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function nf(r){return Number(r)*1e3}function ip(r){const[t,e,i]=r.split(".");if(t===void 0||e===void 0||i===void 0)return zc("JWT malformed, contained fewer than 3 sections"),null;try{const a=Mv(e);return a?JSON.parse(a):(zc("Failed to decode base64 JWT payload"),null)}catch(a){return zc("Caught error parsing JWT payload as JSON",a?.toString()),null}}function ob(r){const t=ip(r);return dt(t,"internal-error"),dt(typeof t.exp<"u","internal-error"),dt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function Po(r,t,e=!1){if(e)return t;try{return await t}catch(i){throw i instanceof Fi&&k2(i)&&r.auth.currentUser===r&&await r.auth.signOut(),i}}function k2({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}class L2{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Tf{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=No(this.lastLoginAt),this.creationTime=No(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function jo(r){const t=r.auth,e=await r.getIdToken(),i=await Po(r,Kc(t,{idToken:e}));dt(i?.users.length,t,"internal-error");const a=i.users[0];r._notifyReloadListener(a);const l=a.providerUserInfo?.length?Wv(a.providerUserInfo):[],c=I2(r.providerData,l),u=r.isAnonymous,d=!(r.email&&a.passwordHash)&&!c?.length,f=u?d:!1,m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Tf(a.createdAt,a.lastLoginAt),isAnonymous:f};Object.assign(r,m)}async function O2(r){const t=en(r);await jo(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function I2(r,t){return[...r.filter(i=>!t.some(a=>a.providerId===i.providerId)),...t]}function Wv(r){return r.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function P2(r,t){const e=await Yv(r,{},async()=>{const i=Yo({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:a,apiKey:l}=r.config,c=await Xv(r,a,"/v1/token",`key=${l}`),u=await r._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:u,body:i};return r.emulatorConfig&&gr(r.emulatorConfig.host)&&(d.credentials="include"),$v.fetch()(c,d)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function j2(r,t){return Hi(r,"POST","/v2/accounts:revokeToken",zi(r,t))}class er{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){dt(t.idToken,"internal-error"),dt(typeof t.idToken<"u","internal-error"),dt(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):ob(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){dt(t.length!==0,"internal-error");const e=ob(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(dt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:i,refreshToken:a,expiresIn:l}=await P2(t,e);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(t,e,i){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,e){const{refreshToken:i,accessToken:a,expirationTime:l}=e,c=new er;return i&&(dt(typeof i=="string","internal-error",{appName:t}),c.refreshToken=i),a&&(dt(typeof a=="string","internal-error",{appName:t}),c.accessToken=a),l&&(dt(typeof l=="number","internal-error",{appName:t}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new er,this.toJSON())}_performRefresh(){return Ni("not implemented")}}function ms(r,t){dt(typeof r=="string"||typeof r>"u","internal-error",{appName:t})}class Bn{constructor({uid:t,auth:e,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new L2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Tf(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(t){const e=await Po(this,this.stsTokenManager.getToken(this.auth,t));return dt(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return M2(this,t)}reload(){return O2(this)}_assign(t){this!==t&&(dt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Bn({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),e&&await jo(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(tn(this.auth.app))return Promise.reject(ai(this.auth));const t=await this.getIdToken();return await Po(this,N2(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const i=e.displayName??void 0,a=e.email??void 0,l=e.phoneNumber??void 0,c=e.photoURL??void 0,u=e.tenantId??void 0,d=e._redirectEventId??void 0,f=e.createdAt??void 0,m=e.lastLoginAt??void 0,{uid:g,emailVerified:v,isAnonymous:w,providerData:_,stsTokenManager:x}=e;dt(g&&x,t,"internal-error");const S=er.fromJSON(this.name,x);dt(typeof g=="string",t,"internal-error"),ms(i,t.name),ms(a,t.name),dt(typeof v=="boolean",t,"internal-error"),dt(typeof w=="boolean",t,"internal-error"),ms(l,t.name),ms(c,t.name),ms(u,t.name),ms(d,t.name),ms(f,t.name),ms(m,t.name);const E=new Bn({uid:g,auth:t,email:a,emailVerified:v,displayName:i,isAnonymous:w,photoURL:c,phoneNumber:l,tenantId:u,stsTokenManager:S,createdAt:f,lastLoginAt:m});return _&&Array.isArray(_)&&(E.providerData=_.map(R=>({...R}))),d&&(E._redirectEventId=d),E}static async _fromIdTokenResponse(t,e,i=!1){const a=new er;a.updateFromServerResponse(e);const l=new Bn({uid:e.localId,auth:t,stsTokenManager:a,isAnonymous:i});return await jo(l),l}static async _fromGetAccountInfoResponse(t,e,i){const a=e.users[0];dt(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?Wv(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,u=new er;u.updateFromIdToken(i);const d=new Bn({uid:a.localId,auth:t,stsTokenManager:u,isAnonymous:c}),f={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Tf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(d,f),d}}const lb=new Map;function Mi(r){Ii(r instanceof Function,"Expected a class definition");let t=lb.get(r);return t?(Ii(t instanceof r,"Instance stored in cache mismatched with class"),t):(t=new r,lb.set(r,t),t)}class Kv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Kv.type="NONE";const cb=Kv;function Hc(r,t,e){return`firebase:${r}:${t}:${e}`}class nr{constructor(t,e,i){this.persistence=t,this.auth=e,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=Hc(this.userKey,a.apiKey,l),this.fullPersistenceKey=Hc("persistence",a.apiKey,l),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Kc(this.auth,{idToken:t}).catch(()=>{});return e?Bn._fromGetAccountInfoResponse(this.auth,e,t):null}return Bn._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,i="authUser"){if(!e.length)return new nr(Mi(cb),t,i);const a=(await Promise.all(e.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let l=a[0]||Mi(cb);const c=Hc(i,t.config.apiKey,t.name);let u=null;for(const f of e)try{const m=await f._get(c);if(m){let g;if(typeof m=="string"){const v=await Kc(t,{idToken:m}).catch(()=>{});if(!v)break;g=await Bn._fromGetAccountInfoResponse(t,v,m)}else g=Bn._fromJSON(t,m);f!==l&&(u=g),l=f;break}}catch{}const d=a.filter(f=>f._shouldAllowMigration);return!l._shouldAllowMigration||!d.length?new nr(l,t,i):(l=d[0],u&&await l._set(c,u.toJSON()),await Promise.all(e.map(async f=>{if(f!==l)try{await f._remove(c)}catch{}})),new nr(l,t,i))}}function ub(r){const t=r.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(t1(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Qv(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(n1(t))return"Blackberry";if(i1(t))return"Webos";if(Zv(t))return"Safari";if((t.includes("chrome/")||Jv(t))&&!t.includes("edge/"))return"Chrome";if(e1(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=r.match(e);if(i?.length===2)return i[1]}return"Other"}function Qv(r=He()){return/firefox\//i.test(r)}function Zv(r=He()){const t=r.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Jv(r=He()){return/crios\//i.test(r)}function t1(r=He()){return/iemobile/i.test(r)}function e1(r=He()){return/android/i.test(r)}function n1(r=He()){return/blackberry/i.test(r)}function i1(r=He()){return/webos/i.test(r)}function sp(r=He()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function B2(r=He()){return sp(r)&&!!window.navigator?.standalone}function U2(){return J_()&&document.documentMode===10}function s1(r=He()){return sp(r)||e1(r)||i1(r)||n1(r)||/windows phone/i.test(r)||t1(r)}function a1(r,t=[]){let e;switch(r){case"Browser":e=ub(He());break;case"Worker":e=`${ub(He())}-${r}`;break;default:e=r}const i=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Xo}/${i}`}class F2{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const i=l=>new Promise((c,u)=>{try{const d=t(l);c(d)}catch(d){u(d)}});i.onAbort=e,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const i of this.queue)await i(t),i.onAbort&&e.push(i.onAbort)}catch(i){e.reverse();for(const a of e)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function z2(r,t={}){return Hi(r,"GET","/v2/passwordPolicy",zi(r,t))}const H2=6;class V2{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??H2,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(e.meetsMinPasswordLength=t.length>=i),a&&(e.meetsMaxPasswordLength=t.length<=a)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let i;for(let a=0;a<t.length;a++)i=t.charAt(a),this.updatePasswordCharacterOptionsStatuses(e,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,e,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=l))}}class G2{constructor(t,e,i,a){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hb(this),this.idTokenSubscription=new hb(this),this.beforeStateQueue=new F2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Gv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Mi(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await nr.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Kc(this,{idToken:t}),i=await Bn._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(i)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(tn(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let i=e,a=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=i?._redirectEventId,u=await this.tryRedirectSignIn(t);(!l||l===c)&&u?.user&&(i=u.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return dt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await jo(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=A2()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(tn(this.app))return Promise.reject(ai(this));const e=t?en(t):null;return e&&dt(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&dt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return tn(this.app)?Promise.reject(ai(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return tn(this.app)?Promise.reject(ai(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Mi(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await z2(this),e=new V2(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new $o("auth","Firebase",t())}onAuthStateChanged(t,e,i){return this.registerStateListener(this.authStateSubscription,t,e,i)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,i){return this.registerStateListener(this.idTokenSubscription,t,e,i)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(i.tenantId=this.tenantId),await j2(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const i=await this.getOrInitRedirectPersistenceManager(e);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Mi(t)||this._popupRedirectResolver;dt(e,this,"argument-error"),this.redirectPersistenceManager=await nr.create(this,[Mi(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,i,a){if(this._deleted)return()=>{};const l=typeof e=="function"?e:e.next.bind(e);let c=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(dt(u,this,"internal-error"),u.then(()=>{c||l(this.currentUser)}),typeof e=="function"){const d=t.addObserver(e,i,a);return()=>{c=!0,d()}}else{const d=t.addObserver(e);return()=>{c=!0,d()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=a1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){if(tn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&v2(`Error while retrieving App Check token: ${t.error}`),t?.token}}function li(r){return en(r)}class hb{constructor(t){this.auth=t,this.observer=null,this.addObserver=rE(e=>this.observer=e)}get next(){return dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let fu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function q2(r){fu=r}function r1(r){return fu.loadJS(r)}function $2(){return fu.recaptchaEnterpriseScript}function Y2(){return fu.gapiScript}function X2(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class W2{constructor(){this.enterprise=new K2}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class K2{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const Q2="recaptcha-enterprise",o1="NO_RECAPTCHA";class Z2{constructor(t){this.type=Q2,this.auth=li(t)}async verify(t="verify",e=!1){async function i(l){if(!e){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,u)=>{D2(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const f=new R2(d);return l.tenantId==null?l._agentRecaptchaConfig=f:l._tenantRecaptchaConfigs[l.tenantId]=f,c(f.siteKey)}}).catch(d=>{u(d)})})}function a(l,c,u){const d=window.grecaptcha;rb(d)?d.enterprise.ready(()=>{d.enterprise.execute(l,{action:t}).then(f=>{c(f)}).catch(()=>{c(o1)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new W2().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(u=>{if(!e&&rb(window.grecaptcha))a(u,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let d=$2();d.length!==0&&(d+=u),r1(d).then(()=>{a(u,l,c)}).catch(f=>{c(f)})}}).catch(u=>{c(u)})})}}async function db(r,t,e,i=!1,a=!1){const l=new Z2(r);let c;if(a)c=o1;else try{c=await l.verify(e)}catch{c=await l.verify(e,!0)}const u={...t};if(e==="mfaSmsEnrollment"||e==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const d=u.phoneEnrollmentInfo.phoneNumber,f=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:f,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const d=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return i?Object.assign(u,{captchaResp:c}):Object.assign(u,{captchaResponse:c}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Qc(r,t,e,i,a){if(r._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await db(r,t,e,e==="getOobCode");return i(r,l)}else return i(r,t).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await db(r,t,e,e==="getOobCode");return i(r,c)}else return Promise.reject(l)})}function J2(r,t){const e=Zf(r,"auth");if(e.isInitialized()){const a=e.getImmediate(),l=e.getOptions();if(lr(l,t??{}))return a;kn(a,"already-initialized")}return e.initialize({options:t})}function tT(r,t){const e=t?.persistence||[],i=(Array.isArray(e)?e:[e]).map(Mi);t?.errorMap&&r._updateErrorMap(t.errorMap),r._initializeWithPersistence(i,t?.popupRedirectResolver)}function l1(r,t,e){const i=li(r);dt(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const a=!!e?.disableWarnings,l=c1(t),{host:c,port:u}=eT(t),d=u===null?"":`:${u}`,f={url:`${l}//${c}${d}/`},m=Object.freeze({host:c,port:u,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){dt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),dt(lr(f,i.config.emulator)&&lr(m,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=f,i.emulatorConfig=m,i.settings.appVerificationDisabledForTesting=!0,gr(c)?(Iv(`${l}//${c}${d}`),Pv("Auth",!0)):a||nT()}function c1(r){const t=r.indexOf(":");return t<0?"":r.substr(0,t+1)}function eT(r){const t=c1(r),e=/(\/\/)?([^?#/]+)/.exec(r.substr(t.length));if(!e)return{host:"",port:null};const i=e[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:fb(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:fb(c)}}}function fb(r){if(!r)return null;const t=Number(r);return isNaN(t)?null:t}function nT(){function r(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}class ap{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Ni("not implemented")}_getIdTokenResponse(t){return Ni("not implemented")}_linkToIdToken(t,e){return Ni("not implemented")}_getReauthenticationResolver(t){return Ni("not implemented")}}async function iT(r,t){return Hi(r,"POST","/v1/accounts:signUp",t)}async function sT(r,t){return Ko(r,"POST","/v1/accounts:signInWithPassword",zi(r,t))}async function aT(r,t){return Hi(r,"POST","/v1/accounts:sendOobCode",zi(r,t))}async function rT(r,t){return aT(r,t)}async function oT(r,t){return Ko(r,"POST","/v1/accounts:signInWithEmailLink",zi(r,t))}async function lT(r,t){return Ko(r,"POST","/v1/accounts:signInWithEmailLink",zi(r,t))}class Bo extends ap{constructor(t,e,i,a=null){super("password",i),this._email=t,this._password=e,this._tenantId=a}static _fromEmailAndPassword(t,e){return new Bo(t,e,"password")}static _fromEmailAndCode(t,e,i=null){return new Bo(t,e,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;if(e?.email&&e?.password){if(e.signInMethod==="password")return this._fromEmailAndPassword(e.email,e.password);if(e.signInMethod==="emailLink")return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const e={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qc(t,e,"signInWithPassword",sT);case"emailLink":return oT(t,{email:this._email,oobCode:this._password});default:kn(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":const i={idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qc(t,i,"signUpPassword",iT);case"emailLink":return lT(t,{idToken:e,email:this._email,oobCode:this._password});default:kn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function ir(r,t){return Ko(r,"POST","/v1/accounts:signInWithIdp",zi(r,t))}const cT="http://localhost";class Pi extends ap{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Pi(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):kn("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:a,...l}=e;if(!i||!a)return null;const c=new Pi(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(t){const e=this.buildRequest();return ir(t,e)}_linkToIdToken(t,e){const i=this.buildRequest();return i.idToken=e,ir(t,i)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,ir(t,e)}buildRequest(){const t={requestUri:cT,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Yo(e)}return t}}function uT(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function hT(r){const t=_o(Eo(r)).link,e=t?_o(Eo(t)).deep_link_id:null,i=_o(Eo(r)).deep_link_id;return(i?_o(Eo(i)).link:null)||i||e||t||r}class rp{constructor(t){const e=_o(Eo(t)),i=e.apiKey??null,a=e.oobCode??null,l=uT(e.mode??null);dt(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=e.continueUrl??null,this.languageCode=e.lang??null,this.tenantId=e.tenantId??null}static parseLink(t){const e=hT(t);try{return new rp(e)}catch{return null}}}class na{constructor(){this.providerId=na.PROVIDER_ID}static credential(t,e){return Bo._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const i=rp.parseLink(e);return dt(i,"argument-error"),Bo._fromEmailAndCode(t,i.code,i.tenantId)}}na.PROVIDER_ID="password";na.EMAIL_PASSWORD_SIGN_IN_METHOD="password";na.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class pu{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class yr extends pu{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class _s extends yr{static credentialFromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;return dt("providerId"in e&&"signInMethod"in e,"argument-error"),Pi._fromParams(e)}credential(t){return this._credential({...t,nonce:t.rawNonce})}_credential(t){return dt(t.idToken||t.accessToken,"argument-error"),Pi._fromParams({...t,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(t){return _s.oauthCredentialFromTaggedObject(t)}static credentialFromError(t){return _s.oauthCredentialFromTaggedObject(t.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:a,pendingToken:l,nonce:c,providerId:u}=t;if(!i&&!a&&!e&&!l||!u)return null;try{return new _s(u)._credential({idToken:e,accessToken:i,nonce:c,pendingToken:l})}catch{return null}}}class gs extends yr{constructor(){super("facebook.com")}static credential(t){return Pi._fromParams({providerId:gs.PROVIDER_ID,signInMethod:gs.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return gs.credentialFromTaggedObject(t)}static credentialFromError(t){return gs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return gs.credential(t.oauthAccessToken)}catch{return null}}}gs.FACEBOOK_SIGN_IN_METHOD="facebook.com";gs.PROVIDER_ID="facebook.com";class si extends yr{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Pi._fromParams({providerId:si.PROVIDER_ID,signInMethod:si.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return si.credentialFromTaggedObject(t)}static credentialFromError(t){return si.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:i}=t;if(!e&&!i)return null;try{return si.credential(e,i)}catch{return null}}}si.GOOGLE_SIGN_IN_METHOD="google.com";si.PROVIDER_ID="google.com";class ys extends yr{constructor(){super("github.com")}static credential(t){return Pi._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ys.credentialFromTaggedObject(t)}static credentialFromError(t){return ys.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ys.credential(t.oauthAccessToken)}catch{return null}}}ys.GITHUB_SIGN_IN_METHOD="github.com";ys.PROVIDER_ID="github.com";class bs extends yr{constructor(){super("twitter.com")}static credential(t,e){return Pi._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return bs.credentialFromTaggedObject(t)}static credentialFromError(t){return bs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:i}=t;if(!e||!i)return null;try{return bs.credential(e,i)}catch{return null}}}bs.TWITTER_SIGN_IN_METHOD="twitter.com";bs.PROVIDER_ID="twitter.com";async function u1(r,t){return Ko(r,"POST","/v1/accounts:signUp",zi(r,t))}class ji{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,i,a=!1){const l=await Bn._fromIdTokenResponse(t,i,a),c=pb(i);return new ji({user:l,providerId:c,_tokenResponse:i,operationType:e})}static async _forOperation(t,e,i){await t._updateTokensIfNecessary(i,!0);const a=pb(i);return new ji({user:t,providerId:a,_tokenResponse:i,operationType:e})}}function pb(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}async function dT(r){if(tn(r.app))return Promise.reject(ai(r));const t=li(r);if(await t._initializationPromise,t.currentUser?.isAnonymous)return new ji({user:t.currentUser,providerId:null,operationType:"signIn"});const e=await u1(t,{returnSecureToken:!0}),i=await ji._fromIdTokenResponse(t,"signIn",e,!0);return await t._updateCurrentUser(i.user),i}class Zc extends Fi{constructor(t,e,i,a){super(e.code,e.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Zc.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,e,i,a){return new Zc(t,e,i,a)}}function h1(r,t,e,i){return(t==="reauthenticate"?e._getReauthenticationResolver(r):e._getIdTokenResponse(r)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Zc._fromErrorAndOperation(r,l,t,i):l})}function fT(r){return new Set(r.map(({providerId:t})=>t).filter(t=>!!t))}async function d1(r,t,e=!1){const i=await Po(r,t._linkToIdToken(r.auth,await r.getIdToken()),e);return ji._forOperation(r,"link",i)}async function pT(r,t,e){await jo(t);const i=fT(t.providerData);dt(i.has(e)===r,t.auth,"provider-already-linked")}async function mT(r,t,e=!1){const{auth:i}=r;if(tn(i.app))return Promise.reject(ai(i));const a="reauthenticate";try{const l=await Po(r,h1(i,a,t,r),e);dt(l.idToken,i,"internal-error");const c=ip(l.idToken);dt(c,i,"internal-error");const{sub:u}=c;return dt(r.uid===u,i,"user-mismatch"),ji._forOperation(r,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&kn(i,"user-mismatch"),l}}async function f1(r,t,e=!1){if(tn(r.app))return Promise.reject(ai(r));const i="signIn",a=await h1(r,i,t),l=await ji._fromIdTokenResponse(r,i,a);return e||await r._updateCurrentUser(l.user),l}async function gT(r,t){return f1(li(r),t)}async function yT(r,t){const e=en(r);return await pT(!1,e,t.providerId),d1(e,t)}async function p1(r){const t=li(r);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function bT(r,t,e){const i=li(r);await Qc(i,{requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"},"getOobCode",rT)}async function vT(r,t,e){if(tn(r.app))return Promise.reject(ai(r));const i=li(r),c=await Qc(i,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",u1).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&p1(r),d}),u=await ji._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(u.user),u}function wT(r,t,e){return tn(r.app)?Promise.reject(ai(r)):gT(en(r),na.credential(t,e)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&p1(r),i})}function xT(r,t,e,i){return en(r).onIdTokenChanged(t,e,i)}function AT(r,t,e){return en(r).beforeAuthStateChanged(t,e)}function ST(r,t,e,i){return en(r).onAuthStateChanged(t,e,i)}function op(r){return en(r).signOut()}const Jc="__sak";class m1{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Jc,"1"),this.storage.removeItem(Jc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const _T=1e3,ET=10;class g1 extends m1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=s1(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const i=this.storage.getItem(e),a=this.localCache[e];i!==a&&t(e,a,i)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((c,u,d)=>{this.notifyListeners(c,d)});return}const i=t.key;e?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!e&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);U2()&&l!==t.newValue&&t.newValue!==t.oldValue?setTimeout(a,ET):a()}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const a of Array.from(i))a(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:i}),!0)})},_T)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}g1.type="LOCAL";const TT=g1;class y1 extends m1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}y1.type="SESSION";const b1=y1;function CT(r){return Promise.all(r.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class mu{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(a=>a.isListeningto(t));if(e)return e;const i=new mu(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:i,eventType:a,data:l}=e.data,c=this.handlersMap[a];if(!c?.size)return;e.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const u=Array.from(c).map(async f=>f(e.origin,l)),d=await CT(u);e.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:d})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}mu.receivers=[];function lp(r="",t=10){let e="";for(let i=0;i<t;i++)e+=Math.floor(Math.random()*10);return r+e}class RT{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((u,d)=>{const f=lp("",20);a.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(g){const v=g;if(v.data.eventId===f)switch(v.data.status){case"ack":clearTimeout(m),l=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),u(v.data.response);break;default:clearTimeout(m),clearTimeout(l),d(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:t,eventId:f,data:e},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function ri(){return window}function DT(r){ri().location.href=r}function v1(){return typeof ri().WorkerGlobalScope<"u"&&typeof ri().importScripts=="function"}async function NT(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function MT(){return navigator?.serviceWorker?.controller||null}function kT(){return v1()?self:null}const w1="firebaseLocalStorageDb",LT=1,tu="firebaseLocalStorage",x1="fbase_key";class Qo{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function gu(r,t){return r.transaction([tu],t?"readwrite":"readonly").objectStore(tu)}function OT(){const r=indexedDB.deleteDatabase(w1);return new Qo(r).toPromise()}function Cf(){const r=indexedDB.open(w1,LT);return new Promise((t,e)=>{r.addEventListener("error",()=>{e(r.error)}),r.addEventListener("upgradeneeded",()=>{const i=r.result;try{i.createObjectStore(tu,{keyPath:x1})}catch(a){e(a)}}),r.addEventListener("success",async()=>{const i=r.result;i.objectStoreNames.contains(tu)?t(i):(i.close(),await OT(),t(await Cf()))})})}async function mb(r,t,e){const i=gu(r,!0).put({[x1]:t,value:e});return new Qo(i).toPromise()}async function IT(r,t){const e=gu(r,!1).get(t),i=await new Qo(e).toPromise();return i===void 0?null:i.value}function gb(r,t){const e=gu(r,!0).delete(t);return new Qo(e).toPromise()}const PT=800,jT=3;class A1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Cf(),this.db)}async _withRetries(t){let e=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(e++>jT)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return v1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=mu._getInstance(kT()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await NT(),!this.activeServiceWorker)return;this.sender=new RT(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||MT()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Cf();return await mb(t,Jc,"1"),await gb(t,Jc),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(i=>mb(i,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(i=>IT(i,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>gb(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(a=>{const l=gu(a,!1).getAll();return new Qo(l).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],i=new Set;if(t.length!==0)for(const{fbase_key:a,value:l}of t)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),e.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),e.push(a));return e}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const a of Array.from(i))a(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}A1.type="LOCAL";const BT=A1;new Wo(3e4,6e4);function cp(r,t){return t?Mi(t):(dt(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}class up extends ap{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ir(t,this._buildIdpRequest())}_linkToIdToken(t,e){return ir(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return ir(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function UT(r){return f1(r.auth,new up(r),r.bypassAuthState)}function FT(r){const{auth:t,user:e}=r;return dt(e,t,"internal-error"),mT(e,new up(r),r.bypassAuthState)}async function zT(r){const{auth:t,user:e}=r;return dt(e,t,"internal-error"),d1(e,new up(r),r.bypassAuthState)}class S1{constructor(t,e,i,a,l=!1){this.auth=t,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:i,postBody:a,tenantId:l,error:c,type:u}=t;if(c){this.reject(c);return}const d={auth:this.auth,requestUri:e,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(d))}catch(f){this.reject(f)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return UT;case"linkViaPopup":case"linkViaRedirect":return zT;case"reauthViaPopup":case"reauthViaRedirect":return FT;default:kn(this.auth,"internal-error")}}resolve(t){Ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const HT=new Wo(2e3,1e4);async function sf(r,t,e){if(tn(r.app))return Promise.reject(Fn(r,"operation-not-supported-in-this-environment"));const i=li(r);qv(r,t,pu);const a=cp(i,e);return new ws(i,"signInViaPopup",t,a).executeNotNull()}async function VT(r,t,e){const i=en(r);qv(i.auth,t,pu);const a=cp(i.auth,e);return new ws(i.auth,"linkViaPopup",t,a,i).executeNotNull()}class ws extends S1{constructor(t,e,i,a,l){super(t,e,a,l),this.provider=i,this.authWindow=null,this.pollId=null,ws.currentPopupAction&&ws.currentPopupAction.cancel(),ws.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return dt(t,this.auth,"internal-error"),t}async onExecution(){Ii(this.filter.length===1,"Popup operations only handle one event");const t=lp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Fn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Fn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ws.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,HT.get())};t()}}ws.currentPopupAction=null;const GT="pendingRedirect",Vc=new Map;class qT extends S1{constructor(t,e,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,i),this.eventId=null}async execute(){let t=Vc.get(this.auth._key());if(!t){try{const i=await $T(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(e){t=()=>Promise.reject(e)}Vc.set(this.auth._key(),t)}return this.bypassAuthState||Vc.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function $T(r,t){const e=WT(t),i=XT(r);if(!await i._isAvailable())return!1;const a=await i._get(e)==="true";return await i._remove(e),a}function YT(r,t){Vc.set(r._key(),t)}function XT(r){return Mi(r._redirectPersistence)}function WT(r){return Hc(GT,r.config.apiKey,r.name)}async function KT(r,t,e=!1){if(tn(r.app))return Promise.reject(ai(r));const i=li(r),a=cp(i,t),c=await new qT(i,a,e).execute();return c&&!e&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,t)),c}const QT=600*1e3;class ZT{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(e=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!JT(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!_1(t)){const i=t.error.code?.split("auth/")[1]||"internal-error";e.onError(Fn(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const i=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=QT&&this.cachedEventUids.clear(),this.cachedEventUids.has(yb(t))}saveEventToCache(t){this.cachedEventUids.add(yb(t)),this.lastProcessedEventTime=Date.now()}}function yb(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(t=>t).join("-")}function _1({type:r,error:t}){return r==="unknown"&&t?.code==="auth/no-auth-event"}function JT(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _1(r);default:return!1}}async function tC(r,t={}){return Hi(r,"GET","/v1/projects",t)}const eC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nC=/^https?/;async function iC(r){if(r.config.emulator)return;const{authorizedDomains:t}=await tC(r);for(const e of t)try{if(sC(e))return}catch{}kn(r,"unauthorized-domain")}function sC(r){const t=Ef(),{protocol:e,hostname:i}=new URL(t);if(r.startsWith("chrome-extension://")){const c=new URL(r);return c.hostname===""&&i===""?e==="chrome-extension:"&&r.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&c.hostname===i}if(!nC.test(e))return!1;if(eC.test(r))return i===r;const a=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const aC=new Wo(3e4,6e4);function bb(){const r=ri().___jsl;if(r?.H){for(const t of Object.keys(r.H))if(r.H[t].r=r.H[t].r||[],r.H[t].L=r.H[t].L||[],r.H[t].r=[...r.H[t].L],r.CP)for(let e=0;e<r.CP.length;e++)r.CP[e]=null}}function rC(r){return new Promise((t,e)=>{function i(){bb(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{bb(),e(Fn(r,"network-request-failed"))},timeout:aC.get()})}if(ri().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(ri().gapi?.load)i();else{const a=X2("iframefcb");return ri()[a]=()=>{gapi.load?i():e(Fn(r,"network-request-failed"))},r1(`${Y2()}?onload=${a}`).catch(l=>e(l))}}).catch(t=>{throw Gc=null,t})}let Gc=null;function oC(r){return Gc=Gc||rC(r),Gc}const lC=new Wo(5e3,15e3),cC="__/auth/iframe",uC="emulator/auth/iframe",hC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fC(r){const t=r.config;dt(t.authDomain,r,"auth-domain-config-required");const e=t.emulator?np(t,uC):`https://${r.config.authDomain}/${cC}`,i={apiKey:t.apiKey,appName:r.name,v:Xo},a=dC.get(r.config.apiHost);a&&(i.eid=a);const l=r._getFrameworks();return l.length&&(i.fw=l.join(",")),`${e}?${Yo(i).slice(1)}`}async function pC(r){const t=await oC(r),e=ri().gapi;return dt(e,r,"internal-error"),t.open({where:document.body,url:fC(r),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hC,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=Fn(r,"network-request-failed"),u=ri().setTimeout(()=>{l(c)},lC.get());function d(){ri().clearTimeout(u),a(i)}i.ping(d).then(d,()=>{l(c)})}))}const mC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},gC=500,yC=600,bC="_blank",vC="http://localhost";class vb{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wC(r,t,e,i=gC,a=yC){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let u="";const d={...mC,width:i.toString(),height:a.toString(),top:l,left:c},f=He().toLowerCase();e&&(u=Jv(f)?bC:e),Qv(f)&&(t=t||vC,d.scrollbars="yes");const m=Object.entries(d).reduce((v,[w,_])=>`${v}${w}=${_},`,"");if(B2(f)&&u!=="_self")return xC(t||"",u),new vb(null);const g=window.open(t||"",u,m);dt(g,r,"popup-blocked");try{g.focus()}catch{}return new vb(g)}function xC(r,t){const e=document.createElement("a");e.href=r,e.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(i)}const AC="__/auth/handler",SC="emulator/auth/handler",_C=encodeURIComponent("fac");async function wb(r,t,e,i,a,l){dt(r.config.authDomain,r,"auth-domain-config-required"),dt(r.config.apiKey,r,"invalid-api-key");const c={apiKey:r.config.apiKey,appName:r.name,authType:e,redirectUrl:i,v:Xo,eventId:a};if(t instanceof pu){t.setDefaultLanguage(r.languageCode),c.providerId=t.providerId||"",aE(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[m,g]of Object.entries({}))c[m]=g}if(t instanceof yr){const m=t.getScopes().filter(g=>g!=="");m.length>0&&(c.scopes=m.join(","))}r.tenantId&&(c.tid=r.tenantId);const u=c;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const d=await r._getAppCheckToken(),f=d?`#${_C}=${encodeURIComponent(d)}`:"";return`${EC(r)}?${Yo(u).slice(1)}${f}`}function EC({config:r}){return r.emulator?np(r,SC):`https://${r.authDomain}/${AC}`}const af="webStorageSupport";class TC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=b1,this._completeRedirectFn=KT,this._overrideRedirectResult=YT}async _openPopup(t,e,i,a){Ii(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const l=await wb(t,e,i,Ef(),a);return wC(t,l,lp())}async _openRedirect(t,e,i,a){await this._originValidation(t);const l=await wb(t,e,i,Ef(),a);return DT(l),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:a,promise:l}=this.eventManagers[e];return a?Promise.resolve(a):(Ii(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(t);return this.eventManagers[e]={promise:i},i.catch(()=>{delete this.eventManagers[e]}),i}async initAndGetManager(t){const e=await pC(t),i=new ZT(t);return e.register("authEvent",a=>(dt(a?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=e,i}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(af,{type:af},a=>{const l=a?.[0]?.[af];l!==void 0&&e(!!l),kn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=iC(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return s1()||Zv()||sp()}}const CC=TC;var xb="@firebase/auth",Ab="1.12.0";class RC{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(i=>{t(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function DC(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function NC(r){cr(new Js("auth",(t,{options:e})=>{const i=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),l=t.getProvider("app-check-internal"),{apiKey:c,authDomain:u}=i.options;dt(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:c,authDomain:u,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:a1(r)},f=new G2(i,a,l,d);return tT(f,e),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,i)=>{t.getProvider("auth-internal").initialize()})),cr(new Js("auth-internal",t=>{const e=li(t.getProvider("auth").getImmediate());return(i=>new RC(i))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ss(xb,Ab,DC(r)),Ss(xb,Ab,"esm2020")}const MC=300,kC=Ov("authIdTokenMaxAge")||MC;let Sb=null;const LC=r=>async t=>{const e=t&&await t.getIdTokenResult(),i=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(i&&i>kC)return;const a=e?.token;Sb!==a&&(Sb=a,await fetch(r,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function OC(r=Jf()){const t=Zf(r,"auth");if(t.isInitialized())return t.getImmediate();const e=J2(r,{popupRedirectResolver:CC,persistence:[BT,TT,b1]}),i=Ov("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=LC(l.toString());AT(e,c,()=>c(e.currentUser)),xT(e,u=>c(u))}}const a=kv("auth");return a&&l1(e,`http://${a}`),e}function IC(){return document.getElementsByTagName("head")?.[0]??document}q2({loadJS(r){return new Promise((t,e)=>{const i=document.createElement("script");i.setAttribute("src",r),i.onload=t,i.onerror=a=>{const l=Fn("internal-error");l.customData=a,e(l)},i.type="text/javascript",i.charset="UTF-8",IC().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});NC("Browser");var PC="firebase",jC="12.8.0";Ss(PC,jC,"app");const E1=I.createContext();let Rc={apiKey:"AIzaSyDqow-DLrBOZGUbGCN2nxpMCqXcbqDQe5Q",authDomain:"snapsign-au.firebaseapp.com",projectId:"snapsign-au",storageBucket:"snapsign-au.firebasestorage.app",messagingSenderId:"388378898686",appId:"1:388378898686:web:ec9931e426c1e7e768b5af",measurementId:"G-R41Q720M9W"};const _b=r=>{if(!r||typeof r!="string")return!0;const t=r.trim();return t===""||t.includes("your_")||t.includes("replace_me")||t.includes("changeme")};let Rf=null,be=null,Eb=!1;try{if(window.MOCK_AUTH)_b(Rc.apiKey)&&(console.log("Using dummy Firebase config for MOCK_AUTH mode"),Rc={apiKey:"AIzaSyDummyKeyForMockStats",authDomain:"mock-project.firebaseapp.com",projectId:"mock-project",storageBucket:"mock-project.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abcdef"});else if(_b(Rc.apiKey))throw new Error("Firebase client configuration is missing or invalid. Authentication will be unavailable.");Rf=o2().length===0?Fv(Rc):Jf(),be=OC(Rf),"".toLowerCase()==="true"&&!Eb&&(l1(be,"http://localhost:9099",{disableWarnings:!0}),Eb=!0)}catch(r){console.error("Failed to initialize Firebase:",r)}const BC=({children:r})=>{const[t,e]=I.useState({status:"pending",user:null,error:null});I.useEffect(()=>{if(window.MOCK_AUTH){const g=window.MOCK_AUTH_USER===void 0?{uid:"test-user",isAnonymous:!0}:window.MOCK_AUTH_USER;e({status:g?"authenticated":"unauthenticated",user:g,error:null});return}if(!be){e({status:"error",user:null,error:new Error("Firebase Auth not available")}),console.error("Firebase Auth not available");return}const m=ST(be,async g=>{if(!g){try{const v=await dT(be);e({status:"authenticated",user:v.user,error:null})}catch(v){console.error("Authentication error:",v),e({status:"error",user:null,error:v})}return}e({status:"authenticated",user:g,error:null})},g=>{console.error("Authentication observer error:",g),e({status:"error",user:null,error:g})});return()=>m()},[]);const i=async()=>{if(!be)throw new Error("Auth is not available");return sf(be,new si)},a=async()=>{if(!be)throw new Error("Auth is not available");return sf(be,new _s("microsoft.com"))},l=async()=>{if(!be)throw new Error("Auth is not available");return sf(be,new _s("apple.com"))},c=async(m,g)=>{if(!be)throw new Error("Auth is not available");return wT(be,m,g)},u=async(m,g)=>{if(!be)throw new Error("Auth is not available");return vT(be,m,g)},d=async m=>{if(!be)throw new Error("Auth is not available");return bT(be,m)},f=async()=>{be&&await op(be)};return b.jsx(E1.Provider,{value:{authState:t,app:Rf,auth:be,signInWithGoogle:i,signInWithMicrosoft:a,signInWithApple:l,signInWithEmail:c,signUpWithEmail:u,resetPassword:d,signOutUser:f},children:r})},Cs=()=>{const r=I.useContext(E1);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r};function UC(){const{authState:r,auth:t}=Cs();return I.useRef(!1),I.useEffect(()=>{},[r?.status,r?.user?.isAnonymous,t]),null}const FC=({onOpenPdf:r,children:t})=>b.jsxs("div",{className:"min-h-screen bg-[#f7f6f2] text-slate-900 font-sans",children:[b.jsx(UC,{}),b.jsxs("div",{className:"relative overflow-hidden",children:[b.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[b.jsx("div",{className:"absolute -top-32 -right-20 h-72 w-72 rounded-full bg-[#d8e6ff] blur-3xl opacity-60 animate-float-slow"}),b.jsx("div",{className:"absolute top-40 -left-24 h-72 w-72 rounded-full bg-[#fde4c7] blur-3xl opacity-50 animate-float-slow"})]}),b.jsx("header",{className:"sticky top-0 z-30 w-full border-b border-white/40 bg-white/70 backdrop-blur-xl",children:b.jsxs("div",{className:"mx-auto flex w-full max-w-6xl items-center justify-between px-6 py-4",children:[b.jsxs(Xt,{to:"/",className:"flex items-center gap-3 text-lg font-bold tracking-tight",children:[b.jsx("img",{src:Wf,alt:"DecoDocs",className:"h-9 w-9"}),"DecoDocs"]}),b.jsxs("nav",{className:"hidden items-center gap-8 text-sm font-semibold text-slate-600 md:flex",children:[b.jsx("a",{className:"hover:text-slate-900 transition-colors",href:"#how-it-works",children:"How it works"}),b.jsx("a",{className:"hover:text-slate-900 transition-colors",href:"#features",children:"Features"}),b.jsx("a",{className:"hover:text-slate-900 transition-colors",href:"#use-cases",children:"Use cases"})]}),b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsx(Xc,{variant:"outline",size:"sm",to:"/view",className:"hidden md:inline-flex bg-white/50",children:"Launch app"}),b.jsx(Xc,{variant:"primary",size:"sm",onClick:r,children:"Open PDF"})]})]})}),b.jsx("main",{className:"relative z-10",children:t}),b.jsx(Cv,{})]})]}),zC=({onOpenPdf:r})=>b.jsx("section",{id:"hero",className:"px-6 pt-24 pb-20 lg:pt-32 lg:pb-24",children:b.jsxs("div",{className:"mx-auto grid w-full max-w-6xl items-center gap-16 lg:grid-cols-[1.1fr_0.9fr]",children:[b.jsxs("div",{className:"flex flex-col gap-8",children:[b.jsx("span",{className:"w-fit rounded-full border border-slate-200 bg-white px-4 py-1.5 text-xs font-bold uppercase tracking-wider text-slate-600 shadow-sm",children:"Modern document intelligence"}),b.jsxs("h1",{className:"text-5xl font-bold tracking-tight text-slate-900 md:text-6xl leading-[1.1]",children:["Decode documents ",b.jsx("br",{className:"hidden lg:block"}),b.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-slate-900 to-slate-600",children:"before you sign."})]}),b.jsx("p",{className:"text-xl text-slate-600 leading-relaxed max-w-xl",children:"DecoDocs turns dense PDFs into clear decisions with AI summaries, risk flags, and evidence-backed explanations."}),b.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[b.jsx(Xc,{variant:"primary",size:"lg",onClick:r,className:"w-full sm:w-auto",children:"Analyze a Document"}),b.jsx(Xc,{variant:"secondary",size:"lg",to:"/view",className:"w-full sm:w-auto",children:"View Demo"})]}),b.jsxs("div",{className:"flex flex-wrap gap-6 text-sm font-medium text-slate-500 mt-2",children:[b.jsxs("span",{className:"flex items-center gap-2.5",children:[b.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.4)]"}),"Free mode never stores files"]}),b.jsxs("span",{className:"flex items-center gap-2.5",children:[b.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-slate-900"}),"Pro includes vaults & history"]})]})]}),b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute -top-12 -right-12 h-64 w-64 rounded-full bg-purple-100 blur-3xl opacity-60 animate-float-slow"}),b.jsx("div",{className:"absolute -bottom-12 -left-12 h-64 w-64 rounded-full bg-amber-100 blur-3xl opacity-60 animate-float-slow",style:{animationDelay:"2s"}}),b.jsxs("div",{className:"relative rounded-3xl border border-white/60 bg-white/80 backdrop-blur-xl p-8 shadow-2xl shadow-slate-900/10 ring-1 ring-slate-900/5 transition-transform hover:scale-[1.01] duration-500",children:[b.jsxs("div",{className:"flex items-center justify-between text-xs font-bold text-slate-400 uppercase tracking-wider mb-6",children:[b.jsx("span",{children:"Contract Review"}),b.jsx("span",{children:"12 pages"})]}),b.jsxs("div",{className:"space-y-5",children:[b.jsxs("div",{className:"rounded-2xl bg-amber-50 p-5 border border-amber-100/50",children:[b.jsxs("div",{className:"flex gap-3 mb-2",children:[b.jsx("div",{className:"w-5 h-5 rounded-full bg-amber-100 flex items-center justify-center text-amber-600 font-bold text-xs",children:"!"}),b.jsx("span",{className:"text-xs font-bold text-amber-700 uppercase tracking-wide pt-0.5",children:"Risk Flagged"})]}),b.jsx("p",{className:"text-base text-slate-800 leading-snug font-medium",children:"Termination clause requires 90-day notice and carries a 3x fee."})]}),b.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-5 shadow-sm",children:[b.jsxs("div",{className:"flex gap-3 mb-2",children:[b.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-50 flex items-center justify-center text-blue-600 font-bold text-xs",children:"i"}),b.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide pt-0.5",children:"Plain English"})]}),b.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:"You must give three months notice or pay a penalty equal to three months of fees."})]}),b.jsxs("div",{className:"rounded-2xl bg-slate-900 p-5 text-white shadow-lg shadow-slate-900/10",children:[b.jsxs("div",{className:"flex gap-3 mb-2",children:[b.jsx("div",{className:"w-5 h-5 rounded-full bg-slate-700 flex items-center justify-center text-white font-bold text-xs",children:""}),b.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide pt-0.5",children:"Recommendation"})]}),b.jsx("p",{className:"text-sm font-medium leading-relaxed",children:"Renegotiate the termination period to 30 days or cap the penalty at 1x fee."})]})]}),b.jsxs("div",{className:"mt-8 flex items-center justify-between rounded-2xl bg-slate-50 border border-slate-100 px-5 py-4 text-xs",children:[b.jsxs("span",{className:"flex items-center gap-2 text-slate-500",children:[b.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"}),"AI decode complete"]}),b.jsx("span",{className:"font-bold text-slate-900 bg-white px-3 py-1 rounded-full border border-slate-200 shadow-sm",children:"Ready to review"})]})]})]})]})}),br=({eyebrow:r,title:t,description:e,align:i="center"})=>{const a=i==="left"?"items-start text-left":"items-center text-center";return b.jsxs("div",{className:`flex flex-col gap-3 ${a}`,children:[r?b.jsx("span",{className:"text-xs uppercase tracking-[0.3em] text-slate-500",children:r}):null,b.jsx("h2",{className:"text-3xl md:text-4xl font-semibold text-slate-900",children:t}),e?b.jsx("p",{className:"text-base md:text-lg text-slate-600 max-w-2xl",children:e}):null]})},HC=()=>b.jsx("section",{className:"px-6 py-16",children:b.jsxs("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-10",children:[b.jsx(br,{eyebrow:"Trusted teams",title:"Teams use DecoDocs to review faster",description:"From startups to procurement teams, we help busy leaders move faster without missing critical terms."}),b.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:k_.map(r=>b.jsxs("div",{className:"rounded-3xl border border-white/60 bg-white/80 p-6 shadow-lg shadow-slate-900/5",children:[b.jsx("p",{className:"text-2xl font-semibold text-slate-900",children:r.value}),b.jsx("p",{className:"mt-2 text-sm text-slate-500",children:r.label})]},r.label))}),b.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4 rounded-3xl border border-white/50 bg-white/70 px-6 py-5 text-xs uppercase tracking-[0.2em] text-slate-400",children:M_.map(r=>b.jsx("span",{children:r},r))})]})}),VC=()=>b.jsx("section",{id:"how-it-works",className:"px-6 py-16",children:b.jsxs("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-10",children:[b.jsx(br,{eyebrow:"How it works",title:"Three steps to clarity",description:"No onboarding, no templates. Drop in a document and get structured insights within seconds.",align:"left"}),b.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:L_.map((r,t)=>b.jsxs("div",{className:"rounded-3xl border border-slate-100 bg-white p-6 shadow-lg shadow-slate-900/5",children:[b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("span",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:["Step ",t+1]}),b.jsx("span",{className:"text-xl",children:String(t+1).padStart(2,"0")})]}),b.jsx("h3",{className:"mt-6 text-xl font-semibold text-slate-900",children:r.title}),b.jsx("p",{className:"mt-3 text-sm text-slate-600",children:r.description})]},r.title))})]})}),GC=()=>b.jsx("section",{id:"features",className:"px-6 py-16",children:b.jsxs("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-10",children:[b.jsx(br,{eyebrow:"Product",title:"Every insight you need to move faster",description:"Built for modern teams that need clarity, speed, and secure workflows."}),b.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:O_.map(r=>b.jsxs("div",{className:"group rounded-3xl border border-slate-100 bg-white p-6 shadow-lg shadow-slate-900/5 transition hover:-translate-y-1",children:[b.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-900 text-white",children:b.jsx("span",{className:"text-xs font-semibold",children:"AI"})}),b.jsx("h3",{className:"mt-5 text-lg font-semibold text-slate-900",children:r.title}),b.jsx("p",{className:"mt-3 text-sm text-slate-600",children:r.description})]},r.title))})]})}),qC=()=>b.jsx("section",{id:"use-cases",className:"px-6 py-24 bg-slate-50",children:b.jsxs("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-12",children:[b.jsx(br,{eyebrow:"Use cases",title:"Built for high-stakes decisions",description:"DecoDocs supports every team that needs clean answers before signing or committing.",align:"left"}),b.jsx("div",{className:"grid gap-8 md:grid-cols-2 lg:grid-cols-3",children:I_.map((r,t)=>b.jsxs("div",{className:"group relative flex flex-col rounded-3xl border border-slate-200 bg-white p-8 shadow-sm hover:shadow-xl hover:border-slate-300 transition-all duration-300",children:[b.jsxs("div",{className:"flex items-center justify-between text-xs font-bold uppercase tracking-wider text-slate-400 mb-6 group-hover:text-slate-600 transition-colors",children:[b.jsx("span",{children:"Use case"}),b.jsx("span",{children:String(t+1).padStart(2,"0")})]}),b.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-4 group-hover:text-amber-600 transition-colors",children:r.title}),b.jsx("p",{className:"text-base text-slate-600 leading-relaxed",children:r.description}),b.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-100 flex items-center text-sm font-bold text-slate-900 opacity-60 group-hover:opacity-100 transition-opacity",children:[b.jsx("span",{children:"Learn more"}),b.jsx("svg",{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]},r.title))})]})});var T1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Tb=Un.createContext&&Un.createContext(T1),$C=["attr","size","title"];function YC(r,t){if(r==null)return{};var e=XC(r,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(e[i]=r[i])}return e}function XC(r,t){if(r==null)return{};var e={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(t.indexOf(i)>=0)continue;e[i]=r[i]}return e}function eu(){return eu=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},eu.apply(this,arguments)}function Cb(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),e.push.apply(e,i)}return e}function nu(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Cb(Object(e),!0).forEach(function(i){WC(r,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):Cb(Object(e)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(e,i))})}return r}function WC(r,t,e){return t=KC(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function KC(r){var t=QC(r,"string");return typeof t=="symbol"?t:t+""}function QC(r,t){if(typeof r!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var i=e.call(r,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function C1(r){return r&&r.map((t,e)=>Un.createElement(t.tag,nu({key:e},t.attr),C1(t.child)))}function $t(r){return t=>Un.createElement(ZC,eu({attr:nu({},r.attr)},t),C1(r.child))}function ZC(r){var t=e=>{var{attr:i,size:a,title:l}=r,c=YC(r,$C),u=a||e.size||"1em",d;return e.className&&(d=e.className),r.className&&(d=(d?d+" ":"")+r.className),Un.createElement("svg",eu({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},e.attr,i,c,{className:d,style:nu(nu({color:r.color||e.color},e.style),r.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),l&&Un.createElement("title",null,l),r.children)};return Tb!==void 0?Un.createElement(Tb.Consumer,null,e=>t(e)):t(T1)}function JC(r){return $t({attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5.482 12.944c-0.942-0.235-1.466-0.984-1.468-2.095-0-0.355 0.025-0.525 0.114-0.754 0.217-0.56 0.793-0.982 1.55-1.138 0.377-0.077 0.493-0.16 0.493-0.353 0-0.060 0.045-0.24 0.1-0.399 0.249-0.724 0.71-1.327 1.202-1.573 0.515-0.258 0.776-0.316 1.399-0.313 0.886 0.005 1.327 0.197 1.945 0.846l0.34 0.357 0.304-0.105c1.473-0.51 2.942 0.358 3.061 1.809l0.032 0.397 0.29 0.104c0.829 0.297 1.218 0.92 1.148 1.837-0.046 0.599-0.326 1.078-0.77 1.315l-0.209 0.112-4.638 0.009c-3.564 0.007-4.697-0.006-4.893-0.055v0zM1.613 12.281c-0.565-0.142-1.164-0.67-1.445-1.273-0.159-0.342-0.168-0.393-0.168-0.998 0-0.576 0.014-0.668 0.14-0.954 0.267-0.603 0.78-1.038 1.422-1.21 0.136-0.036 0.263-0.094 0.283-0.128s0.043-0.221 0.050-0.415c0.045-1.206 0.794-2.269 1.839-2.61 0.565-0.184 1.306-0.202 1.92 0.058 0.195 0.082 0.173 0.1 0.585-0.471 0.244-0.338 0.705-0.695 1.108-0.909 0.435-0.231 0.887-0.337 1.428-0.336 1.512 0.004 2.815 1.003 3.297 2.529 0.154 0.487 0.146 0.624-0.035 0.628-0.079 0.002-0.306 0.048-0.505 0.102l-0.361 0.099-0.329-0.348c-0.928-0.98-2.441-1.192-3.728-0.522-0.514 0.268-0.927 0.652-1.239 1.153-0.222 0.357-0.506 1.024-0.506 1.189 0 0.117-0.090 0.176-0.474 0.309-1.189 0.412-1.883 1.364-1.882 2.582 0 0.443 0.108 0.986 0.258 1.296 0.057 0.117 0.088 0.228 0.070 0.247-0.046 0.049-1.525 0.032-1.73-0.019v0z"},child:[]}]})(r)}function tR(r){return $t({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M.959 5.523c-.54 0-.959.42-.959.899v7.549a4.59 4.59 0 004.613 4.494 4.717 4.717 0 004.135-2.457c.779 1.438 2.337 2.457 4.074 2.457 2.577 0 4.674-2.037 4.674-4.613.06-2.457-2.037-4.495-4.613-4.495-1.738 0-3.295.959-4.074 2.397-.78-1.438-2.338-2.397-4.135-2.397-1.079 0-2.038.36-2.817.899V6.422a.92.92 0 00-.898-.899zM17.602 9.26a.95.95 0 00-.704.158c-.36.3-.479.899-.18 1.318l2.397 3.116-2.396 3.115c-.3.42-.24.96.18 1.26.419.3 1.016.298 1.316-.122l2.039-2.636 2.096 2.697c.3.36.899.419 1.318.12.36-.3.42-.84.121-1.259l-2.338-3.115 2.338-3.057c.3-.419.298-1.018-.121-1.318-.48-.3-1.019-.24-1.318.18l-2.096 2.576-2.04-2.695c-.149-.18-.373-.3-.612-.338zM4.613 11.154c1.558 0 2.817 1.26 2.817 2.758 0 1.558-1.259 2.756-2.817 2.756-1.558 0-2.816-1.198-2.816-2.756 0-1.498 1.258-2.758 2.816-2.758zm8.27 0c1.558 0 2.816 1.26 2.816 2.758-.06 1.558-1.318 2.756-2.816 2.756-1.558 0-2.817-1.198-2.817-2.756 0-1.498 1.259-2.758 2.817-2.758Z"},child:[]}]})(r)}function eR(r){return $t({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 1.807L0 5.629l6 3.822 6.001-3.822L6 1.807zM18 1.807l-6 3.822 6 3.822 6-3.822-6-3.822zM0 13.274l6 3.822 6.001-3.822L6 9.452l-6 3.822zM18 9.452l-6 3.822 6 3.822 6-3.822-6-3.822zM6 18.371l6.001 3.822 6-3.822-6-3.822L6 18.371z"},child:[]}]})(r)}function nR(r){return $t({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.01 1.485c-2.082 0-3.754.02-3.743.047.01.02 1.708 3.001 3.774 6.62l3.76 6.574h3.76c2.081 0 3.753-.02 3.742-.047-.005-.02-1.708-3.001-3.775-6.62l-3.76-6.574zm-4.76 1.73a789.828 789.861 0 0 0-3.63 6.319L0 15.868l1.89 3.298 1.885 3.297 3.62-6.335 3.618-6.33-1.88-3.287C8.1 4.704 7.255 3.22 7.25 3.214zm2.259 12.653-.203.348c-.114.198-.96 1.672-1.88 3.287a423.93 423.948 0 0 1-1.698 2.97c-.01.026 3.24.042 7.222.042h7.244l1.796-3.157c.992-1.734 1.85-3.23 1.906-3.323l.104-.167h-7.249z"},child:[]}]})(r)}function iR(r){return $t({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18.164 7.93V5.084a2.198 2.198 0 001.267-1.978v-.067A2.2 2.2 0 0017.238.845h-.067a2.2 2.2 0 00-2.193 2.193v.067a2.196 2.196 0 001.252 1.973l.013.006v2.852a6.22 6.22 0 00-2.969 1.31l.012-.01-7.828-6.095A2.497 2.497 0 104.3 4.656l-.012.006 7.697 5.991a6.176 6.176 0 00-1.038 3.446c0 1.343.425 2.588 1.147 3.607l-.013-.02-2.342 2.343a1.968 1.968 0 00-.58-.095h-.002a2.033 2.033 0 102.033 2.033 1.978 1.978 0 00-.1-.595l.005.014 2.317-2.317a6.247 6.247 0 104.782-11.134l-.036-.005zm-.964 9.378a3.206 3.206 0 113.215-3.207v.002a3.206 3.206 0 01-3.207 3.207z"},child:[]}]})(r)}function sR(r){return $t({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M13.762 4.29a6.51 6.51 0 0 0-5.669 3.332 3.571 3.571 0 0 0-1.558-.36 3.571 3.571 0 0 0-3.516 3A4.918 4.918 0 0 0 0 14.796a4.918 4.918 0 0 0 4.92 4.914 4.93 4.93 0 0 0 .617-.045h14.42c2.305-.272 4.041-2.258 4.043-4.589v-.009a4.594 4.594 0 0 0-3.727-4.508 6.51 6.51 0 0 0-6.511-6.27z"},child:[]}]})(r)}const aR=[{name:"Google Drive",icon:nR,color:"#4285F4"},{name:"Dropbox",icon:eR,color:"#0061FE"},{name:"OneDrive",icon:JC,color:"#0078D4"},{name:"iCloud",icon:sR,color:"#3693F3"},{name:"Box",icon:tR,color:"#0061D5"},{name:"HubSpot",icon:iR,color:"#FF7A59"}],rR=()=>b.jsx("section",{className:"px-6 py-24 bg-white",children:b.jsx("div",{className:"mx-auto w-full max-w-6xl",children:b.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-12",children:[b.jsxs("div",{className:"flex-1 space-y-8",children:[b.jsx(br,{eyebrow:"Integrations",title:"Connects with your workflow in one click",description:"DecoDocs integrates seamlessly with the tools you already use. Analyze documents directly from your cloud storage or email.",align:"left"}),b.jsxs("div",{className:"flex flex-col gap-4",children:[b.jsxs("div",{className:"flex items-center gap-3 text-slate-700 font-medium",children:[b.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-emerald-100 text-emerald-600 text-xs text-bold",children:""}),"Works with all file types"]}),b.jsxs("div",{className:"flex items-center gap-3 text-slate-700 font-medium",children:[b.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-emerald-100 text-emerald-600 text-xs text-bold",children:""}),"Secure OAuth connection"]}),b.jsxs("div",{className:"flex items-center gap-3 text-slate-700 font-medium",children:[b.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-emerald-100 text-emerald-600 text-xs text-bold",children:""}),"No file duplication"]})]})]}),b.jsx("div",{className:"flex-1 flex justify-center",children:b.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-6",children:aR.map(r=>b.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-slate-50 border border-slate-100 rounded-2xl shadow-sm w-32 h-32 hover:shadow-md transition-shadow group",children:[b.jsx(r.icon,{size:40,color:r.color,className:"mb-3 transition-transform group-hover:scale-110"}),b.jsx("span",{className:"text-xs font-semibold text-slate-600",children:r.name})]},r.name))})})]})})}),oR=[{title:"Your data is never used for training",description:"We and our AI partners never use your documents to train models. Your data remains yours, contractually guaranteed.",icon:b.jsx("svg",{className:"w-6 h-6 text-slate-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})},{title:"Locked down, end-to-end",description:"Your data is encrypted at rest (AES-256) and in transit (TLS 1.3). Only you can access your documents.",icon:b.jsx("svg",{className:"w-6 h-6 text-slate-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})},{title:"Privacy-first architecture",description:"DecoDocs is built with privacy as a core principle. Anonymous mode never stores files on our servers.",icon:b.jsx("svg",{className:"w-6 h-6 text-slate-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})},{title:"Built for enterprise IT",description:"Single Sign-On (SSO), audit logs, and custom retention polices available for enterprise teams.",icon:b.jsx("svg",{className:"w-6 h-6 text-slate-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}],lR=()=>b.jsx("section",{className:"px-6 py-24 bg-slate-50",children:b.jsxs("div",{className:"mx-auto w-full max-w-6xl flex flex-col gap-12",children:[b.jsx(br,{eyebrow:"Security",title:"Secure by design. Trusted by teams.",description:"We take security seriously. Your documents are your business, keeping them safe is ours.",align:"center"}),b.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:oR.map(r=>b.jsxs("div",{className:"bg-white p-8 rounded-3xl border border-slate-100 shadow-sm flex flex-col gap-4 hover:shadow-md transition-shadow",children:[b.jsx("div",{className:"w-12 h-12 rounded-2xl bg-slate-100 flex items-center justify-center",children:r.icon}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:r.title}),b.jsx("p",{className:"text-slate-600 leading-relaxed",children:r.description})]})]},r.title))}),b.jsxs("div",{className:"mt-8 p-8 bg-slate-900 rounded-3xl text-white text-center",children:[b.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Ready to start?"}),b.jsx("p",{className:"text-slate-300 mb-8 max-w-2xl mx-auto",children:"Join thousands of professionals who trust DecoDocs to understand their documents faster."}),b.jsx("div",{className:"flex justify-center gap-4",children:b.jsx("a",{href:"#hero",className:"inline-flex items-center justify-center font-bold rounded-full px-8 py-4 text-base bg-white text-slate-900 hover:bg-slate-100 transition-colors",children:"Get Started for Free"})})]})]})}),cR=()=>{const r=Ts(),t=I.useRef(null),e=()=>{t.current&&t.current.click()},i=a=>{const l=a.target.files?.[0];if(l){if(l.type!=="application/pdf"){alert("Please select a valid PDF file"),a.target.value="";return}window.gtag&&window.gtag("event","home_open_pdf_click",{event_category:"engagement",event_label:"landing_open_pdf"}),r("/view",{state:{document:{id:Date.now()+Math.random(),name:l.name,size:l.size,type:l.type,file:l}}}),a.target.value=""}};return b.jsxs(FC,{onOpenPdf:e,children:[b.jsx("input",{ref:t,type:"file",accept:".pdf,application/pdf",onChange:i,style:{display:"none"}}),b.jsx(zC,{onOpenPdf:e}),b.jsx(HC,{}),b.jsx(VC,{}),b.jsx(rR,{}),b.jsx(GC,{}),b.jsx(qC,{}),b.jsx(lR,{})]})};const uR="type.googleapis.com/google.protobuf.Int64Value",hR="type.googleapis.com/google.protobuf.UInt64Value";function R1(r,t){const e={};for(const i in r)r.hasOwnProperty(i)&&(e[i]=t(r[i]));return e}function iu(r){if(r==null)return null;if(r instanceof Number&&(r=r.valueOf()),typeof r=="number"&&isFinite(r)||r===!0||r===!1||Object.prototype.toString.call(r)==="[object String]")return r;if(r instanceof Date)return r.toISOString();if(Array.isArray(r))return r.map(t=>iu(t));if(typeof r=="function"||typeof r=="object")return R1(r,t=>iu(t));throw new Error("Data cannot be encoded in JSON: "+r)}function ur(r){if(r==null)return r;if(r["@type"])switch(r["@type"]){case uR:case hR:{const t=Number(r.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+r);return t}default:throw new Error("Data cannot be decoded from JSON: "+r)}return Array.isArray(r)?r.map(t=>ur(t)):typeof r=="function"||typeof r=="object"?R1(r,t=>ur(t)):r}const hp="functions";const Rb={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fe extends Fi{constructor(t,e,i){super(`${hp}/${t}`,e||""),this.details=i,Object.setPrototypeOf(this,Fe.prototype)}}function dR(r){if(r>=200&&r<300)return"ok";switch(r){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function su(r,t){let e=dR(r),i=e,a;try{const l=t&&t.error;if(l){const c=l.status;if(typeof c=="string"){if(!Rb[c])return new Fe("internal","internal");e=Rb[c],i=c}const u=l.message;typeof u=="string"&&(i=u),a=l.details,a!==void 0&&(a=ur(a))}}catch{}return e==="ok"?null:new Fe(e,i,a)}class fR{constructor(t,e,i,a){this.app=t,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,tn(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.auth=e.getImmediate({optional:!0}),this.messaging=i.getImmediate({optional:!0}),this.auth||e.get().then(l=>this.auth=l,()=>{}),this.messaging||i.get().then(l=>this.messaging=l,()=>{}),this.appCheck||a?.get().then(l=>this.appCheck=l,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(t){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const e=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(t){const e=await this.getAuthToken(),i=await this.getMessagingToken(),a=await this.getAppCheckToken(t);return{authToken:e,messagingToken:i,appCheckToken:a}}}const Df="us-central1",pR=/^data: (.*?)(?:\n|$)/;function mR(r){let t=null;return{promise:new Promise((e,i)=>{t=setTimeout(()=>{i(new Fe("deadline-exceeded","deadline-exceeded"))},r)}),cancel:()=>{t&&clearTimeout(t)}}}class gR{constructor(t,e,i,a,l=Df,c=(...u)=>fetch(...u)){this.app=t,this.fetchImpl=c,this.emulatorOrigin=null,this.contextProvider=new fR(t,e,i,a),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{const u=new URL(l);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=Df}catch{this.customDomain=null,this.region=l}}_delete(){return this.deleteService()}_url(t){const e=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${e}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${e}.cloudfunctions.net/${t}`}}function yR(r,t,e){const i=gr(t);r.emulatorOrigin=`http${i?"s":""}://${t}:${e}`,i&&(Iv(r.emulatorOrigin+"/backends"),Pv("Functions",!0))}function bR(r,t,e){const i=a=>wR(r,t,a,e||{});return i.stream=(a,l)=>AR(r,t,a,l),i}function D1(r){return r.emulatorOrigin&&gr(r.emulatorOrigin)?"include":void 0}async function vR(r,t,e,i,a){e["Content-Type"]="application/json";let l;try{l=await i(r,{method:"POST",body:JSON.stringify(t),headers:e,credentials:D1(a)})}catch{return{status:0,json:null}}let c=null;try{c=await l.json()}catch{}return{status:l.status,json:c}}async function N1(r,t){const e={},i=await r.contextProvider.getContext(t.limitedUseAppCheckTokens);return i.authToken&&(e.Authorization="Bearer "+i.authToken),i.messagingToken&&(e["Firebase-Instance-ID-Token"]=i.messagingToken),i.appCheckToken!==null&&(e["X-Firebase-AppCheck"]=i.appCheckToken),e}function wR(r,t,e,i){const a=r._url(t);return xR(r,a,e,i)}async function xR(r,t,e,i){e=iu(e);const a={data:e},l=await N1(r,i),c=i.timeout||7e4,u=mR(c),d=await Promise.race([vR(t,a,l,r.fetchImpl,r),u.promise,r.cancelAllRequests]);if(u.cancel(),!d)throw new Fe("cancelled","Firebase Functions instance was deleted.");const f=su(d.status,d.json);if(f)throw f;if(!d.json)throw new Fe("internal","Response is not valid JSON object.");let m=d.json.data;if(typeof m>"u"&&(m=d.json.result),typeof m>"u")throw new Fe("internal","Response is missing data field.");return{data:ur(m)}}function AR(r,t,e,i){const a=r._url(t);return SR(r,a,e,i||{})}async function SR(r,t,e,i){e=iu(e);const a={data:e},l=await N1(r,i);l["Content-Type"]="application/json",l.Accept="text/event-stream";let c;try{c=await r.fetchImpl(t,{method:"POST",body:JSON.stringify(a),headers:l,signal:i?.signal,credentials:D1(r)})}catch(v){if(v instanceof Error&&v.name==="AbortError"){const _=new Fe("cancelled","Request was cancelled.");return{data:Promise.reject(_),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(_)}}}}}}const w=su(0,null);return{data:Promise.reject(w),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(w)}}}}}}let u,d;const f=new Promise((v,w)=>{u=v,d=w});i?.signal?.addEventListener("abort",()=>{const v=new Fe("cancelled","Request was cancelled.");d(v)});const m=c.body.getReader(),g=_R(m,u,d,i?.signal);return{stream:{[Symbol.asyncIterator](){const v=g.getReader();return{async next(){const{value:w,done:_}=await v.read();return{value:w,done:_}},async return(){return await v.cancel(),{done:!0,value:void 0}}}}},data:f}}function _R(r,t,e,i){const a=(c,u)=>{const d=c.match(pR);if(!d)return;const f=d[1];try{const m=JSON.parse(f);if("result"in m){t(ur(m.result));return}if("message"in m){u.enqueue(ur(m.message));return}if("error"in m){const g=su(0,m);u.error(g),e(g);return}}catch(m){if(m instanceof Fe){u.error(m),e(m);return}}},l=new TextDecoder;return new ReadableStream({start(c){let u="";return d();async function d(){if(i?.aborted){const f=new Fe("cancelled","Request was cancelled");return c.error(f),e(f),Promise.resolve()}try{const{value:f,done:m}=await r.read();if(m){u.trim()&&a(u.trim(),c),c.close();return}if(i?.aborted){const v=new Fe("cancelled","Request was cancelled");c.error(v),e(v),await r.cancel();return}u+=l.decode(f,{stream:!0});const g=u.split(`
`);u=g.pop()||"";for(const v of g)v.trim()&&a(v.trim(),c);return d()}catch(f){const m=f instanceof Fe?f:su(0,null);c.error(m),e(m)}}},cancel(){return r.cancel()}})}const Db="@firebase/functions",Nb="0.13.1";const ER="auth-internal",TR="app-check-internal",CR="messaging-internal";function RR(r){const t=(e,{instanceIdentifier:i})=>{const a=e.getProvider("app").getImmediate(),l=e.getProvider(ER),c=e.getProvider(CR),u=e.getProvider(TR);return new gR(a,l,c,u,i)};cr(new Js(hp,t,"PUBLIC").setMultipleInstances(!0)),Ss(Db,Nb,r),Ss(Db,Nb,"esm2020")}function M1(r=Jf(),t=Df){const i=Zf(en(r),hp).getImmediate({identifier:t}),a=q_("functions");return a&&k1(i,...a),i}function k1(r,t,e){yR(en(r),t,e)}function oi(r,t,e){return bR(en(r),t,e)}RR();const L1=Object.freeze(Object.defineProperty({__proto__:null,FunctionsError:Fe,connectFunctionsEmulator:k1,getFunctions:M1,httpsCallable:oi},Symbol.toStringTag,{value:"Module"})),Mn=({children:r,showHeader:t=!0,showFooter:e=!0,variant:i="marketing"})=>{const{authState:a}=Cs(),l=yn(),c=a.status==="error"?a.error?.message:null,u=l.pathname==="/"||l.pathname==="/app",d=i==="app";return b.jsxs("div",{className:`legacy-app min-h-screen bg-[#f7f6f2] text-slate-900 flex flex-col ${d?"h-screen overflow-hidden":""}`,children:[t&&b.jsxs("header",{className:"sticky top-0 z-30 w-full border-b border-white/40 bg-white/70 backdrop-blur-xl",children:[b.jsxs("div",{className:`mx-auto flex w-full max-w-6xl items-center justify-between px-6 ${d?"h-14 py-2":"py-4"}`,children:[b.jsxs(Xt,{to:"/",className:"flex items-center gap-3 text-lg font-semibold text-slate-900 no-underline",children:[b.jsx("img",{src:Wf,alt:"DecoDocs",className:"h-9 w-9"}),!d&&"DecoDocs"]}),!d&&b.jsx("nav",{className:"hidden items-center gap-6 text-sm font-medium text-slate-600 md:flex",children:u?b.jsxs(b.Fragment,{children:[b.jsx("a",{className:"hover:text-slate-900 transition",href:"#how-it-works",children:"How it works"}),b.jsx("a",{className:"hover:text-slate-900 transition",href:"#features",children:"Features"}),b.jsx("a",{className:"hover:text-slate-900 transition",href:"#use-cases",children:"Use cases"}),b.jsx("a",{className:"hover:text-slate-900 transition",href:"#pricing",children:"Pricing"})]}):b.jsxs(b.Fragment,{children:[b.jsx(Xt,{className:"hover:text-slate-900 transition no-underline text-slate-600",to:"/view",children:"App"}),b.jsx(Xt,{className:"hover:text-slate-900 transition no-underline text-slate-600",to:"/pricing",children:"Pricing"}),b.jsx(Xt,{className:"hover:text-slate-900 transition no-underline text-slate-600",to:"/sign-in",children:"Sign in"}),b.jsx(Xt,{className:"hover:text-slate-900 transition no-underline text-slate-600",to:"/profile",children:"Profile"})]})}),b.jsxs("div",{className:"flex items-center gap-3",children:[!d&&b.jsxs(b.Fragment,{children:[b.jsx(Xt,{to:"/view",className:"hidden rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm hover:border-slate-300 md:inline-flex no-underline",children:"Launch app"}),b.jsx(Xt,{to:"/pricing",className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-slate-900/20 transition hover:-translate-y-0.5 no-underline",children:"Pricing"})]}),d&&b.jsx("div",{className:"flex items-center gap-4",children:b.jsx(Xt,{to:"/profile",className:"text-sm font-medium text-slate-600 hover:text-slate-900 no-underline",children:"Profile"})})]})]}),b.jsx("div",{className:"border-t border-white/40 bg-white/60 px-6 py-2 text-xs text-slate-600",children:b.jsx("div",{className:"mx-auto w-full max-w-6xl",children:a.status==="authenticated"?b.jsx("span",{children:"Authenticated (AI features available)"}):c?b.jsxs("span",{children:['AI calls disabled: "',c,'" (viewer still works)']}):b.jsx("span",{children:"Authenticating"})})})]}),b.jsx("main",{className:"flex-1 flex flex-col min-h-0",children:r}),e?b.jsx(Cv,{}):null]})};function DR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z",clipRule:"evenodd"},child:[]}]})(r)}function O1(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"},child:[]}]})(r)}function I1(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"},child:[]}]})(r)}function NR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M5.5 13a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 13H11V9.413l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13H5.5z"},child:[]},{tag:"path",attr:{d:"M9 13h2v5a1 1 0 11-2 0v-5z"},child:[]}]})(r)}function MR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M6.672 1.911a1 1 0 10-1.932.518l.259.966a1 1 0 001.932-.518l-.26-.966zM2.429 4.74a1 1 0 10-.517 1.932l.966.259a1 1 0 00.517-1.932l-.966-.26zm8.814-.569a1 1 0 00-1.415-1.414l-.707.707a1 1 0 101.415 1.415l.707-.708zm-7.071 7.072l.707-.707A1 1 0 003.465 9.12l-.708.707a1 1 0 001.415 1.415zm3.2-5.171a1 1 0 00-1.3 1.3l4 10a1 1 0 001.823.075l1.38-2.759 3.018 3.02a1 1 0 001.414-1.415l-3.019-3.02 2.76-1.379a1 1 0 00-.076-1.822l-10-4z",clipRule:"evenodd"},child:[]}]})(r)}function kR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z",clipRule:"evenodd"},child:[]}]})(r)}function LR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(r)}function OR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z",clipRule:"evenodd"},child:[]}]})(r)}function IR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"},child:[]}]})(r)}function PR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"},child:[]}]})(r)}function jR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"},child:[]}]})(r)}function BR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"},child:[]}]})(r)}function UR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"},child:[]}]})(r)}function FR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M10 1.944A11.954 11.954 0 012.166 5C2.056 5.649 2 6.319 2 7c0 5.225 3.34 9.67 8 11.317C14.66 16.67 18 12.225 18 7c0-.682-.057-1.35-.166-2.001A11.954 11.954 0 0110 1.944zM11 14a1 1 0 11-2 0 1 1 0 012 0zm0-7a1 1 0 10-2 0v3a1 1 0 102 0V7z",clipRule:"evenodd"},child:[]}]})(r)}function zR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732l-3.354 1.935-1.18 4.455a1 1 0 01-1.933 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732l3.354-1.935 1.18-4.455A1 1 0 0112 2z",clipRule:"evenodd"},child:[]}]})(r)}function HR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"},child:[]}]})(r)}function VR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7 2a1 1 0 011 1v1h3a1 1 0 110 2H9.578a18.87 18.87 0 01-1.724 4.78c.29.354.596.696.914 1.026a1 1 0 11-1.44 1.389c-.188-.196-.373-.396-.554-.6a19.098 19.098 0 01-3.107 3.567 1 1 0 01-1.334-1.49 17.087 17.087 0 003.13-3.733 18.992 18.992 0 01-1.487-2.494 1 1 0 111.79-.89c.234.47.489.928.764 1.372.417-.934.752-1.913.997-2.927H3a1 1 0 110-2h3V3a1 1 0 011-1zm6 6a1 1 0 01.894.553l2.991 5.982a.869.869 0 01.02.037l.99 1.98a1 1 0 11-1.79.895L15.383 16h-4.764l-.724 1.447a1 1 0 11-1.788-.894l.99-1.98.019-.038 2.99-5.982A1 1 0 0113 8zm-1.382 6h2.764L13 11.236 11.618 14z",clipRule:"evenodd"},child:[]}]})(r)}function GR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"},child:[]}]})(r)}function qR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"},child:[]}]})(r)}function $R(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M5 8a1 1 0 011-1h1V6a1 1 0 012 0v1h1a1 1 0 110 2H9v1a1 1 0 11-2 0V9H6a1 1 0 01-1-1z"},child:[]},{tag:"path",attr:{fillRule:"evenodd",d:"M2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-4a4 4 0 100 8 4 4 0 000-8z",clipRule:"evenodd"},child:[]}]})(r)}function YR(r){return $t({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"},child:[]},{tag:"path",attr:{fillRule:"evenodd",d:"M5 8a1 1 0 011-1h4a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"},child:[]}]})(r)}const P1=({onFileSelect:r,onEdit:t,pageNumber:e,numPages:i,pageScale:a,onPreviousPage:l,onNextPage:c,onZoomIn:u,onZoomOut:d,fileInputRef:f})=>b.jsxs("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-4 bg-slate-900/90 backdrop-blur-md px-4 py-2 rounded-full shadow-2xl border border-white/10 z-30 transition-all hover:bg-slate-900 text-white",children:[b.jsx("div",{className:"flex items-center gap-2 pr-3 border-r border-white/20",children:b.jsx("button",{onClick:()=>f.current?.click(),className:"p-1.5 !bg-transparent text-slate-300 hover:text-white hover:!bg-white/10 rounded-full transition-colors tooltip-trigger",title:"Open PDF",children:b.jsx(qR,{className:"w-5 h-5"})})}),b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("button",{onClick:l,disabled:e<=1,className:"p-1 !bg-transparent rounded-full hover:!bg-white/10 disabled:opacity-30 disabled:hover:!bg-transparent transition-colors text-white",children:b.jsx(O1,{className:"w-5 h-5"})}),b.jsxs("span",{className:"text-sm font-medium text-white min-w-[4ch] text-center select-none font-mono tracking-wide",children:[e," ",b.jsxs("span",{className:"text-slate-400 font-normal",children:["/ ",i||"-"]})]}),b.jsx("button",{onClick:c,disabled:e>=i,className:"p-1 !bg-transparent rounded-full hover:!bg-white/10 disabled:opacity-30 disabled:hover:!bg-transparent transition-colors text-white",children:b.jsx(I1,{className:"w-5 h-5"})})]}),b.jsxs("div",{className:"flex items-center gap-2 pl-3 border-l border-white/20",children:[b.jsx("button",{onClick:d,className:"p-1.5 !bg-transparent text-slate-300 hover:text-white hover:!bg-white/10 rounded-full transition-colors",title:"Zoom Out",children:b.jsx(YR,{className:"w-4 h-4"})}),b.jsxs("span",{className:"text-xs font-medium text-slate-400 w-10 text-center select-none",children:[Math.round(a*100),"%"]}),b.jsx("button",{onClick:u,className:"p-1.5 !bg-transparent text-slate-300 hover:text-white hover:!bg-white/10 rounded-full transition-colors",title:"Zoom In",children:b.jsx($R,{className:"w-4 h-4"})})]}),b.jsx("input",{type:"file",ref:f,accept:".pdf",onChange:r,className:"hidden"})]}),XR=(r,t)=>{const e=I.useRef(null),i=I.useRef(null),a=I.useRef(null),l=m=>{alert(`Clause: ${m.text}

${m.details||"No details available."}`)},c=m=>{alert(`Risk: ${m.description}

${m.explanation||"No explanation available."}`)},u=I.useCallback(async(m,g)=>{if(i.current){i.current.innerHTML="";try{const w=(await m.getTextContent()).items,_=g.transform;for(const x of w){const S=document.createElement("span");S.textContent=x.str,S.style.position="absolute",S.style.color="transparent",S.style.whiteSpace="pre",S.style.fontSize=`${x.height}px`,S.style.fontFamily="sans-serif",S.style.lineHeight="1";const E=_[0]*x.transform[4]+_[2]*x.transform[5]+_[4],R=_[1]*x.transform[4]+_[3]*x.transform[5]+_[5];S.style.left=`${E}px`,S.style.top=`${R}px`,S.style.width=`${x.width*_[0]}px`,S.style.height=`${x.height*_[3]}px`,i.current.appendChild(S)}}catch(v){console.error("Error rendering text layer:",v)}}},[]),d=I.useCallback((m,g,v,w,_)=>{a.current&&(a.current.innerHTML="",v.filter(x=>x.pageNum===m).forEach(x=>{const S=document.createElement("div");S.className="highlight-overlay",S.style.position="absolute",S.style.backgroundColor="rgba(255, 255, 0, 0.3)",S.style.border="1px solid rgba(255, 255, 0, 0.5)",S.style.left=`${x.x}px`,S.style.top=`${x.y}px`,S.style.width=`${x.width}px`,S.style.height=`${x.height}px`,S.style.pointerEvents="none",S.dataset.page=m,a.current.appendChild(S)}),w.filter(x=>x.pageNum===m).forEach(x=>{const S=document.createElement("div");S.className="clause-marker",S.style.position="absolute",S.style.left=`${x.x}px`,S.style.top=`${x.y}px`,S.style.width="20px",S.style.height="20px",S.style.borderRadius="50%",S.style.backgroundColor="rgba(0, 123, 255, 0.7)",S.style.cursor="pointer",S.style.zIndex="10",S.title=x.text,S.onclick=()=>l(x),a.current.appendChild(S)}),_.filter(x=>x.pageNum===m).forEach(x=>{const S=document.createElement("div");S.className="risk-badge",S.style.position="absolute",S.style.left=`${x.x}px`,S.style.top=`${x.y}px`,S.style.padding="2px 6px",S.style.borderRadius="10px",S.style.fontSize="12px",S.style.fontWeight="bold",S.style.color="white",S.style.backgroundColor=x.level==="high"?"#dc3545":x.level==="medium"?"#fd7e14":"#ffc107",S.style.cursor="pointer",S.style.zIndex="10",S.title=x.description,S.onclick=()=>c(x),S.textContent=x.level.toUpperCase(),a.current.appendChild(S)}))},[]),f=I.useCallback(async(m,g=[],v=[],w=[])=>{if(!(!r||!e.current))try{const _=await r.getPage(m),x=e.current,S=x.getContext("2d"),E=t,R=_.getViewport({scale:E});x.height=R.height,x.width=R.width,S.clearRect(0,0,x.width,x.height);const C={canvasContext:S,viewport:R};await _.render(C).promise,await u(_,R),d(m,R,g,v,w)}catch(_){console.error("Error rendering page:",_)}},[r,t,u,d]);return{canvasRef:e,textLayerRef:i,annotationsRef:a,renderPage:f}},WR=({pdfDoc:r,pageNum:t,scale:e,highlights:i=[],clauseMarkers:a=[],riskBadges:l=[],id:c,children:u})=>{const{canvasRef:d,textLayerRef:f,annotationsRef:m,renderPage:g}=XR(r,e);return I.useEffect(()=>{r&&t&&g(t,i,a,l)},[r,t,e,i,a,l,g]),b.jsxs("div",{id:c,className:"relative bg-white shadow-lg mb-8 transition-transform origin-top",style:{width:"fit-content",height:"fit-content"},children:[b.jsx("canvas",{ref:d,className:"block"}),b.jsx("div",{ref:f,className:"absolute top-0 left-0 w-full h-full overflow-hidden opacity-0 leading-none"}),b.jsx("div",{ref:m,className:"absolute top-0 left-0 w-full h-full pointer-events-none"}),u]})},j1=({pdfDoc:r,numPages:t,pageScale:e,isLoading:i,loadingMessage:a,onPageVisible:l,highlights:c=[],clauseMarkers:u=[],riskBadges:d=[],renderPageOverlay:f})=>{const m=I.useRef(null);return I.useEffect(()=>{if(!r||!m.current||!l)return;const g=new IntersectionObserver(w=>{w.forEach(_=>{if(_.isIntersecting){const x=parseInt(_.target.getAttribute("data-page-num"),10);l(x)}})},{root:m.current,threshold:.5});return m.current.querySelectorAll(".page-wrapper").forEach(w=>g.observe(w)),()=>g.disconnect()},[r,t,l]),i?b.jsx("div",{className:"flex-1 flex items-center justify-center border border-dashed border-gray-300 rounded bg-gray-50 text-gray-600 h-full",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"w-10 h-10 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),b.jsx("p",{children:a||"Loading PDF..."})]})}):r?b.jsx("div",{className:"flex flex-col items-center gap-8 py-8 w-full",children:Array.from({length:t},(g,v)=>v+1).map(g=>b.jsx("div",{className:"page-wrapper","data-page-num":g,children:b.jsx(WR,{id:`pdf-page-${g}`,pdfDoc:r,pageNum:g,scale:e,highlights:c,clauseMarkers:u,riskBadges:d,children:f?f(g):null})},g))}):null},B1=({onFileSelect:r})=>{const[t,e]=I.useState(!1),i=I.useRef(null),a=u=>{u.preventDefault(),e(!0)},l=u=>{u.preventDefault(),e(!1)},c=u=>{u.preventDefault(),e(!1),u.dataTransfer.files&&u.dataTransfer.files.length>0&&r({target:{files:u.dataTransfer.files}})};return b.jsxs("div",{className:`flex flex-col items-center justify-center w-full max-w-2xl mx-auto h-96 border-2 border-dashed rounded-3xl transition-all duration-300 ${t?"border-blue-500 bg-blue-50/50 scale-105 shadow-xl":"border-slate-300 bg-white/50 hover:border-blue-400 hover:bg-slate-50"}`,onDragOver:a,onDragLeave:l,onDrop:c,children:[b.jsx("div",{className:`p-6 rounded-full mb-6 transition-colors ${t?"bg-blue-100 text-blue-600":"bg-slate-100 text-slate-400"}`,children:b.jsx(NR,{className:"w-16 h-16"})}),b.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Upload a PDF to start"}),b.jsx("p",{className:"text-slate-500 mb-8 text-center max-w-md px-4",children:"Drag and drop your file here, or click the button below to browse your computer."}),b.jsxs("button",{onClick:()=>i.current?.click(),className:"px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg shadow-blue-600/20 transition-all hover:-translate-y-1 active:translate-y-0 flex items-center gap-3",children:[b.jsx(kR,{className:"w-6 h-6"}),"Choose File"]}),b.jsx("input",{type:"file",ref:i,onChange:r,accept:".pdf",className:"hidden"})]})},KR=({pdfDoc:r,pageNum:t,onClick:e,isActive:i})=>{const a=I.useRef(null);return I.useEffect(()=>{if(!r||!a.current)return;(async()=>{try{const c=await r.getPage(t),u=c.getViewport({scale:.2}),d=a.current,f=d.getContext("2d");d.height=u.height,d.width=u.width;const m={canvasContext:f,viewport:u};await c.render(m).promise}catch{}})()},[r,t]),b.jsxs("div",{className:"flex flex-col items-center gap-2 group relative",children:[b.jsxs("div",{className:`absolute -top-3 right-0 flex gap-1 transition-opacity ${i?"opacity-100":"opacity-0 group-hover:opacity-100"} z-10`,children:[b.jsx("button",{className:"p-1.5 rounded !bg-transparent hover:!bg-slate-200/70 !text-slate-600 hover:!text-slate-800 transition-colors",title:"Rotate",children:b.jsx(UR,{className:"w-3.5 h-3.5"})}),b.jsx("button",{className:"p-1.5 rounded !bg-transparent hover:!bg-slate-200/70 !text-slate-600 hover:!text-slate-800 transition-colors",title:"Delete",children:b.jsx(GR,{className:"w-3.5 h-3.5"})})]}),b.jsx("div",{onClick:e,className:`cursor-pointer p-1 rounded-sm transition-all border-2 ${i?"border-blue-500 ring-2 ring-blue-100":"border-transparent hover:border-blue-200"}`,children:b.jsx("div",{className:"shadow-sm bg-white",children:b.jsx("canvas",{ref:a,className:"block w-28 h-auto"})})}),b.jsx("div",{className:"text-center text-xs text-slate-400 font-medium",children:t}),b.jsx("div",{className:"w-full h-4 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer text-blue-500",children:b.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-50 border border-blue-200 flex items-center justify-center hover:bg-blue-600 hover:text-white transition-colors",children:b.jsx(BR,{className:"w-4 h-4"})})})]})},U1=({pdfDoc:r,numPages:t,currentPage:e,onPageClick:i})=>!r||!t?null:b.jsx("div",{className:"w-64 bg-slate-50 border-r border-slate-200 h-full overflow-y-auto p-4 flex flex-col gap-4",children:Array.from({length:t},(a,l)=>l+1).map(a=>b.jsx(KR,{pdfDoc:r,pageNum:a,isActive:e===a,onClick:()=>i(a)},a))}),QR=({risk:r})=>{const t=i=>{switch(i){case"high":return"bg-red-600";case"medium":return"bg-orange-500";case"low":return"bg-yellow-500";default:return"bg-gray-500"}},e=i=>{switch(i){case"high":return"border-l-red-600";case"medium":return"border-l-orange-500";case"low":return"border-l-yellow-500";default:return"border-l-gray-500"}};return b.jsxs("div",{className:`mb-3 border border-gray-300 rounded overflow-hidden ${e(r.riskLevel)}`,children:[b.jsxs("div",{className:"flex justify-between items-center p-2.5 bg-gray-50",children:[b.jsx("h6",{className:"m-0 text-gray-700 font-semibold",children:r.clause}),b.jsx("span",{className:`px-2 py-0.5 rounded-xl text-xs font-bold text-white ${t(r.riskLevel)}`,children:r.riskLevel.toUpperCase()})]}),b.jsxs("div",{className:"p-2.5 bg-white",children:[b.jsxs("p",{className:"mb-2",children:[b.jsx("strong",{children:"Risk:"})," ",r.description]}),b.jsxs("p",{className:"m-0",children:[b.jsx("strong",{children:"Plain Language:"})," ",r.explanation]})]})]})},ZR=({analysis:r})=>{const t=r?._meta||{status:r?"success":"idle"};if(!r||t.status==="idle")return b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md mt-2.5",children:[b.jsx("h4",{className:"mt-0 text-gray-800 border-b border-gray-300 pb-2",children:"Analysis Results"}),b.jsx("p",{className:"text-gray-700 m-0",children:"No analysis yet. Run Type-specific analysis (recommended) to see results here."})]});if(t.status==="loading")return b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md mt-2.5",children:[b.jsx("h4",{className:"mt-0 text-gray-800 border-b border-gray-300 pb-2",children:"Analysis Results"}),b.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[b.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-blue-500 rounded-full animate-spin"}),b.jsx("div",{children:t.message||"Analyzing"})]})]});if(t.status==="error")return b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md mt-2.5",children:[b.jsx("h4",{className:"mt-0 text-gray-800 border-b border-gray-300 pb-2",children:"Analysis Results"}),b.jsxs("div",{className:"rounded border border-red-200 bg-red-50 p-3 text-sm text-red-900",children:[b.jsx("div",{className:"font-semibold",children:"Analysis failed"}),b.jsx("div",{className:"mt-1",children:t.message||"Request failed."})]})]});const e=typeof r.summary=="string"&&r.summary.trim().length>0,i=Array.isArray(r.risks)&&r.risks.length>0,a=Array.isArray(r.recommendations)&&r.recommendations.length>0;return b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md mt-2.5",children:[b.jsx("h4",{className:"mt-0 text-gray-800 border-b border-gray-300 pb-2",children:"Analysis Results"}),!e&&!r.typeSpecific?b.jsx("p",{className:"text-gray-700 m-0",children:"No results were returned yet."}):null,e&&b.jsxs("div",{className:"mb-4",children:[b.jsx("h5",{className:"mt-0 text-gray-700 font-semibold mb-2",children:"Document Summary"}),b.jsx("p",{className:"text-gray-700",children:r.summary})]}),i&&b.jsxs("div",{className:"mb-4",children:[b.jsx("h5",{className:"mt-0 text-gray-700 font-semibold mb-2",children:"Identified Risks"}),r.risks.map(l=>b.jsx(QR,{risk:l},l.id))]}),r.typeSpecific&&b.jsxs("div",{className:"mb-4",children:[b.jsx("h5",{className:"mt-0 text-gray-700 font-semibold mb-2",children:"Type-specific (beta)"}),b.jsxs("div",{className:"text-gray-700",style:{whiteSpace:"pre-wrap"},children:[b.jsxs("div",{children:[b.jsx("strong",{children:"effectiveTypeId:"})," ",r.typeSpecific.effectiveTypeId||""]}),b.jsxs("div",{children:[b.jsx("strong",{children:"validationSlug:"})," ",r.typeSpecific.validationSlug||""]}),b.jsxs("div",{children:[b.jsx("strong",{children:"validationTitle:"})," ",r.typeSpecific.validationTitle||""]}),r.typeSpecific.result?.plainExplanation?b.jsxs("div",{style:{marginTop:8},children:[b.jsx("strong",{children:"explanation:"}),b.jsx("div",{children:r.typeSpecific.result.plainExplanation})]}):null,r.typeSpecific.usage?b.jsxs("div",{style:{marginTop:8},children:[b.jsx("strong",{children:"usage:"}),b.jsxs("div",{children:["estimatedTokens: ",r.typeSpecific.usage.estimatedTokens??"","  ","remainingTokens: ",r.typeSpecific.usage.remainingTokens??""]})]}):null,r.typeSpecific.ok===!1&&(r.typeSpecific.code||r.typeSpecific.requiredTier)?b.jsxs("div",{style:{marginTop:8,color:"#991b1b"},children:[b.jsx("strong",{children:"blocked:"})," ",r.typeSpecific.code||"",r.typeSpecific.requiredTier?` (required: ${r.typeSpecific.requiredTier})`:""]}):null,r.typeSpecific.result?.checks?.length?b.jsxs("div",{style:{marginTop:8},children:[b.jsx("strong",{children:"checks:"}),b.jsx("ul",{className:"list-none p-0",style:{marginTop:6},children:r.typeSpecific.result.checks.map(l=>b.jsx("li",{className:"mb-2 p-2 border border-gray-200 rounded",children:b.jsxs("div",{children:[b.jsxs("strong",{children:[l.ok?"OK":"FAIL",":"]})," ",l.message]})},l.id))})]}):null,r.typeSpecific.result?.extracted&&Object.keys(r.typeSpecific.result.extracted).length?b.jsxs("div",{style:{marginTop:8},children:[b.jsx("strong",{children:"extracted:"}),b.jsx("pre",{style:{marginTop:6,background:"#f8fafc",border:"1px solid #e2e8f0",padding:10,borderRadius:10,overflow:"auto"},children:JSON.stringify(r.typeSpecific.result.extracted,null,2)})]}):null,r.typeSpecific.message?b.jsxs("div",{style:{marginTop:8},children:[b.jsx("strong",{children:"message:"}),b.jsx("div",{children:r.typeSpecific.message})]}):null]})]}),a&&b.jsxs("div",{children:[b.jsx("h5",{className:"mt-0 text-gray-700 font-semibold mb-2",children:"Recommendations"}),b.jsx("ul",{className:"list-none p-0",children:r.recommendations.map((l,c)=>b.jsx("li",{className:"mb-4 p-2.5 border border-gray-300 rounded",children:b.jsx("div",{className:"text-gray-700",children:l})},c))})]})]})},JR=({isOpen:r,onToggle:t,onAnalyzeDocument:e,onAnalyzeByType:i,onExplainSelection:a,onHighlightRisks:l,onTranslateToPlainEnglish:c,isLoading:u,isAuthenticated:d,hasDocument:f,selectedDocument:m,analysisResults:g})=>{const[v,w]=I.useState("tools");Un.useEffect(()=>{m&&g[m.id]&&w("results")},[g,m]);const _=!f||!d||u;return r?b.jsxs("div",{className:"w-[350px] bg-white border-l border-slate-200 flex flex-col h-full shadow-xl transition-all relative z-20",children:[b.jsxs("div",{className:"h-14 border-b border-slate-200 flex items-center justify-between px-4 bg-slate-50/50",children:[b.jsxs("h3",{className:"font-semibold text-slate-800 flex items-center gap-2",children:[b.jsx(zR,{className:"text-purple-600"}),"AI Assistant"]}),b.jsx("button",{onClick:t,className:"p-1 hover:bg-slate-200 rounded",children:b.jsx(I1,{className:"w-5 h-5 text-slate-500"})})]}),b.jsxs("div",{className:"flex border-b border-slate-200",children:[b.jsx("button",{onClick:()=>w("tools"),className:`flex-1 py-3 text-sm font-medium transition-colors ${v==="tools"?"text-purple-600 border-b-2 border-purple-600 bg-purple-50/50":"text-slate-600 hover:bg-slate-50"}`,children:"Tools"}),b.jsx("button",{onClick:()=>w("results"),disabled:!m||!g[m.id],className:`flex-1 py-3 text-sm font-medium transition-colors ${v==="results"?"text-purple-600 border-b-2 border-purple-600 bg-purple-50/50":"text-slate-600 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:"Results"})]}),b.jsx("div",{className:"flex-1 overflow-y-auto p-5",children:v==="tools"?b.jsxs("div",{className:"flex flex-col gap-3",children:[!f&&b.jsx("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-100 text-center text-sm text-slate-500",children:"Open a document to use AI tools"}),f&&!d&&b.jsx("div",{className:"p-4 bg-amber-50 rounded-lg border border-amber-100 text-sm text-amber-800",children:"Sign in to use AI features."}),b.jsx(rf,{icon:OR,label:"Deep Analysis",sublabel:"Identify risks, obligations & summary",onClick:()=>{i(),w("results")},disabled:_,primary:!0}),b.jsx("div",{className:"h-px bg-slate-100 my-2"}),b.jsx(rf,{icon:FR,label:"Highlight Risks",onClick:l,disabled:_}),b.jsx(rf,{icon:VR,label:"Plain English",onClick:c,disabled:_})]}):b.jsx("div",{className:"prose prose-sm",children:m&&g[m.id]?b.jsx(ZR,{analysis:g[m.id]}):b.jsx("div",{className:"text-center text-slate-500 mt-10",children:"No analysis results yet. Run a tool to see output here."})})})]}):b.jsx("button",{onClick:t,className:"absolute right-0 top-1/2 -translate-y-1/2 bg-white border border-slate-200 rounded-l-lg p-2 shadow-md hover:bg-slate-50 z-20",title:"Open AI Sidebar",children:b.jsx(O1,{className:"w-5 h-5 text-slate-600"})})},rf=({icon:r,label:t,sublabel:e,onClick:i,disabled:a,primary:l})=>b.jsxs("button",{onClick:i,disabled:a,className:`w-full flex items-start gap-3 p-3 rounded-xl border text-left transition-all ${l?"bg-slate-900 border-slate-900 text-white hover:bg-slate-800 shadow-md":"bg-white border-slate-200 text-slate-700 hover:border-slate-300 hover:bg-slate-50"} ${a?"opacity-50 cursor-not-allowed":""}`,children:[b.jsx("div",{className:`p-2 rounded-lg ${l?"bg-white/10":"bg-slate-100"} shrink-0`,children:b.jsx(r,{className:`w-5 h-5 ${l?"text-white":"text-slate-600"}`})}),b.jsxs("div",{children:[b.jsx("div",{className:"font-semibold text-sm",children:t}),e&&b.jsx("div",{className:`text-xs mt-0.5 ${l?"text-slate-300":"text-slate-500"}`,children:e})]})]}),ee={UNREADABLE:"UNREADABLE",GENERAL:"GENERAL",BUSINESS_LEGAL:"BUSINESS_LEGAL"},tD=[{id:"unreadable_broken",label:"Unreadable / broken file",category:ee.UNREADABLE,synonyms:["corrupt","broken","invalid pdf","cannot open","damaged"]},{id:"unreadable_encrypted",label:"Password-protected / encrypted",category:ee.UNREADABLE,synonyms:["encrypted","password","protected"]},{id:"unreadable_empty",label:"Empty / blank document",category:ee.UNREADABLE,synonyms:["blank","empty","no text"]},{id:"general_letter",label:"Letter (general / personal)",category:ee.GENERAL,synonyms:["letter","correspondence","personal letter"]},{id:"general_police_letter",label:"Police letter / notice",category:ee.GENERAL,synonyms:["police","notice","infringement","fine","offence"]},{id:"general_presentation",label:"Presentation / pitch deck",category:ee.GENERAL,synonyms:["deck","slides","presentation","pitch"]},{id:"general_marketing",label:"Flyer / advertisement / marketing",category:ee.GENERAL,synonyms:["flyer","ad","advertisement","brochure","marketing"]},{id:"general_book",label:"Book / long-form text",category:ee.GENERAL,synonyms:["book","chapter","novel","story","longform"]},{id:"general_notes",label:"Notes / diary / journal",category:ee.GENERAL,synonyms:["notes","diary","journal","private notes"]},{id:"general_schedule",label:"Schedule / timetable",category:ee.GENERAL,synonyms:["schedule","timetable","calendar","rota"]},{id:"general_sop_procedure",label:"SOP / procedure",category:ee.GENERAL,synonyms:["sop","procedure","runbook","work instruction","instructions","guide"],validationSlug:"sop-procedure"},{id:"general_resume_cv",label:"Resume / CV",category:ee.GENERAL,synonyms:["resume","cv","curriculum vitae","work experience","education","skills"]},{id:"legal_job_offer",label:"Job offer / offer letter",category:ee.BUSINESS_LEGAL,synonyms:["offer letter","job offer","employment offer","compensation","salary","starting date"],validationSlug:"job-offer"},{id:"legal_contract_generic",label:"Contract / agreement (general)",category:ee.BUSINESS_LEGAL,synonyms:["agreement","contract","terms","conditions"]},{id:"legal_employment_contract",label:"Employment contract",category:ee.BUSINESS_LEGAL,synonyms:["employment","employee","employer","salary","position"]},{id:"legal_nda",label:"NDA / confidentiality agreement",category:ee.BUSINESS_LEGAL,synonyms:["nda","non-disclosure","confidentiality"]},{id:"legal_lease_residential",label:"Residential lease / tenancy agreement",category:ee.BUSINESS_LEGAL,synonyms:["lease","tenancy","rent","bond","landlord","tenant"]},{id:"legal_lease_commercial",label:"Commercial lease",category:ee.BUSINESS_LEGAL,synonyms:["commercial lease","premises","outgoings"]},{id:"business_invoice",label:"Invoice",category:ee.BUSINESS_LEGAL,synonyms:["invoice","tax invoice","payment due"],validationSlug:"invoice"},{id:"business_purchase_order",label:"Purchase order",category:ee.BUSINESS_LEGAL,synonyms:["purchase order","po","order"]},{id:"policy_privacy",label:"Privacy policy",category:ee.BUSINESS_LEGAL,synonyms:["privacy policy","personal information","data collection"],validationSlug:"company-policy"},{id:"policy_terms",label:"Terms of service / website terms",category:ee.BUSINESS_LEGAL,synonyms:["terms of service","terms","conditions","website terms"]}];function F1(){const[r,t]=I.useState(null);I.useEffect(()=>{let l=!1;return(async()=>{try{const u=await fetch("/classifications/document-types.index.json",{cache:"force-cache"});if(!u.ok)throw new Error(`Failed to load document types: ${u.status}`);const d=await u.json(),f=Array.isArray(d?.types)?d.types:null;if(f)for(const m of f)"validationSlug"in m||(m.validationSlug=null);if(!f)throw new Error("Invalid document-types.index.json");l||t(f)}catch{l||t(null)}})(),()=>{l=!0}},[]);const e=I.useMemo(()=>Array.isArray(r)&&r.length?r:tD,[r]),i=I.useMemo(()=>l=>{const c=String(l||"").trim().toLowerCase();if(!c)return e;const u=d=>{const f=String(d.label||"").toLowerCase(),m=Array.isArray(d.synonyms)?d.synonyms.join(" ").toLowerCase():"";if(f.includes(c))return 100;if(m.includes(c))return 80;const g=c.split(/\s+/).filter(Boolean);return g.length&&g.every(v=>f.includes(v)||m.includes(v))?60:0};return e.map(d=>({t:d,s:u(d)})).filter(d=>d.s>0).sort((d,f)=>f.s-d.s).map(d=>d.t)},[e]);return{types:e,find:i,categories:ee,source:Array.isArray(r)&&r.length?"remote":"bundled"}}const eD=(r,t)=>r===t.BUSINESS_LEGAL?"Business & legal":r===t.GENERAL?"General documents":r===t.UNREADABLE?"Unreadable / special cases":"Other";function nD({open:r,onClose:t,detectedType:e,onPick:i}){const[a,l]=I.useState(""),[c,u]=I.useState(0),d=I.useRef(null),{types:f,find:m,categories:g,source:v}=F1();I.useEffect(()=>{r&&(l(""),u(0),setTimeout(()=>d.current?.focus(),0))},[r]);const w=I.useMemo(()=>{const R=m(a);return a?R.slice(0,30):f.slice(0,25)},[a,m,f]),_=I.useMemo(()=>{const R=new Map;for(const C of w){const D=C.category;R.has(D)||R.set(D,[]),R.get(D).push(C)}return Array.from(R.entries())},[w]),x=I.useMemo(()=>w,[w]),S=R=>{const C=x[R];C&&i?.(C)},E=R=>{if(R.key==="Escape"){t?.();return}if(R.key==="ArrowDown"){R.preventDefault(),u(C=>Math.min(C+1,x.length-1));return}if(R.key==="ArrowUp"){R.preventDefault(),u(C=>Math.max(C-1,0));return}R.key==="Enter"&&(R.preventDefault(),S(c))};return r?b.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15, 23, 42, 0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2500,padding:16},onClick:()=>t?.(),children:b.jsxs("div",{style:{background:"#fff",borderRadius:14,border:"1px solid #e2e8f0",maxWidth:760,width:"100%",padding:18,boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},onClick:R=>R.stopPropagation(),onKeyDown:E,children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"flex-start"},children:[b.jsxs("div",{children:[b.jsx("div",{style:{fontWeight:900,fontSize:16,color:"#0f172a"},children:"Change document type"}),b.jsx("div",{style:{marginTop:6,color:"#475569",lineHeight:1.4},children:"We use this to decide which actions/checks to show. You can override the AI classification."}),e&&b.jsxs("div",{style:{marginTop:8,color:"#64748b",fontSize:13},children:["Detected: ",b.jsx("strong",{children:e.label})]})]}),b.jsx("button",{type:"button",onClick:()=>t?.(),style:{background:"none",border:"none",fontSize:22,cursor:"pointer",color:"#0f172a",padding:0,lineHeight:1},"aria-label":"Close",children:""})]}),b.jsx("input",{ref:d,value:a,onChange:R=>{l(R.target.value),u(0)},placeholder:"Start typing (e.g. lease, invoice, police letter)",style:{marginTop:14,width:"100%",padding:12,borderRadius:12,border:"1px solid #e2e8f0"}}),b.jsxs("div",{style:{marginTop:14,maxHeight:360,overflow:"auto"},children:[_.map(([R,C])=>b.jsxs("div",{style:{marginBottom:14},children:[b.jsxs("div",{style:{fontWeight:900,color:"#0f172a",fontSize:13,marginBottom:8},children:[eD(R,g),b.jsxs("span",{style:{marginLeft:8,color:"#94a3b8",fontWeight:800},children:["(",v,")"]})]}),b.jsx("div",{style:{display:"grid",gap:8},children:C.map(D=>{const N=x.findIndex(j=>j.id===D.id),L=N===c;return b.jsxs("button",{type:"button",onClick:()=>i?.(D),onMouseEnter:()=>u(N),style:{textAlign:"left",padding:"10px 12px",borderRadius:12,border:"1px solid "+(L?"#0f172a":"#e2e8f0"),background:L?"#f8fafc":"#fff",cursor:"pointer"},children:[b.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:D.label}),b.jsx("div",{style:{color:"#64748b",fontSize:12,marginTop:2},children:D.id})]},D.id)})})]},R)),!_.length&&b.jsx("div",{style:{color:"#64748b"},children:"No matches."})]})]})}):null}function iD(r){const[t,e]=I.useState({status:"idle",spec:null,error:null});return I.useEffect(()=>{if(!r){e({status:"idle",spec:null,error:null});return}let i=!1;return(async()=>{e({status:"loading",spec:null,error:null});try{const l=await fetch(`/classifications/validation/${r}.json`,{cache:"force-cache"});if(!l.ok)throw new Error(`Failed to load validation spec: ${l.status}`);const c=await l.json();i||e({status:"ready",spec:c,error:null})}catch(l){i||e({status:"error",spec:null,error:l})}})(),()=>{i=!0}},[r]),t}const sD="modulepreload",aD=function(r){return"/"+r},Mb={},dp=function(t,e,i){let a=Promise.resolve();if(e&&e.length>0){let d=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");a=d(e.map(f=>{if(f=aD(f),f in Mb)return;Mb[f]=!0;const m=f.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":sD,m||(v.as="script"),v.crossOrigin="",v.href=f,u&&v.setAttribute("nonce",u),document.head.appendChild(v),m)return new Promise((w,_)=>{v.addEventListener("load",w),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return a.then(c=>{for(const u of c||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Ue=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Nf=[.001,0,0,.001,0,0],of=1.35,dn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Di={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Uo="pdfjs_internal_editor_",vt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Rt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},z1={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Mf={TRIANGLES:1,LATTICE:2},xe={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Mo={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},he={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ka={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Zo={ERRORS:0,WARNINGS:1,INFOS:5},hr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},bo={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},H1={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let yu=Zo.WARNINGS;function rD(r){Number.isInteger(r)&&(yu=r)}function oD(){return yu}function bu(r){yu>=Zo.INFOS&&console.info(`Info: ${r}`)}function wt(r){yu>=Zo.WARNINGS&&console.warn(`Warning: ${r}`)}function qt(r){throw new Error(r)}function Nt(r,t){r||qt(t)}function lD(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function fp(r,t=null,e=null){if(!r)return null;if(e&&typeof r=="string"&&(e.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),e.tryConvertEncoding))try{r=fD(r)}catch{}const i=t?URL.parse(r,t):URL.parse(r);return lD(i)?i:null}function pp(r,t,e=!1){const i=URL.parse(r);return i?(i.hash=t,i.href):e&&fp(r,"http://example.com")?r.split("#",1)[0]+`${t?`#${t}`:""}`:""}function yt(r,t,e,i=!1){return Object.defineProperty(r,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const ia=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class kb extends ia{constructor(t,e){super(t,"PasswordException"),this.code=e}}class lf extends ia{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class au extends ia{constructor(t){super(t,"InvalidPDFException")}}class Fo extends ia{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class cD extends ia{constructor(t){super(t,"FormatError")}}class Bi extends ia{constructor(t){super(t,"AbortException")}}function V1(r){(typeof r!="object"||r?.length===void 0)&&qt("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const i=[];for(let a=0;a<t;a+=e){const l=Math.min(a+e,t),c=r.subarray(a,l);i.push(String.fromCharCode.apply(null,c))}return i.join("")}function Jo(r){typeof r!="string"&&qt("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=r.charCodeAt(i)&255;return e}function uD(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function hD(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function dD(){try{return new Function(""),!0}catch{return!1}}class ve{static get isLittleEndian(){return yt(this,"isLittleEndian",hD())}static get isEvalSupported(){return yt(this,"isEvalSupported",dD())}static get isOffscreenCanvasSupported(){return yt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return yt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return yt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return yt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return yt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return yt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const cf=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class nt{static makeHexColor(t,e,i){return`#${cf[t]}${cf[e]}${cf[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const a=t[i],l=t[i+1];t[i]=a*e[0]+l*e[2]+e[4],t[i+1]=a*e[1]+l*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5];for(let m=0;m<6;m+=2){const g=t[i+m],v=t[i+m+1];t[i+m]=g*a+v*c+d,t[i+m+1]=g*l+v*u+f}}static applyInverseTransform(t,e){const i=t[0],a=t[1],l=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-a*e[2]+e[2]*e[5]-e[4]*e[3])/l,t[1]=(-i*e[1]+a*e[0]+e[4]*e[1]-e[5]*e[0])/l}static axialAlignedBoundingBox(t,e,i){const a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5],m=t[0],g=t[1],v=t[2],w=t[3];let _=a*m+d,x=_,S=a*v+d,E=S,R=u*g+f,C=R,D=u*w+f,N=D;if(l!==0||c!==0){const L=l*m,j=l*v,K=c*g,Y=c*w;_+=K,E+=K,S+=Y,x+=Y,R+=L,N+=L,D+=j,C+=j}i[0]=Math.min(i[0],_,S,x,E),i[1]=Math.min(i[1],R,D,C,N),i[2]=Math.max(i[2],_,S,x,E),i[3]=Math.max(i[3],R,D,C,N)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],a=t[1],l=t[2],c=t[3],u=i**2+a**2,d=i*l+a*c,f=l**2+c**2,m=(u+f)/2,g=Math.sqrt(m**2-(u*f-d**2));e[0]=Math.sqrt(m+g||1),e[1]=Math.sqrt(m-g||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>a)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return l>c?null:[i,l,a,c]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,a,l){l[0]=Math.min(l[0],t,i),l[1]=Math.min(l[1],e,a),l[2]=Math.max(l[2],t,i),l[3]=Math.max(l[3],e,a)}static#t(t,e,i,a,l,c,u,d,f,m){if(f<=0||f>=1)return;const g=1-f,v=f*f,w=v*f,_=g*(g*(g*t+3*f*e)+3*v*i)+w*a,x=g*(g*(g*l+3*f*c)+3*v*u)+w*d;m[0]=Math.min(m[0],_),m[1]=Math.min(m[1],x),m[2]=Math.max(m[2],_),m[3]=Math.max(m[3],x)}static#e(t,e,i,a,l,c,u,d,f,m,g,v){if(Math.abs(f)<1e-12){Math.abs(m)>=1e-12&&this.#t(t,e,i,a,l,c,u,d,-g/m,v);return}const w=m**2-4*g*f;if(w<0)return;const _=Math.sqrt(w),x=2*f;this.#t(t,e,i,a,l,c,u,d,(-m+_)/x,v),this.#t(t,e,i,a,l,c,u,d,(-m-_)/x,v)}static bezierBoundingBox(t,e,i,a,l,c,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,i,l,u,e,a,c,d,3*(-t+3*(i-l)+u),6*(t-2*i+l),3*(i-t),f),this.#e(t,i,l,u,e,a,c,d,3*(-e+3*(a-c)+d),6*(e-2*a+c),3*(a-e),f)}}function fD(r){return decodeURIComponent(escape(r))}let uf=null,Lb=null;function G1(r){return uf||(uf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Lb=new Map([["","t"]])),r.replaceAll(uf,(t,e,i)=>e?e.normalize("NFKC"):Lb.get(i))}function mp(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),V1(r)}const Za="pdfjs_internal_id_";function pD(r,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,a,...l]=e;if(!r(i)&&!Number.isInteger(i)||!t(a))return!1;const c=l.length;let u=!0;switch(a.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const d of l)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Pe(r,t,e){return Math.min(Math.max(r,t),e)}function q1(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(V1(r))}function mD(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):Jo(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...t){return new Promise(e=>{e(r(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((t,e)=>t+e,0)});class zo{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function a(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(zo.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&e.push({str:c}),!!l.children)for(const d of l.children)a(d)}return a(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class gp{static setupStorage(t,e,i,a,l){const c=a.getValue(e,{value:null});switch(i.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(c.value===i.attributes.xfaOn?t.setAttribute("checked",!0):c.value===i.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{a.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of i.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;a.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:a,linkService:l}){const{attributes:c}=e,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${a}`);for(const[d,f]of Object.entries(c))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),i&&c.dataId&&this.setupStorage(t,c.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,a=t.xfaHtml,l=t.intent||"display",c=document.createElement(a.name);a.attributes&&this.setAttributes({html:c,element:a,intent:l,linkService:i});const u=l!=="richText",d=t.div;if(d.append(c),t.viewport){const g=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=g}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const g=document.createTextNode(a.value);c.append(g),u&&zo.shouldBuildText(a.name)&&f.push(g)}return{textDivs:f}}const m=[[a,-1,c]];for(;m.length>0;){const[g,v,w]=m.at(-1);if(v+1===g.children.length){m.pop();continue}const _=g.children[++m.at(-1)[1]];if(_===null)continue;const{name:x}=_;if(x==="#text"){const E=document.createTextNode(_.value);f.push(E),w.append(E);continue}const S=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,x):document.createElement(x);if(w.append(S),_.attributes&&this.setAttributes({html:S,element:_,storage:e,intent:l,linkService:i}),_.children?.length>0)m.push([_,-1,S]);else if(_.value){const E=document.createTextNode(_.value);u&&zo.shouldBuildText(x)&&f.push(E),S.append(E)}}for(const g of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Ci="http://www.w3.org/2000/svg";class ta{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function vr(r,t="text"){if(To(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(a.response);return}e(a.responseText);return}i(new Error(a.statusText))}},a.send(null)})}class tl{constructor({viewBox:t,userUnit:e,scale:i,rotation:a,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=a,this.offsetX=l,this.offsetY=c,i*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let m,g,v,w;switch(a%=360,a<0&&(a+=360),a){case 180:m=-1,g=0,v=0,w=1;break;case 90:m=0,g=1,v=1,w=0;break;case 270:m=0,g=-1,v=-1,w=0;break;case 0:m=1,g=0,v=0,w=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,w=-w);let _,x,S,E;m===0?(_=Math.abs(f-t[1])*i+l,x=Math.abs(d-t[0])*i+c,S=(t[3]-t[1])*i,E=(t[2]-t[0])*i):(_=Math.abs(d-t[0])*i+l,x=Math.abs(f-t[1])*i+c,S=(t[2]-t[0])*i,E=(t[3]-t[1])*i),this.transform=[m*i,g*i,v*i,w*i,_-m*i*d-v*i*f,x-g*i*d-w*i*f],this.width=S,this.height=E}get rawDims(){const t=this.viewBox;return yt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:a=this.offsetY,dontFlip:l=!1}={}){return new tl({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:a,dontFlip:l})}convertToViewportPoint(t,e){const i=[t,e];return nt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];nt.applyTransform(e,this.transform);const i=[t[2],t[3]];return nt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return nt.applyInverseTransform(i,this.transform),i}}class vu extends ia{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function el(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function wu(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function $1(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function Y1(r,t="document.pdf"){if(typeof r!="string")return t;if(el(r))return wt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(r);if(!i)return t;const a=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},l=/\.pdf$/i,c=i.pathname.split("/").at(-1);if(l.test(c))return a(c);if(i.searchParams.size>0){const u=Array.from(i.searchParams.values()).reverse();for(const f of u)if(l.test(f))return a(f);const d=Array.from(i.searchParams.keys()).reverse();for(const f of d)if(l.test(f))return a(f)}if(i.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(d)return a(d[0])}return t}class Ob{started=Object.create(null);times=[];time(t){t in this.started&&wt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||wt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:a,end:l}of this.times)t.push(`${i.padEnd(e)} ${l-a}ms
`);return t.join("")}}function To(r,t){const e=t?URL.parse(r,t):URL.parse(r);return e?.protocol==="http:"||e?.protocol==="https:"}function mn(r){r.preventDefault()}function ie(r){r.preventDefault(),r.stopPropagation()}function gD(r){console.log("Deprecated API usage: "+r)}class ru{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let a=parseInt(e[2],10);a=a>=1&&a<=12?a-1:0;let l=parseInt(e[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(e[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let m=parseInt(e[8],10);m=m>=0&&m<=23?m:0;let g=parseInt(e[9],10)||0;return g=g>=0&&g<=59?g:0,f==="-"?(c+=m,u+=g):f==="+"&&(c-=m,u-=g),new Date(Date.UTC(i,a,l,c,u,d))}}function X1(r,{scale:t=1,rotation:e=0}){const{width:i,height:a}=r.attributes.style,l=[0,0,parseInt(i),parseInt(a)];return new tl({viewBox:l,userUnit:1,scale:t,rotation:e})}function wr(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(wt(`Not a valid color format: "${r}"`),[0,0,0])}function yD(r){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of r.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;r.set(e,wr(i))}t.remove()}function ne(r){const{a:t,b:e,c:i,d:a,e:l,f:c}=r.getTransform();return[t,e,i,a,l,c]}function Jn(r){const{a:t,b:e,c:i,d:a,e:l,f:c}=r.getTransform().invertSelf();return[t,e,i,a,l,c]}function Es(r,t,e=!1,i=!0){if(t instanceof tl){const{pageWidth:a,pageHeight:l}=t.rawDims,{style:c}=r,u=ve.isCSSRoundSupported,d=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${l}px`,m=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,g=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(c.width=m,c.height=g):(c.width=g,c.height=m)}i&&r.setAttribute("data-main-rotation",t.rotation)}class Hn{constructor(){const{pixelRatio:t}=Hn;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,a,l=-1){let c=1/0,u=1/0,d=1/0;i=Hn.capPixels(i,l),i>0&&(c=Math.sqrt(i/(t*e))),a!==-1&&(u=a/t,d=a/e);const f=Math.min(c,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const ou=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class bD{static get isDarkMode(){return yt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class W1{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),yt(this,"commentForegroundColor",wr(i))}}function K1(r,t,e,i){i=Math.min(Math.max(i??1,0),1);const a=255*(1-i);return r=Math.round(r*i+a),t=Math.round(t*i+a),e=Math.round(e*i+a),[r,t,e]}function Ib(r,t){const e=r[0]/255,i=r[1]/255,a=r[2]/255,l=Math.max(e,i,a),c=Math.min(e,i,a),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const d=l-c;switch(t[1]=u<.5?d/(l+c):d/(2-l-c),l){case e:t[0]=((i-a)/d+(i<a?6:0))*60;break;case i:t[0]=((a-e)/d+2)*60;break;case a:t[0]=((e-i)/d+4)*60;break}}t[2]=u}function kf(r,t){const e=r[0],i=r[1],a=r[2],l=(1-Math.abs(2*a-1))*i,c=l*(1-Math.abs(e/60%2-1)),u=a-l/2;switch(Math.floor(e/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function Pb(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function jb(r,t,e){kf(r,e),e.map(Pb);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];kf(t,e),e.map(Pb);const a=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>a?(i+.05)/(a+.05):(a+.05)/(i+.05)}const Bb=new Map;function Q1(r,t){const e=r[0]+r[1]*256+r[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=Bb.get(e);if(i)return i;const a=new Float32Array(9),l=a.subarray(0,3),c=a.subarray(3,6);Ib(r,c);const u=a.subarray(6,9);Ib(t,u);const d=u[2]<.5,f=d?12:4.5;if(c[2]=d?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),jb(c,u,l)<f){let m,g;d?(m=c[2],g=1):(m=0,g=c[2]);const v=.005;for(;g-m>v;){const w=c[2]=(m+g)/2;d===jb(c,u,l)<f?m=w:g=w}c[2]=d?g:m}return kf(c,l),i=nt.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),Bb.set(e,i),i}function yp({html:r,dir:t,className:e},i){const a=document.createDocumentFragment();if(typeof r=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=r.split(/(?:\r\n?|\n)/);for(let u=0,d=c.length;u<d;++u){const f=c[u];l.append(document.createTextNode(f)),u<d-1&&l.append(document.createElement("br"))}a.append(l)}else gp.render({xfaHtml:r,div:a,intent:"richText"});a.firstElementChild.classList.add("richText",e),i.append(a)}function Z1(r){const t=new Path2D;if(!r)return t;for(let e=0,i=r.length;e<i;)switch(r[e++]){case bo.moveTo:t.moveTo(r[e++],r[e++]);break;case bo.lineTo:t.lineTo(r[e++],r[e++]);break;case bo.curveTo:t.bezierCurveTo(r[e++],r[e++],r[e++],r[e++],r[e++],r[e++]);break;case bo.quadraticCurveTo:t.quadraticCurveTo(r[e++],r[e++],r[e++],r[e++]);break;case bo.closePath:t.closePath();break;default:wt(`Unrecognized drawing path operator: ${r[e-1]}`);break}return t}class ko{#t=null;#e=null;#i;#n=null;#r=null;#a=null;#s=null;#o=null;static#c=null;constructor(t){this.#i=t,ko.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",mn,{signal:e}),t.addEventListener("pointerdown",ko.#l,{signal:e}));const i=this.#n=document.createElement("div");i.className="buttons",t.append(i);const a=this.#i.toolbarPosition;if(a){const{style:l}=t,c=this.#i._uiManager.direction==="ltr"?1-a[0]:a[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,ie(t)}#h(t){this.#i._focusEventsAllowed=!0,ie(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",mn,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",ko.#c[t]),this.#f(i)&&i.addEventListener("click",a=>{e.delete()},{signal:e._signal}),this.#n.append(i)}get#g(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#g),this.#r=t}addComment(t,e=null){if(this.#a)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const a=this.#s=this.#g;e?(this.#n.insertBefore(i,e),this.#n.insertBefore(a,e)):this.#n.append(i,a),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#g)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#g)}removeButton(t){t==="comment"&&(this.#a?.removeToolbarCommentButton(),this.#a=null,this.#s?.remove(),this.#s=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,i){if(!e&&t==="comment")return;const a=this.#n.querySelector(i);a&&t==="comment"&&this.addComment(e,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class vD{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",mn,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#i.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#r(t,e){let i=0,a=0;for(const l of t){const c=l.y+l.height;if(c<i)continue;const u=l.x+(e?l.width:0);if(c>i){a=u,i=c;continue}e?u>a&&(a=u):u<a&&(a=u)}return[e?1-a:a,i]}show(t,e,i){const[a,l]=this.#r(e,i),{style:c}=this.#e||=this.#n();t.append(this.#e),c.insetInlineEnd=`${100*a}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,e,i,a){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",e);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",i);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",mn,{signal:u}),l.addEventListener("click",a,{signal:u})),this.#t.append(l)}}function J1(r,t,e){for(const i of e)t.addEventListener(i,r[i].bind(r))}class It{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(It.#e||=new Set).add(t)}static setPointer(t,e){It.#t||=e,It.#n??=t}static setTimeStamp(t){It.#i=t}static isSamePointerId(t){return It.#t===t}static isSamePointerIdOrRemove(t){return It.#t===t?!0:(It.#e?.delete(t),!1)}static isSamePointerType(t){return It.#n===t}static isInitializedAndDifferentPointerType(t){return It.#n!==null&&!It.isSamePointerType(t)}static isSameTimeStamp(t){return It.#i===t}static isUsingMultiplePointers(){return It.#e?.size>=1}static clearPointerType(){It.#n=null}static clearPointerIds(){It.#t=NaN,It.#e=null}static clearTimeStamp(){It.#i=NaN}}class wD{#t=0;get id(){return`${Uo}${this.#t++}`}}class bp{#t=mp();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const l=a.decode().then(()=>(i.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return yt(this,"_isSVGFittingCanvas",l)}async#n(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof e=="string"?(i.url=e,a=await vr(e,"blob")):e instanceof File?a=i.file=e:e instanceof Blob&&(a=e),a.type==="image/svg+xml"){const l=bp._isSVGFittingCanvas,c=new FileReader,u=new Image,d=new Promise((f,m)=>{u.onload=()=>{i.bitmap=u,i.isSvg=!0,f()},c.onload=async()=>{const g=i.svgUrl=c.result;u.src=await l?`${g}#svgView(preserveAspectRatio(none))`:g},u.onerror=c.onerror=m});c.readAsDataURL(a),await d}else i.bitmap=await createImageBitmap(a);i.refCounter=1}catch(a){wt(a),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:a,type:l}=t;return this.#n(`${e}_${i}_${a}_${l}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const i=await e;return this.#n(t,i)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i?.bitmap)return i.refCounter+=1,i;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),i={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,i),this.#i.set(i.id,i),i}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const a=new OffscreenCanvas(i.width,i.height);a.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=a.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class xD{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:a,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const d={cmd:t,undo:e,post:i,type:l};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(d);return}if(c&&this.#t[this.#n].type===l){u&&(d.undo=this.#t[this.#n].undo),this.#t[this.#n]=d;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class nl{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=ve.platform;for(const[i,a,l={}]of t)for(const c of i){const u=c.startsWith("mac+");e&&u?(this.callbacks.set(c.slice(4),{callback:a,options:l}),this.allKeys.add(c.split("+").at(-1))):!e&&!u&&(this.callbacks.set(c,{callback:a,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:a,options:{bubbles:l=!1,args:c=[],checker:u=null}}=i;u&&!u(t,e)||(a.bind(t,...c,e)(),l||ie(e))}}class vp{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return yD(t),yt(this,"_colors",t)}convert(t){const e=wr(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,a]of this._colors)if(a.every((l,c)=>l===e[c]))return vp._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?nt.makeHexColor(...e):t}}class Ui{#t=new AbortController;#e=null;#i=null;#n=new Map;#r=new Map;#a=null;#s=null;#o=null;#c=new xD;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#S=null;#x=null;#C=null;#w=!1;#_=null;#N=new wD;#R=!1;#D=!1;#j=!1;#k=null;#O=null;#B=null;#I=null;#G=null;#T=vt.NONE;#A=new Set;#L=null;#U=null;#z=null;#Y=null;#$=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#P=null;#q=null;#Z=null;#J=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Ui.prototype,e=c=>c.#q.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),i=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},a=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return yt(this,"_keyboardManager",new nl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#q.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#q.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:e}]]))}constructor(t,e,i,a,l,c,u,d,f,m,g,v,w,_,x,S){const E=this._signal=this.#t.signal;this.#q=t,this.#Z=e,this.#J=i,this.#a=a,this.#l=l,this.#U=c,this.#$=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:E}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),u._on("setpreference",this.onSetPreference.bind(this),{signal:E}),u._on("switchannotationeditorparams",R=>this.updateParams(R.type,R.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:E}),this.#rt(),this.#dt(),this.#et(),this.#s=d.annotationStorage,this.#E=d.filterFactory,this.#z=f,this.#C=m||null,this.#y=g,this.#v=v,this.#b=w,this.#G=_||null,this.viewParameters={realScale:ta.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=S!==!1,l?.setSidebarUiManager(this)}destroy(){this.#F?.resolve(),this.#F=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#n.clear(),this.#p.clear(),this.#I?.clear(),this.#e=null,this.#A.clear(),this.#c.destroy(),this.#a?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#_?.hide(),this.#_=null,this.#B?.destroy(),this.#B=null,this.#i=null,this.#S&&(clearTimeout(this.#S),this.#S=null),this.#P&&(clearTimeout(this.#P),this.#P=null),this._editorUndoBar?.destroy(),this.#$=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return yt(this,"hcmFilter",this.#z?this.#E.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return yt(this,"direction",getComputedStyle(this.#q).direction)}get _highlightColors(){return yt(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return yt(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[a,l]of t){const c=a.endsWith("_HCM");if(i&&c){e.set(a.replace("_HCM",""),l);continue}!i&&!c&&e.set(a,l)}return yt(this,"highlightColors",e)}get highlightColorNames(){return yt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#B=t}editAltText(t,e=!1){this.#a?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,a){this.#l?.showDialog(this,t,e,i,a)}selectComment(t,e){this.#r.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),a=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",a),e())};this._eventBus.on("editorsrendered",a),await i}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=e)}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#q.focus()}findParent(t,e){for(const i of this.#r.values()){const{x:a,y:l,width:c,height:u}=i.div.getBoundingClientRect();if(t>=a&&t<=a+c&&e>=l&&e<=l+u)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ta.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#r.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:a,anchorOffset:l,focusNode:c,focusOffset:u}=i,d=i.toString(),m=this.#Q(i).closest(".textLayer"),g=this.getSelectionBoxes(m);if(!g)return;i.empty();const v=this.#tt(m),w=this.#T===vt.NONE,_=()=>{const x=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:g,anchorNode:a,anchorOffset:l,focusNode:c,focusOffset:u,text:d});w&&this.showAllEditors("highlight",!0,!0),e&&x?.editComment()};if(w){this.switchToMode(vt.HIGHLIGHT,_);return}_()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#Q(t).closest(".textLayer"),a=this.getSelectionBoxes(i);a&&(this.#_||=new vD(this),this.#_.show(i,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const e=`${Uo}${t}`,i=this.#s.getRawValue(e);return i&&this.#s.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#L&&(this.#_?.hide(),this.#L=null,this.#M({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#L)return;const a=this.#Q(t).closest(".textLayer");if(!a){this.#L&&(this.#_?.hide(),this.#L=null,this.#M({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#L=e,this.#M({hasSelectedText:!0}),!(this.#T!==vt.HIGHLIGHT&&this.#T!==vt.NONE)&&(this.#T===vt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#w=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===vt.HIGHLIGHT?this.#tt(a):null;if(l?.toggleDrawing(),this.#D){const c=new AbortController,u=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else l?.toggleDrawing(!0),this.#W("main_toolbar")}}#W(t=""){this.#T===vt.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#x)return;this.#x=new AbortController;const t=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#w&&(this.#w=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#A)if(e.div.contains(t)){this.#O=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#O)return;const[t,e]=this.#O;this.#O=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#k?.abort(),this.#k=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#A){const a=i.serialize(!0);a&&e.push(a)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const l of e.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(l){wt(`paste: "${l.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const a=this.currentLayer;try{const l=[];for(const d of i){const f=await a.deserialize(d);if(!f)return;l.push(f)}const c=()=>{for(const d of l)this.#nt(d);this.#it(l)},u=()=>{for(const d of l)d.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){wt(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==vt.NONE&&!this.isEditorHandlingKeyboard&&Ui._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#w&&(this.#w=!1,this.#W("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#M(t){Object.entries(t).some(([i,a])=>this.#X[i]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#T===vt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#V([[Rt.HIGHLIGHT_FREE,!0]]))}#V(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#M({isEditing:this.#T!==vt.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#M({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#V(e.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,a=!1,l=!1,c=!1){if(this.#T!==t&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===vt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===vt.NONE){this.setEditingState(!1),this.#pt();for(const u of this.#n.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#F.resolve();return}for(const u of this.#n.values())u.addStandaloneCommentButton();t===vt.SIGNATURE&&await this.#U?.loadSignatures(),i&&It.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#r.values())u.updateMode(t);if(t===vt.POPUP){this.#i||=await this.#$.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,d=[];for(const f of this.#n.values()){const{annotationElementId:m,hasComment:g,deleted:v}=f;m&&u.add(m),g&&!v&&d.push(f.getData())}for(const f of this.#i){const{id:m,popupRef:g,contentsObj:v}=f;g&&v?.str&&!u.has(m)&&!this.#g.has(m)&&d.push(f)}this.#l?.showSidebar(d)}if(!e){a&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const u of this.#n.values())u.uid===e?(this.setSelected(u),c?u.editComment():l?u.enterInEditMode():u.focus()):u.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case Rt.CREATE:this.currentLayer.addNewEditor(e);return;case Rt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#A)i.updateParams(t,e);else for(const i of this.#u)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const l of this.#n.values())l.editorType===t&&l.show(e);(this.#Y?.get(Rt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#V([[Rt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#j!==t){this.#j=t;for(const e of this.#r.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#r.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#r.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#S&&clearTimeout(this.#S),this.#S=setTimeout(()=>{this.focusMainContainer(),this.#S=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#I?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#r.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#V(t.propertiesToUpdate))}get#mt(){let t=null;for(t of this.#A);return t}updateUI(t){this.#mt===t&&this.#V(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#V(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#A.has(t)){this.#A.delete(t),t.unselect(),this.#M({hasSelectedEditor:this.hasSelection});return}this.#A.add(t),t.select(),this.#V(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#A)e!==t&&e.unselect();this.#A.clear(),this.#A.add(t),t.select(),this.#V(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}isSelected(t){return this.#A.has(t)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(t){t.unselect(),this.#A.delete(t),this.#M({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#M({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(t){this.#c.add(t),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(t){this.#c.cleanType(t)}#K(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#A],i=()=>{this._editorUndoBar?.show(a,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},a=()=>{for(const l of e)this.#nt(l)};this.addCommands({cmd:i,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#A)e.unselect();this.#A.clear();for(const e of t)e.isEmpty()||(this.#A.add(e),e.select());this.#M({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#A)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==vt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#A)t.unselect();this.#A.clear(),this.#M({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[a,l]=this.#H,c=[...this.#A],u=1e3;this.#P&&clearTimeout(this.#P),this.#P=setTimeout(()=>{this.#P=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(a,l),d.translationDone())},undo:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(-a,-l),d.translationDone())},mustExec:!1})},u);for(const d of c)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const t of this.#A)this.#m.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const t=this.#m;this.#m=null;let e=!1;for(const[{x:a,y:l,pageIndex:c},u]of t)u.newX=a,u.newY=l,u.newPageIndex=c,e||=a!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!e)return!1;const i=(a,l,c,u)=>{if(this.#n.has(a.id)){const d=this.#r.get(u);d?a._setParentAndPosition(d,l,c):(a.pageIndex=u,a.x=l,a.y=c)}};return this.addCommands({cmd:()=>{for(const[a,{newX:l,newY:c,newPageIndex:u}]of t)i(a,l,c,u)},undo:()=>{for(const[a,{savedX:l,savedY:c,savedPageIndex:u}]of t)i(a,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#m)for(const i of this.#m.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==vt.NONE}get imageManager(){return yt(this,"imageManager",new bp)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,m=e.rangeCount;f<m;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:a,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,m,g,v)=>({x:(m-a)/c,y:1-(f+g-i)/l,width:v/c,height:g/l});break;case"180":u=(f,m,g,v)=>({x:1-(f+g-i)/l,y:1-(m+v-a)/c,width:g/l,height:v/c});break;case"270":u=(f,m,g,v)=>({x:1-(m+v-a)/c,y:(f-i)/l,width:v/c,height:g/l});break;default:u=(f,m,g,v)=>({x:(f-i)/l,y:(m-a)/c,width:g/l,height:v/c});break}const d=[];for(let f=0,m=e.rangeCount;f<m;f++){const g=e.getRangeAt(f);if(!g.collapsed)for(const{x:v,y:w,width:_,height:x}of g.getClientRects())_===0||x===0||d.push(u(v,w,_,x))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#s.getRawValue(e);i&&(this.#T===vt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const a=this.#I?.get(t);a&&(a.setCanvas(e,i),this.#I.delete(t))}addMissingCanvas(t,e){(this.#I||=new Map).set(t,e)}}class ni{#t=null;#e=!1;#i=null;#n=null;#r=null;#a=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,ni.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){ni._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",ni.#f.missing),e.setAttribute("data-l10n-id",ni.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",mn,{signal:i}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const a=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",a,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#s=!0,a(l))},{signal:i}),await this.#m(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await ni._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#m())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:a,cancel:l=!1}){i&&(this.#l=i,this.#d=a),!(this.#t===t&&this.#e===e)&&(l||(this.#t=t,this.#e=e),this.#m())}toggle(t=!1){this.#i&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#r=null,this.#o?.remove(),this.#o=null}async#m(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",ni.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",ni.#f[`${this.#g}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#r;if(!e){this.#r=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const a=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:l})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Dc{#t=null;#e=null;#i=!1;#n=null;#r=null;#a=null;#s=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const a=this.#n.commentButtonColor;a&&(i.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=this.#n.parent.boundingClientRect;return[(t-a)/c,(e+i-l)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=this.#n._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",mn,{signal:i}),e&&(t.addEventListener("focusin",l=>{this.#n._focusEventsAllowed=!1,ie(l)},{capture:!0,signal:i}),t.addEventListener("focusout",l=>{this.#n._focusEventsAllowed=!0,ie(l)},{capture:!0,signal:i})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const a=l=>{l.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#i=!0,a(l))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,a;if(e)[i,a]=e;else{[i,a]=this.#n.commentButtonPosition;const{width:m,height:g,x:v,y:w}=this.#n;i=v+i*m,a=w+a*g}const l=this.#n.parent.boundingClientRect,{x:c,y:u,width:d,height:f}=l;this.#n._uiManager.editComment(this.#n,c+i*d,u+a*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#r}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#a,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#a=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#r=t,this.data=t,this.#o=null,this.#a=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#a=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class il{#t;#e=!1;#i=null;#n;#r;#a;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:a=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#i=i,this.#n=e,this.#r=a,this.#a=l,this.#s=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Hn.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,l=AbortSignal.any([this.#c,a.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ie(f),d(f))},u),c.addEventListener("pointerup",d,u),c.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:a,capture:!1,passive:!1};l.addEventListener("touchmove",this.#g.bind(this),c);const u=this.#m.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",ie,c),l.addEventListener("pointermove",ie,c),l.addEventListener("pointercancel",ie,c),l.addEventListener("pointerup",ie,c),this.#r?.()}if(ie(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#g(t){if(!this.#l||t.touches.length!==2)return;ie(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:a,screenY:l}=e,{screenX:c,screenY:u}=i,d=this.#l,{touch0X:f,touch0Y:m,touch1X:g,touch1Y:v}=d,w=g-f,_=v-m,x=c-a,S=u-l,E=Math.hypot(x,S)||1,R=Math.hypot(w,_)||1;if(!this.#e&&Math.abs(R-E)<=il.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=a,d.touch0Y=l,d.touch1X=c,d.touch1Y=u,!this.#e){this.#e=!0;return}const C=[(a+c)/2,(l+u)/2];this.#a?.(C,R,E)}#m(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(ie(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class ct{#t=null;#e=null;#i=null;#n=null;#r=null;#a=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#E=0;#S=0;#x=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#w=!1;#_=ct._zIndex++;static _borderLineWidth=-1;static _colorManager=new vp;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=ct.prototype._resizeWithKeyboard,e=Ui.TRANSLATE_SMALL,i=Ui.TRANSLATE_BIG;return yt(this,"_resizerKeyboardManager",new nl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],ct.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,a],this.pageTranslation=[l,c];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return yt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new AD({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(ct._l10n??=t,ct._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ct._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);ct._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){qt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#w}set _isDraggable(t){this.#w=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#P(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,a){const[l,c]=this.parentDimensions;[i,a]=this.screenToPageTranslation(i,a),this.x=(t+i)/l,this.y=(e+a)/c,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,a]=this.parentDimensions;this.setAt(t*i,e*a,this.width*i,this.height*a),this._onTranslated()}#N([t,e],i,a){[i,a]=this.screenToPageTranslation(i,a),this.x+=i/t,this.y+=a/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#N(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#N(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[a,l]}=this;if(this.x+=t/a,this.y+=e/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[d,f]=this.getBaseTranslation();c+=d,u+=f;const{style:m}=i;m.left=`${(100*c).toFixed(2)}%`,m.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=ct,a=i/t,l=i/e;switch(this.rotation){case 90:return[-a,l];case 180:return[a,l];case 270:return[a,-l];default:return[-a,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,a]}=this;let{x:l,y:c,width:u,height:d}=this;if(u*=i,d*=a,l*=i,c*=a,this._mustFixPosition)switch(t){case 0:l=Pe(l,0,i-u),c=Pe(c,0,a-d);break;case 90:l=Pe(l,0,i-d),c=Pe(c,u,a);break;case 180:l=Pe(l,u,i),c=Pe(c,d,a);break;case 270:l=Pe(l,d,i),c=Pe(c,0,a-u);break}this.x=l/=i,this.y=c/=a;const[f,m]=this.getBaseTranslation();l+=f,c+=m,e.left=`${(100*l).toFixed(2)}%`,e.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return ct.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return ct.#R(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#j(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",i),a.setAttribute("data-resizer-name",i),a.addEventListener("pointerdown",this.#k.bind(this,i),{signal:e}),a.addEventListener("contextmenu",mn,{signal:e}),a.tabIndex=-1}this.div.prepend(this.#c)}#k(t,e){e.preventDefault();const{isMac:i}=ve.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#i?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#I.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",ie,{passive:!1,signal:c}),window.addEventListener("contextmenu",mn,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#B()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#O(t,e,i,a){this.width=i,this.height=a,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:a}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,d=this.height;l===t&&c===e&&u===i&&d===a||this.addCommands({cmd:this.#O.bind(this,l,c,u,d),undo:this.#O.bind(this,t,e,i,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#I(t,e){const[i,a]=this.parentDimensions,l=this.x,c=this.y,u=this.width,d=this.height,f=ct.MIN_SIZE/i,m=ct.MIN_SIZE/a,g=this.#D(this.rotation),v=(P,q)=>[g[0]*P+g[2]*q,g[1]*P+g[3]*q],w=this.#D(360-this.rotation),_=(P,q)=>[w[0]*P+w[2]*q,w[1]*P+w[3]*q];let x,S,E=!1,R=!1;switch(t){case"topLeft":E=!0,x=(P,q)=>[0,0],S=(P,q)=>[P,q];break;case"topMiddle":x=(P,q)=>[P/2,0],S=(P,q)=>[P/2,q];break;case"topRight":E=!0,x=(P,q)=>[P,0],S=(P,q)=>[0,q];break;case"middleRight":R=!0,x=(P,q)=>[P,q/2],S=(P,q)=>[0,q/2];break;case"bottomRight":E=!0,x=(P,q)=>[P,q],S=(P,q)=>[0,0];break;case"bottomMiddle":x=(P,q)=>[P/2,q],S=(P,q)=>[P/2,0];break;case"bottomLeft":E=!0,x=(P,q)=>[0,q],S=(P,q)=>[P,0];break;case"middleLeft":R=!0,x=(P,q)=>[0,q/2],S=(P,q)=>[P,q/2];break}const C=x(u,d),D=S(u,d);let N=v(...D);const L=ct._round(l+N[0]),j=ct._round(c+N[1]);let K=1,Y=1,$,H;if(e.fromKeyboard)({deltaX:$,deltaY:H}=e);else{const{screenX:P,screenY:q}=e,[tt,mt]=this.#l;[$,H]=this.screenToPageTranslation(P-tt,q-mt),this.#l[0]=P,this.#l[1]=q}if([$,H]=_($/i,H/a),E){const P=Math.hypot(u,d);K=Y=Math.max(Math.min(Math.hypot(D[0]-C[0]-$,D[1]-C[1]-H)/P,1/u,1/d),f/u,m/d)}else R?K=Pe(Math.abs(D[0]-C[0]-$),f,1)/u:Y=Pe(Math.abs(D[1]-C[1]-H),m,1)/d;const J=ct._round(u*K),at=ct._round(d*Y);N=v(...S(J,at));const rt=L-N[0],pt=j-N[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=J,this.height=at,this.x=rt,this.y=pt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new ko(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(ni.initialize(ct._l10n),this.#i=new ni(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new Dc(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#n.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:i,deleted:a}}=this.#n;return{text:e,richText:t,date:i,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new Dc(this),this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#n||=new Dc(this),this.#n.setInitialText(t,i),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new Dc(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,d=a-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[a,l]=this.getInitialTranslation();return this.translate(a,l),J1(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new il({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#A.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,e,i){let l=.7*(i/e)+1-.7;if(l===1)return;const c=this.#D(this.rotation),u=(L,j)=>[c[0]*L+c[2]*j,c[1]*L+c[3]*j],[d,f]=this.parentDimensions,m=this.x,g=this.y,v=this.width,w=this.height,_=ct.MIN_SIZE/d,x=ct.MIN_SIZE/f;l=Math.max(Math.min(l,1/v,1/w),_/v,x/w);const S=ct._round(v*l),E=ct._round(w*l);if(S===v&&E===w)return;this.#u||=[m,g,v,w];const R=u(v/2,w/2),C=ct._round(m+R[0]),D=ct._round(g+R[1]),N=u(S/2,E/2);this.x=C-N[0],this.y=D-N[1],this.width=S,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#A(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(t){const{isMac:e}=ve.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#U(t);return}this.#L(t)}#L(t){const{isMac:e}=ve.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const a=new AbortController,l=this._uiManager.combinedSignal(a),c={capture:!0,passive:!1,signal:l},u=f=>{a.abort(),this.#s=null,this.#m=!1,this._uiManager.endDragSession()||this.#L(f),i&&this._onStopDragging()};e&&(this.#E=t.clientX,this.#S=t.clientY,this.#s=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:m,clientY:g,pointerId:v}=f;if(v!==this.#s){ie(f);return}const[w,_]=this.screenToPageTranslation(m-this.#E,g-this.#S);this.#E=m,this.#S=g,this._uiManager.dragSelectedEditors(w,_)},c),window.addEventListener("touchmove",ie,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),ie(f)},c));const d=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}ie(f)};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const a=this.parentScale,[l,c]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/a,m=e/a,g=this.x*l,v=this.y*c,w=this.width*l,_=this.height*c;switch(i){case 0:return[g+f+u,c-v-m-_+d,g+f+w+u,c-v-m+d];case 90:return[g+m+u,c-v+f+d,g+m+_+u,c-v+f+w+d];case 180:return[g-f-w+u,c-v+m+d,g-f+u,c-v+m+_+d];case 270:return[g-m-_+u,c-v-f-w+d,g-m+u,c-v-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,a,l,c]=t,u=l-i,d=c-a;switch(this.rotation){case 0:return[i,e-c,u,d];case 90:return[i,e-a,d,u];case 180:return[l,e-a,u,d];case 270:return[l,e-c,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:a,deleted:l,richText:c},uid:u,pageIndex:d,creationDate:f,modificationDate:m}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:i||m,popupRef:!l,color:e,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:a}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return e<c&&a>0&&t<l&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const a=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[l,c]=a.pageDimensions,[u,d,f,m]=a.getRectInCurrentCoords(t.rect,c);return a.x=u/l,a.y=d/c,a.width=f/l,a.height=m/c,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#P(),this.removeEditToolbar(),this.#x){for(const t of this.#x.values())clearTimeout(t);this.#x=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,a,l,c]=this.getPDFRect();return[ct._round(i+(l-i)*t),ct._round(a+(c-a)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const c=this.#Y.bind(this),u=this.#$.bind(this),d=this._uiManager._signal;for(const f of this.#e){const m=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#X.bind(this,m),{signal:d}),f.setAttribute("data-l10n-id",ct._l10nResizer[m])}}const i=this.#e[0];let a=0;for(const c of e){if(c===i)break;a++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==a){if(l<a)for(let u=0;u<a-l;u++)this.#c.append(this.#c.firstElementChild);else if(l>a)for(let u=0;u<l-a;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of e){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ct._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){ct._resizerKeyboardManager.exec(this,t)}#$(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#P()}#X(t){this.#g=this.#v?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#v&&this.#I(this.#g,{deltaX:t,deltaY:e,fromKeyboard:!0})}#P(){this.#v=!1,this.#H(-1),this.#B()}_stopResizingWithKeyboard(){this.#P(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#x||=new Map;const{action:i}=t;let a=this.#x.get(i);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#x.delete(i),this.#x.size===0&&(this.#x=null)},ct._telemetryTimeout),this.#x.set(i,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class AD extends ct{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ub=3285377520,Dn=4294901760,ti=65535;class tw{constructor(t){this.h1=t?t&4294967295:Ub,this.h2=t?t&4294967295:Ub}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let x=0,S=t.length;x<S;x++){const E=t.charCodeAt(x);E<=255?e[i++]=E:(e[i++]=E>>>8,e[i++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=i>>2,l=i-a*4,c=new Uint32Array(e.buffer,0,a);let u=0,d=0,f=this.h1,m=this.h2;const g=3432918353,v=461845907,w=g&ti,_=v&ti;for(let x=0;x<a;x++)x&1?(u=c[x],u=u*g&Dn|u*w&ti,u=u<<15|u>>>17,u=u*v&Dn|u*_&ti,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=c[x],d=d*g&Dn|d*w&ti,d=d<<15|d>>>17,d=d*v&Dn|d*_&ti,m^=d,m=m<<13|m>>>19,m=m*5+3864292196);switch(u=0,l){case 3:u^=e[a*4+2]<<16;case 2:u^=e[a*4+1]<<8;case 1:u^=e[a*4],u=u*g&Dn|u*w&ti,u=u<<15|u>>>17,u=u*v&Dn|u*_&ti,a&1?f^=u:m^=u}this.h1=f,this.h2=m}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Dn|t*36045&ti,e=e*4283543511&Dn|((e<<16|t>>>16)*2950163797&Dn)>>>16,t^=e>>>1,t=t*444984403&Dn|t*60499&ti,e=e*3301882366&Dn|((e<<16|t>>>16)*3120437893&Dn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Lf=Object.freeze({map:null,hash:"",transfer:void 0});class wp{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#n.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof ct&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#n.values())if(i instanceof ct)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#n.get(t);let a=!1;if(i!==void 0)for(const[l,c]of Object.entries(e))i[l]!==c&&(a=!0,i[l]=c);else a=!0,this.#n.set(t,e);a&&this.#r(),e instanceof ct&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ew(this)}get serializable(){if(this.#n.size===0)return Lf;const t=new Map,e=new tw,i=[],a=Object.create(null);let l=!1;for(const[c,u]of this.#n){const d=u instanceof ct?u.serialize(!1,a):u;d&&(t.set(c,d),e.update(`${c}:${JSON.stringify(d)}`),l||=!!d.bitmap)}if(l)for(const c of t.values())c.bitmap&&i.push(c.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:Lf}get editorStats(){let t=null;const e=new Map;let i=0,a=0;for(const l of this.#n.values()){if(!(l instanceof ct)){l.popup&&(l.popup.deleted?a+=1:i+=1);continue}l.isCommentDeleted?a+=1:l.hasEditedComment&&(i+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;e.has(u)||e.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,m]of Object.entries(c)){if(f==="type")continue;let g=d.get(f);g||(g=new Map,d.set(f,g));const v=g.get(m)??0;g.set(m,v+1)}}if((a>0||i>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:i}),!t)return null;for(const[l,c]of e)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#i?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class ew extends wp{#t;constructor(t){super();const{map:e,hash:i,transfer:a}=t.serializable,l=structuredClone(e,a?{transfer:a}:null);this.#t={map:l,hash:i,transfer:a}}get print(){qt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return yt(this,"modifiedIds",{ids:new Set,hash:""})}}class SD{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Nt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:l,style:c}=t,u=new FontFace(a,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),i?.(t)}catch{wt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}qt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(a){throw wt(`Failed to load font '${i.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const a=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return yt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return yt(this,"isSyncFontLoadingSupported",Ue||ve.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Nt(!a.done,"completeRequest() cannot be called twice."),a.done=!0;i.length>0&&i[0].done;){const l=i.shift();setTimeout(l.callback,0)}}const{loadingRequests:i}=this,a={done:!1,complete:e,callback:t};return i.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return yt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(D,N){return D.charCodeAt(N)<<24|D.charCodeAt(N+1)<<16|D.charCodeAt(N+2)<<8|D.charCodeAt(N+3)&255}function a(D,N,L,j){const K=D.substring(0,N),Y=D.substring(N+L);return K+j+Y}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function m(D,N){if(++f>30){wt("Load test font never loaded."),N();return}if(d.font="30px "+D,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){N();return}setTimeout(m.bind(null,D,N))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=a(v,976,g.length,g);const _=16,x=1482184792;let S=i(v,_);for(l=0,c=g.length-3;l<c;l+=4)S=S-x+i(g,l)|0;l<g.length&&(S=S-x+i(g+"XXX",l)|0),v=a(v,_,4,uD(S));const E=`url(data:font/opentype;base64,${btoa(v)});`,R=`@font-face {font-family:"${g}";src:${E}}`;this.insertRule(R);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const D of[t.loadedName,g]){const N=this._document.createElement("span");N.textContent="Hi",N.style.fontFamily=D,C.append(N)}this._document.body.append(C),m(g,()=>{C.remove(),e.complete()})}}class _D{#t;constructor(t,e=null,i,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${q1(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let a;try{a=t.get(i)}catch(c){wt(`getPathGenerator - ignoring character: "${c}".`)}const l=Z1(a?.path);return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){yt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){yt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class sr{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let a=0;for(const f of sr.strings){const m=e.encode(t[f]);i[f]=m,a+=4+m.length}const l=new ArrayBuffer(a),c=new Uint8Array(l),u=new DataView(l);let d=0;for(const f of sr.strings){const m=i[f],g=m.length;u.setUint32(d,g),c.set(m,d+4),d+=4+g}return Nt(d===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Nt(t<sr.strings.length,"Invalid string index");let e=0;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class ar{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let a=0;for(const v of ar.strings){const w=e.encode(t[v]);i[v]=w,a+=4+w.length}a+=4;let l,c,u=1+a;t.style&&(l=e.encode(t.style.style),c=e.encode(t.style.weight),u+=4+l.length+4+c.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),m=new DataView(d);let g=0;m.setUint8(g++,t.guessFallback?1:0),m.setUint32(g,0),g+=4,a=0;for(const v of ar.strings){const w=i[v],_=w.length;a+=4+_,m.setUint32(g,_),f.set(w,g+4),g+=4+_}return m.setUint32(g-a-4,a),t.style&&(m.setUint32(g,l.length),f.set(l,g+4),g+=4+l.length,m.setUint32(g,c.length),f.set(c,g+4),g+=4+c.length),Nt(g<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(g)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Nt(t<ar.strings.length,"Invalid string index");let e=5;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const a=this.#e.getUint32(t),l=this.#i.decode(new Uint8Array(this.#t,t+4,a));return{style:i,weight:l}}}class Ht{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#r=this.#n+1+6;#a;#s;#o;constructor({data:t,extra:e}){this.#a=t,this.#s=new TextDecoder,this.#o=new DataView(this.#a),e&&Object.assign(this,e)}#c(t){Nt(t<Ht.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,a=this.#o.getUint8(e)>>i&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Nt(t<Ht.numbers.length,"Invalid number index"),this.#o.getFloat64(Ht.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Ht.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<4;a++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=Ht.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<6;a++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=Ht.#n;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<3;a++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Nt(t<Ht.strings.length,"Invalid string index");let e=Ht.#r+4;for(let l=0;l<t;l++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),a=new Uint8Array(i);return a.set(new Uint8Array(this.#a,e+4,i)),this.#s.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ht.#r;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);t+=4+a;const l=this.#o.getUint32(t);if(l!==0)return new Uint8Array(this.#a,t+4,l)}clearData(){let t=Ht.#r;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);t+=4+a;const l=this.#o.getUint32(t);new Uint8Array(this.#a,t+4,l).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Ht.#r;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);if(a===0)return null;const l=new Uint8Array(a);return l.set(new Uint8Array(this.#a,t+4,a)),new sr(l.buffer)}get systemFontInfo(){let t=Ht.#r;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const a=new Uint8Array(i);return a.set(new Uint8Array(this.#a,t+4,i)),new ar(a.buffer)}static write(t){const e=t.systemFontInfo?ar.write(t.systemFontInfo):null,i=t.cssFontInfo?sr.write(t.cssFontInfo):null,a=new TextEncoder,l={};let c=0;for(const x of Ht.strings)l[x]=a.encode(t[x]),c+=4+l[x].length;const u=Ht.#r+4+c+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),m=new DataView(d);let g=0;const v=Ht.bools.length;let w=0,_=0;for(let x=0;x<v;x++){const S=t[Ht.bools[x]];w|=(S===void 0?0:S?2:1)<<_,_+=2,(_===8||x===v-1)&&(m.setUint8(g++,w),w=0,_=0)}Nt(g===Ht.#t,"FontInfo.write: Boolean properties offset mismatch");for(const x of Ht.numbers)m.setFloat64(g,t[x]),g+=8;if(Nt(g===Ht.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){m.setUint8(g++,4);for(const x of t.bbox)m.setInt16(g,x,!0),g+=2}else m.setUint8(g++,0),g+=8;if(Nt(g===Ht.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){m.setUint8(g++,6);for(const x of t.fontMatrix)m.setFloat64(g,x,!0),g+=8}else m.setUint8(g++,0),g+=48;if(Nt(g===Ht.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){m.setUint8(g++,1);for(const x of t.defaultVMetrics)m.setInt16(g,x,!0),g+=2}else m.setUint8(g++,0),g+=6;Nt(g===Ht.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),m.setUint32(Ht.#r,0),g+=4;for(const x of Ht.strings){const S=l[x],E=S.length;m.setUint32(g,E),f.set(S,g+4),g+=4+E}if(m.setUint32(Ht.#r,g-Ht.#r-4),!e)m.setUint32(g,0),g+=4;else{const x=e.byteLength;m.setUint32(g,x),Nt(g+4+x<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),g+4),g+=4+x}if(!i)m.setUint32(g,0),g+=4;else{const x=i.byteLength;m.setUint32(g,x),Nt(g+4+x<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(i),g+4),g+=4+x}return t.data===void 0?(m.setUint32(g,0),g+=4):(m.setUint32(g,t.data.length),f.set(t.data,g+4),g+=4+t.data.length),Nt(g<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(g)}}class Ee{static#t=0;static#e=1;static#i=2;static#n=3;static#r=4;static#a=8;static#s=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,i=null,a=[],l=[],c=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,i=t[2],c=t[3],e===1?a.push(...t[4],...t[5]):a.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,d=t[1],a=t[2],l=t[3],u=t[4]||[],i=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const m=Math.floor(a.length/2),g=Math.floor(l.length/3),v=c.length,w=u.length;let _=0;for(const N of u)_+=1,_=Math.ceil(_/4)*4,_+=4+N.coords.length*4,_+=4+N.colors.length*4,N.verticesPerRow!==void 0&&(_+=4);const x=20+m*8+g*3+v*8+(i?16:0)+(f?3:0)+_,S=new ArrayBuffer(x),E=new DataView(S),R=new Uint8Array(S);E.setUint8(Ee.#t,e),E.setUint8(Ee.#e,i?1:0),E.setUint8(Ee.#i,f?1:0),E.setUint8(Ee.#n,d),E.setUint32(Ee.#r,m,!0),E.setUint32(Ee.#a,g,!0),E.setUint32(Ee.#s,v,!0),E.setUint32(Ee.#o,w,!0);let C=20;new Float32Array(S,C,m*2).set(a),C+=m*8,R.set(l,C),C+=g*3;for(const[N,L]of c)E.setFloat32(C,N,!0),C+=4,E.setUint32(C,parseInt(L.slice(1),16),!0),C+=4;if(i)for(const N of i)E.setFloat32(C,N,!0),C+=4;f&&(R.set(f,C),C+=3);for(let N=0;N<u.length;N++){const L=u[N];E.setUint8(C,L.type),C+=1,C=Math.ceil(C/4)*4,E.setUint32(C,L.coords.length,!0),C+=4,new Int32Array(S,C,L.coords.length).set(L.coords),C+=L.coords.length*4,E.setUint32(C,L.colors.length,!0),C+=4,new Int32Array(S,C,L.colors.length).set(L.colors),C+=L.colors.length*4,L.verticesPerRow!==void 0&&(E.setUint32(C,L.verticesPerRow,!0),C+=4)}return S}getIR(){const t=this.view,e=this.data[Ee.#t],i=!!this.data[Ee.#e],a=!!this.data[Ee.#i],l=t.getUint32(Ee.#r,!0),c=t.getUint32(Ee.#a,!0),u=t.getUint32(Ee.#s,!0),d=t.getUint32(Ee.#o,!0);let f=20;const m=new Float32Array(this.buffer,f,l*2);f+=l*8;const g=new Uint8Array(this.buffer,f,c*3);f+=c*3;const v=[];for(let S=0;S<u;++S){const E=t.getFloat32(f,!0);f+=4;const R=t.getUint32(f,!0);f+=4,v.push([E,`#${R.toString(16).padStart(6,"0")}`])}let w=null;if(i){w=[];for(let S=0;S<4;++S)w.push(t.getFloat32(f,!0)),f+=4}let _=null;a&&(_=new Uint8Array(this.buffer,f,3),f+=3);const x=[];for(let S=0;S<d;++S){const E=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const R=t.getUint32(f,!0);f+=4;const C=new Int32Array(this.buffer,f,R);f+=R*4;const D=t.getUint32(f,!0);f+=4;const N=new Int32Array(this.buffer,f,D);f+=D*4;const L={type:E,coords:C,colors:N};E===Mf.LATTICE&&(L.verticesPerRow=t.getUint32(f,!0),f+=4),x.push(L)}if(e===1)return["RadialAxial","axial",w,v,Array.from(m.slice(0,2)),Array.from(m.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",w,v,[m[0],m[1]],[m[3],m[4]],m[2],m[5]];if(e===3){const S=this.data[Ee.#n];let E=null;if(m.length>0){let R=m[0],C=m[0],D=m[1],N=m[1];for(let L=0;L<m.length;L+=2){const j=m[L],K=m[L+1];R=R>j?j:R,D=D>K?K:D,C=C<j?j:C,N=N<K?K:N}E=[R,D,C,N]}return["Mesh",S,m,g,x,E,w,_]}throw new Error(`Unsupported pattern kind: ${e}`)}}class ED{static write(t){let e,i;return ve.isFloat16ArraySupported?(i=new ArrayBuffer(t.length*2),e=new Float16Array(i)):(i=new ArrayBuffer(t.length*4),e=new Float32Array(i)),e.set(t),i}#t;constructor(t){this.#t=t}get path(){return ve.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function TD(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(Ue)return r;const t=URL.parse(r,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function CD(r){if(Ue&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return Jo(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Nc(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const Of=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,RD=r=>typeof r=="object"&&typeof r?.name=="string",nw=pD.bind(null,Of,RD);class DD{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,i)})}addEventListener(t,e,i=null){let a=null;if(i?.signal instanceof AbortSignal){const{signal:l}=i;if(l.aborted){wt("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,e);a=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(e,a)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Mc={DATA:1,ERROR:2},ye={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Fb(){}function Qe(r){if(r instanceof Bi||r instanceof au||r instanceof kb||r instanceof Fo||r instanceof lf)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||qt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Bi(r.message);case"InvalidPDFException":return new au(r.message);case"PasswordException":return new kb(r.message,r.code);case"ResponseException":return new Fo(r.message,r.status,r.missing);case"UnknownErrorException":return new lf(r.message,r.details)}return new lf(r.message,r.toString())}class Co{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const i=t.callbackId,a=this.callbackCapabilities[i];if(!a)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Mc.DATA)a.resolve(t.data);else if(t.callback===Mc.ERROR)a.reject(Qe(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,a=t.sourceName,l=this.comObj;Promise.try(e,t.data).then(function(c){l.postMessage({sourceName:i,targetName:a,callback:Mc.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:i,targetName:a,callback:Mc.ERROR,callbackId:t.callbackId,reason:Qe(c)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const a=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[a]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},i)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,e,i,a){const l=this.streamId++,c=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const m=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:e,desiredSize:f.desiredSize},a),m.promise},pull:f=>{const m=Promise.withResolvers();return this.streamControllers[l].pullCall=m,d.postMessage({sourceName:c,targetName:u,stream:ye.PULL,streamId:l,desiredSize:f.desiredSize}),m.promise},cancel:f=>{Nt(f instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[l].cancelCall=m,this.streamControllers[l].isClosed=!0,d.postMessage({sourceName:c,targetName:u,stream:ye.CANCEL,streamId:l,reason:Qe(f)}),m.promise}},i)}#i(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],d={enqueue(f,m=1,g){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=m,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:i,targetName:a,stream:ye.ENQUEUE,streamId:e,chunk:f},g)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:a,stream:ye.CLOSE,streamId:e}),delete c.streamSinks[e])},error(f){Nt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:a,stream:ye.ERROR,streamId:e,reason:Qe(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){l.postMessage({sourceName:i,targetName:a,stream:ye.START_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:ye.START_COMPLETE,streamId:e,reason:Qe(f)})})}#n(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,l=this.comObj,c=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case ye.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Qe(t.reason));break;case ye.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Qe(t.reason));break;case ye.PULL:if(!u){l.postMessage({sourceName:i,targetName:a,stream:ye.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Fb).then(function(){l.postMessage({sourceName:i,targetName:a,stream:ye.PULL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:ye.PULL_COMPLETE,streamId:e,reason:Qe(f)})});break;case ye.ENQUEUE:if(Nt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case ye.CLOSE:if(Nt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,e);break;case ye.ERROR:Nt(c,"error should have stream controller"),c.controller.error(Qe(t.reason)),this.#r(c,e);break;case ye.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Qe(t.reason)),this.#r(c,e);break;case ye.CANCEL:if(!u)break;const d=Qe(t.reason);Promise.try(u.onCancel||Fb,d).then(function(){l.postMessage({sourceName:i,targetName:a,stream:ye.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:ye.CANCEL_COMPLETE,streamId:e,reason:Qe(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#r(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class iw{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){qt("Abstract method `_createCanvas` called.")}}class ND extends iw{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class sw{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class zb extends sw{async _fetch(t){const e=await vr(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Jo(e)}}class aw{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,a,l){return"none"}destroy(t=!1){}}class MD extends aw{#t;#e;#i;#n;#r;#a;#s=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#r=e}get#o(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#l(){if(!this.#i){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#r.createElementNS(Ci,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#r.createElementNS(Ci,"defs"),t.append(i),i.append(this.#i),this.#r.body.append(t)}return this.#i}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let g=0;g<256;g++)f[g]=d[g]/255;const m=f.join(",");return[m,m,m]}const[e,i,a]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let d=0;d<256;d++)l[d]=e[d]/255,c[d]=i[d]/255,u[d]=a[d]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#r.URL;e!==this.#r.baseURI&&(el(e)?wt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=pp(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,a,l]=this.#d(t),c=t.length===1?i:`${i}${a}${l}`;if(e=this.#o.get(c),e)return this.#o.set(t,e),e;const u=`g_${this.#n}_transfer_map_${this.#s++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(c,d);const f=this.#m(u);return this.#p(i,a,l,f),d}addHCMFilter(t,e){const i=`${t}-${e}`,a="base";let l=this.#c.get(a);if(l?.key===i||(l?(l.filter?.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},this.#c.set(a,l)),!t||!e))return l.url;const c=this.#v(t);t=nt.makeHexColor(...c);const u=this.#v(e);if(e=nt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return l.url;const d=new Array(256);for(let w=0;w<=255;w++){const _=w/255;d[w]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const f=d.join(","),m=`g_${this.#n}_hcm_filter`,g=l.filter=this.#m(m);this.#p(f,f,f,g),this.#g(g);const v=(w,_)=>{const x=c[w]/255,S=u[w]/255,E=new Array(_+1);for(let R=0;R<=_;R++)E[R]=x+R/_*(S-x);return E.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),g),l.url=this.#h(m),l.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),a=`alpha_${i}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_alpha_map_${this.#s++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#m(l);return this.#y(i,u),c}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,a;if(t?([i]=this.#d([t]),a=`luminosity_${i}`):a="luminosity",e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_luminosity_map_${this.#s++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#m(l);return this.#f(u),t&&this.#y(i,u),c}addHighlightHCMFilter(t,e,i,a,l){const c=`${e}-${i}-${a}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!e||!i))return u.url;const[d,f]=[e,i].map(this.#v.bind(this));let m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),g=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[v,w]=[a,l].map(this.#v.bind(this));g<m&&([m,g,v,w]=[g,m,w,v]),this.#l.style.color="";const _=(E,R,C)=>{const D=new Array(256),N=(g-m)/C,L=E/255,j=(R-E)/(255*C);let K=0;for(let Y=0;Y<=C;Y++){const $=Math.round(m+Y*N),H=L+Y*j;for(let J=K;J<=$;J++)D[J]=H;K=$+1}for(let Y=K;Y<256;Y++)D[Y]=D[K-1];return D.join(",")},x=`g_${this.#n}_hcm_${t}_filter`,S=u.filter=this.#m(x);return this.#g(S),this.#p(_(v[0],w[0],5),_(v[1],w[1],5),_(v[2],w[2],5),S),u.url=this.#h(x),u.url}destroy(t=!1){t&&this.#a?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#s=0)}#f(t){const e=this.#r.createElementNS(Ci,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#r.createElementNS(Ci,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#m(t){const e=this.#r.createElementNS(Ci,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,i){const a=this.#r.createElementNS(Ci,e);a.setAttribute("type","discrete"),a.setAttribute("tableValues",i),t.append(a)}#p(t,e,i,a){const l=this.#r.createElementNS(Ci,"feComponentTransfer");a.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",e),this.#u(l,"feFuncB",i)}#y(t,e){const i=this.#r.createElementNS(Ci,"feComponentTransfer");e.append(i),this.#u(i,"feFuncA",t)}#v(t){return this.#l.style.color=t,wr(getComputedStyle(this.#l).getPropertyValue("color"))}}class rw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class Hb extends rw{async _fetch(t){const e=await vr(t,"arraybuffer");return new Uint8Array(e)}}class ow{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class Vb extends ow{async _fetch(t){const e=await vr(t,"arraybuffer");return new Uint8Array(e)}}Ue&&wt("Please use the `legacy` build in Node.js environments.");async function xp(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class kD extends aw{}class LD extends iw{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class OD extends sw{async _fetch(t){return xp(t)}}class ID extends rw{async _fetch(t){return xp(t)}}class PD extends ow{async _fetch(t){return xp(t)}}const Xa="__forcedDependency",{floor:Gb,ceil:qb}=Math;function kc(r,t,e,i,a,l){r[t*4+0]=Math.min(r[t*4+0],e),r[t*4+1]=Math.min(r[t*4+1],i),r[t*4+2]=Math.max(r[t*4+2],a),r[t*4+3]=Math.max(r[t*4+3],l)}const If=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class jD{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===If}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Lc=(r,t)=>{if(!r)return;let e=r.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},r.set(t,e)),e};class BD{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Xa]:[]};#i=new Map;#n=[];#r=[];#a=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(t,e,i=!1){this.#f=t.width,this.#g=t.height,this.#y(e),i&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const i=new ArrayBuffer(t*4);this.#m=new Uint8ClampedArray(i),this.#u=new Uint32Array(i),e&&e.length>0?(this.#u.set(e),this.#u.fill(If,e.length)):this.#u.fill(If)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Xa]:{__proto__:this.#e[Xa]}},this.#s={__proto__:this.#s},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const i=this.#n.pop();return i!==void 0&&(Lc(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(Lc(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const e=this.#r.pop();return e!==void 0&&(Lc(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#a.push(nt.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#i.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Xa,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Xa,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,a,l,c){const u=nt.multiplyByDOMMatrix(this.#a.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];nt.axialAlignedBoundingBox([i,l,a,c],u,d);const f=nt.intersect(this.#s,d);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,e,i,a,l,c){const u=this.#s;if(u[0]===1/0)return this;const d=nt.multiplyByDOMMatrix(this.#a.at(-1),e.getTransform());if(u[0]===-1/0)return nt.axialAlignedBoundingBox([i,l,a,c],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return nt.axialAlignedBoundingBox([i,l,a,c],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,i,a=1,l=0,c=0,u){const d=i.bbox;let f,m;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(i),f!==!1&&(m=[0,0,0,0],nt.axialAlignedBoundingBox(d,i.fontMatrix,m),(a!==1||l!==0||c!==0)&&nt.scaleMinMax([a,0,0,-a,l,c],m),f)))return this.recordBBox(t,e,m[0],m[2],m[1],m[3]);if(!u)return this.recordFullPageBBox(t);const g=u();return d&&m&&f===void 0&&(f=m[0]<=l-g.actualBoundingBoxLeft&&m[2]>=l+g.actualBoundingBoxRight&&m[1]<=c-g.actualBoundingBoxAscent&&m[3]>=c+g.actualBoundingBoxDescent,this.#h.set(i,f),f)?this.recordBBox(t,e,m[0],m[2],m[1],m[3]):this.recordBBox(t,e,l-g.actualBoundingBoxLeft,l+g.actualBoundingBoxRight,c-g.actualBoundingBoxAscent,c+g.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#g,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,a=this.#t,l=this.#e;for(const c of e)c in this.#t?i.add(a[c]):c in l&&l[c].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[Xa]),this.#p){const i=Lc(this.#p,t),{dependencies:a}=i;this.#l.forEach(a.add,a),this.#n.forEach(a.add,a),this.#r.forEach(a.add,a),a.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=Gb(this.#o[0]*256/this.#f),a=Gb(this.#o[1]*256/this.#g),l=qb(this.#o[2]*256/this.#f),c=qb(this.#o[3]*256/this.#g);kc(this.#m,t,i,a,l,c);for(const u of this.#l)u!==t&&kc(this.#m,u,i,a,l,c);for(const u of this.#n)u!==t&&kc(this.#m,u,i,a,l,c);for(const u of this.#r)u!==t&&kc(this.#m,u,i,a,l,c);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const a of i)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new jD(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class lu{#t;#e;#i;#n=0;#r=0;constructor(t,e,i){if(t instanceof lu&&t.#i===!!i)return t;this.#t=t,this.#e=e,this.#i=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,a,l,c){return this.#i||this.#t.recordClipBox(this.#e,e,i,a,l,c),this}recordBBox(t,e,i,a,l,c){return this.#i||this.#t.recordBBox(this.#e,e,i,a,l,c),this}recordCharacterBBox(t,e,i,a,l,c,u){return this.#i||this.#t.recordCharacterBBox(this.#e,e,i,a,l,c,u),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Nn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Le={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Pf(r,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],e,i),r.clip(a)}class Ap{isModifyingCurrentTransform(){return!1}getPattern(){qt("Abstract method `getPattern` called.")}}class UD extends Ap{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let i,a=this._p0,l=this._p1;if(e&&(a=a.slice(),l=l.slice(),nt.applyTransform(a,e),nt.applyTransform(l,e)),this._type==="axial")i=t.createLinearGradient(a[0],a[1],l[0],l[1]);else if(this._type==="radial"){let c=this._r0,u=this._r1;if(e){const d=new Float32Array(2);nt.singularValueDecompose2dScale(e,d),c*=d[0],u*=d[0]}i=t.createRadialGradient(a[0],a[1],c,l[0],l[1],u)}for(const c of this._colorStops)i.addColorStop(c[0],c[1]);return i}getPattern(t,e,i,a){let l;if(a===Le.STROKE||a===Le.FILL){if(this.isOriginBased()){let v=nt.transform(i,e.baseTransform);this.matrix&&(v=nt.transform(v,this.matrix));const w=.001,_=Math.hypot(v[0],v[1]),x=Math.hypot(v[2],v[3]),S=(v[0]*v[2]+v[1]*v[3])/(_*x);if(Math.abs(S)<w)if(this.isRadial()){if(Math.abs(_-x)<w)return this._createGradient(t,v)}else return this._createGradient(t,v)}const c=e.current.getClippedPathBoundingBox(a,ne(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,d=Math.ceil(c[3]-c[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),m=f.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-c[0],-c[1]),i=nt.transform(i,[1,0,0,1,c[0],c[1]]),m.transform(...e.baseTransform),this.matrix&&m.transform(...this.matrix),Pf(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),l=t.createPattern(f.canvas,"no-repeat");const g=new DOMMatrix(i);l.setTransform(g)}else Pf(t,this._bbox),l=this._createGradient(t);return l}}function hf(r,t,e,i,a,l,c,u){const d=t.coords,f=t.colors,m=r.data,g=r.width*4;let v;d[e+1]>d[i+1]&&(v=e,e=i,i=v,v=l,l=c,c=v),d[i+1]>d[a+1]&&(v=i,i=a,a=v,v=c,c=u,u=v),d[e+1]>d[i+1]&&(v=e,e=i,i=v,v=l,l=c,c=v);const w=(d[e]+t.offsetX)*t.scaleX,_=(d[e+1]+t.offsetY)*t.scaleY,x=(d[i]+t.offsetX)*t.scaleX,S=(d[i+1]+t.offsetY)*t.scaleY,E=(d[a]+t.offsetX)*t.scaleX,R=(d[a+1]+t.offsetY)*t.scaleY;if(_>=R)return;const C=f[l],D=f[l+1],N=f[l+2],L=f[c],j=f[c+1],K=f[c+2],Y=f[u],$=f[u+1],H=f[u+2],J=Math.round(_),at=Math.round(R);let rt,pt,P,q,tt,mt,St,k;for(let V=J;V<=at;V++){if(V<S){const ht=V<_?0:(_-V)/(_-S);rt=w-(w-x)*ht,pt=C-(C-L)*ht,P=D-(D-j)*ht,q=N-(N-K)*ht}else{let ht;V>R?ht=1:S===R?ht=0:ht=(S-V)/(S-R),rt=x-(x-E)*ht,pt=L-(L-Y)*ht,P=j-(j-$)*ht,q=K-(K-H)*ht}let Z;V<_?Z=0:V>R?Z=1:Z=(_-V)/(_-R),tt=w-(w-E)*Z,mt=C-(C-Y)*Z,St=D-(D-$)*Z,k=N-(N-H)*Z;const et=Math.round(Math.min(rt,tt)),ut=Math.round(Math.max(rt,tt));let gt=g*V+et*4;for(let ht=et;ht<=ut;ht++)Z=(rt-ht)/(rt-tt),Z<0?Z=0:Z>1&&(Z=1),m[gt++]=pt-(pt-mt)*Z|0,m[gt++]=P-(P-St)*Z|0,m[gt++]=q-(q-k)*Z|0,m[gt++]=255}}function FD(r,t,e){const i=t.coords,a=t.colors;let l,c;switch(t.type){case Mf.LATTICE:const u=t.verticesPerRow,d=Math.floor(i.length/u)-1,f=u-1;for(l=0;l<d;l++){let m=l*u;for(let g=0;g<f;g++,m++)hf(r,e,i[m],i[m+1],i[m+u],a[m],a[m+1],a[m+u]),hf(r,e,i[m+u+1],i[m+1],i[m+u],a[m+u+1],a[m+1],a[m+u])}break;case Mf.TRIANGLES:for(l=0,c=i.length;l<c;l+=3)hf(r,e,i[l],i[l+1],i[l+2],a[l],a[l+1],a[l+2]);break;default:throw new Error("illegal figure")}}class zD extends Ap{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,m=Math.ceil(this._bounds[3])-d,g=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(m*t[1]*1.1)),3e3),w=f/g,_=m/v,x={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/w,scaleY:1/_},S=g+4,E=v+4,R=i.getCanvas("mesh",S,E),C=R.context,D=C.createImageData(g,v);if(e){const L=D.data;for(let j=0,K=L.length;j<K;j+=4)L[j]=e[0],L[j+1]=e[1],L[j+2]=e[2],L[j+3]=255}for(const L of this._figures)FD(D,L,x);return C.putImageData(D,2,2),{canvas:R.canvas,offsetX:u-2*w,offsetY:d-2*_,scaleX:w,scaleY:_}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,a){Pf(t,this._bbox);const l=new Float32Array(2);if(a===Le.SHADING)nt.singularValueDecompose2dScale(ne(t),l);else if(this.matrix){nt.singularValueDecompose2dScale(this.matrix,l);const[u,d]=l;nt.singularValueDecompose2dScale(e.baseTransform,l),l[0]*=u,l[1]*=d}else nt.singularValueDecompose2dScale(e.baseTransform,l);const c=this._createMeshCanvas(l,a===Le.SHADING?null:this._background,e.cachedCanvases);return a!==Le.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class HD extends Ap{getPattern(){return"hotpink"}}function VD(r){switch(r[0]){case"RadialAxial":return new UD(r);case"Mesh":return new zD(r);case"Dummy":return new HD}throw new Error(`Unknown IR type: ${r[0]}`)}const $b={COLORED:1,UNCOLORED:2};class Sp{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=a}createPatternCanvas(t,e){const{bbox:i,operatorList:a,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:m}=this;f=Math.abs(f),m=Math.abs(m),bu("TilingType: "+c);const g=i[0],v=i[1],w=i[2],_=i[3],x=w-g,S=_-v,E=new Float32Array(2);nt.singularValueDecompose2dScale(this.matrix,E);const[R,C]=E;nt.singularValueDecompose2dScale(this.baseTransform,E);const D=R*E[0],N=C*E[1];let L=x,j=S,K=!1,Y=!1;const $=Math.ceil(f*D),H=Math.ceil(m*N),J=Math.ceil(x*D),at=Math.ceil(S*N);$>=J?L=f:K=!0,H>=at?j=m:Y=!0;const rt=this.getSizeAndScale(L,this.ctx.canvas.width,D),pt=this.getSizeAndScale(j,this.ctx.canvas.height,N),P=t.cachedCanvases.getCanvas("pattern",rt.size,pt.size),q=P.context,tt=d.createCanvasGraphics(q,e);if(tt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(tt,l,u),q.translate(-rt.scale*g,-pt.scale*v),tt.transform(0,rt.scale,0,0,pt.scale,0,0),q.save(),tt.dependencyTracker?.save(),this.clipBbox(tt,g,v,w,_),tt.baseTransform=ne(tt.ctx),tt.executeOperatorList(a),tt.endDrawing(),tt.dependencyTracker?.restore(),q.restore(),K||Y){const mt=P.canvas;K&&(L=f),Y&&(j=m);const St=this.getSizeAndScale(L,this.ctx.canvas.width,D),k=this.getSizeAndScale(j,this.ctx.canvas.height,N),V=St.size,Z=k.size,et=t.cachedCanvases.getCanvas("pattern-workaround",V,Z),ut=et.context,gt=K?Math.floor(x/f):0,ht=Y?Math.floor(S/m):0;for(let ae=0;ae<=gt;ae++)for(let Pt=0;Pt<=ht;Pt++)ut.drawImage(mt,V*ae,Z*Pt,V,Z,0,0,V,Z);return{canvas:et.canvas,scaleX:St.scale,scaleY:k.scale,offsetX:g,offsetY:v}}return{canvas:P.canvas,scaleX:rt.scale,scaleY:pt.scale,offsetX:g,offsetY:v}}getSizeAndScale(t,e,i){const a=Math.max(Sp.MAX_PATTERN_SIZE,e);let l=Math.ceil(t*i);return l>=a?l=a:i=l/t,{scale:i,size:l}}clipBbox(t,e,i,a,l){const c=a-e,u=l-i;t.ctx.rect(e,i,c,u),nt.axialAlignedBoundingBox([e,i,a,l],ne(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const a=t.ctx,l=t.current;switch(e){case $b.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;a.fillStyle=l.fillColor=c,a.strokeStyle=l.strokeColor=u;break;case $b.UNCOLORED:a.fillStyle=a.strokeStyle=i,l.fillColor=l.strokeColor=i;break;default:throw new cD(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,a,l){let c=i;a!==Le.SHADING&&(c=nt.transform(c,e.baseTransform),this.matrix&&(c=nt.transform(c,this.matrix)));const u=this.createPatternCanvas(e,l);let d=new DOMMatrix(c);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function GD({src:r,srcPos:t=0,dest:e,width:i,height:a,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=ve.isLittleEndian?4278190080:255,[d,f]=c?[l,u]:[u,l],m=i>>3,g=i&7,v=r.length;e=new Uint32Array(e.buffer);let w=0;for(let _=0;_<a;_++){for(const S=t+m;t<S;t++){const E=t<v?r[t]:255;e[w++]=E&128?f:d,e[w++]=E&64?f:d,e[w++]=E&32?f:d,e[w++]=E&16?f:d,e[w++]=E&8?f:d,e[w++]=E&4?f:d,e[w++]=E&2?f:d,e[w++]=E&1?f:d}if(g===0)continue;const x=t<v?r[t++]:255;for(let S=0;S<g;S++)e[w++]=x&1<<7-S?f:d}return{srcPos:t,destPos:w}}const Yb=16,Xb=100,qD=15,Wb=10,Ze=16,df=new DOMMatrix,pn=new Float32Array(2),Ja=new Float32Array([1/0,1/0,-1/0,-1/0]);function $D(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},r.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},r.transform=function(e,i,a,l,c,u){t.transform(e,i,a,l,c,u),this.__originalTransform(e,i,a,l,c,u)},r.setTransform=function(e,i,a,l,c,u){t.setTransform(e,i,a,l,c,u),this.__originalSetTransform(e,i,a,l,c,u)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(e){t.rotate(e),this.__originalRotate(e)},r.clip=function(e){t.clip(e),this.__originalClip(e)},r.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},r.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},r.bezierCurveTo=function(e,i,a,l,c,u){t.bezierCurveTo(e,i,a,l,c,u),this.__originalBezierCurveTo(e,i,a,l,c,u)},r.rect=function(e,i,a,l){t.rect(e,i,a,l),this.__originalRect(e,i,a,l)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class YD{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,e,i)):(a=this.canvasFactory.create(e,i),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Oc(r,t,e,i,a,l,c,u,d,f){const[m,g,v,w,_,x]=ne(r);if(g===0&&v===0){const R=c*m+_,C=Math.round(R),D=u*w+x,N=Math.round(D),L=(c+d)*m+_,j=Math.abs(Math.round(L)-C)||1,K=(u+f)*w+x,Y=Math.abs(Math.round(K)-N)||1;return r.setTransform(Math.sign(m),0,0,Math.sign(w),C,N),r.drawImage(t,e,i,a,l,0,0,j,Y),r.setTransform(m,g,v,w,_,x),[j,Y]}if(m===0&&w===0){const R=u*v+_,C=Math.round(R),D=c*g+x,N=Math.round(D),L=(u+f)*v+_,j=Math.abs(Math.round(L)-C)||1,K=(c+d)*g+x,Y=Math.abs(Math.round(K)-N)||1;return r.setTransform(0,Math.sign(g),Math.sign(v),0,C,N),r.drawImage(t,e,i,a,l,0,0,Y,j),r.setTransform(m,g,v,w,_,x),[Y,j]}r.drawImage(t,e,i,a,l,c,u,d,f);const S=Math.hypot(m,g),E=Math.hypot(v,w);return[S*d,E*f]}class Kb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Nf;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=xe.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Ja.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Le.FILL,e=null){const i=this.minMax.slice();if(t===Le.STROKE){e||qt("Stroke bounding box must include transform."),nt.singularValueDecompose2dScale(e,pn);const a=pn[0]*this.lineWidth/2,l=pn[1]*this.lineWidth/2;i[0]-=a,i[1]-=l,i[2]+=a,i[3]+=l}return i}updateClipFromPath(){const t=nt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Ja,0)}getClippedPathBoundingBox(t=Le.FILL,e=null){return nt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Qb(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,i=t.width,a=e%Ze,l=(e-a)/Ze,c=a===0?l:l+1,u=r.createImageData(i,Ze);let d=0,f;const m=t.data,g=u.data;let v,w,_,x;if(t.kind===Mo.GRAYSCALE_1BPP){const S=m.byteLength,E=new Uint32Array(g.buffer,0,g.byteLength>>2),R=E.length,C=i+7>>3,D=4294967295,N=ve.isLittleEndian?4278190080:255;for(v=0;v<c;v++){for(_=v<l?Ze:a,f=0,w=0;w<_;w++){const L=S-d;let j=0;const K=L>C?i:L*8-7,Y=K&-8;let $=0,H=0;for(;j<Y;j+=8)H=m[d++],E[f++]=H&128?D:N,E[f++]=H&64?D:N,E[f++]=H&32?D:N,E[f++]=H&16?D:N,E[f++]=H&8?D:N,E[f++]=H&4?D:N,E[f++]=H&2?D:N,E[f++]=H&1?D:N;for(;j<K;j++)$===0&&(H=m[d++],$=128),E[f++]=H&$?D:N,$>>=1}for(;f<R;)E[f++]=0;r.putImageData(u,0,v*Ze)}}else if(t.kind===Mo.RGBA_32BPP){for(w=0,x=i*Ze*4,v=0;v<l;v++)g.set(m.subarray(d,d+x)),d+=x,r.putImageData(u,0,w),w+=Ze;v<c&&(x=i*a*4,g.set(m.subarray(d,d+x)),r.putImageData(u,0,w))}else if(t.kind===Mo.RGB_24BPP)for(_=Ze,x=i*_,v=0;v<c;v++){for(v>=l&&(_=a,x=i*_),f=0,w=x;w--;)g[f++]=m[d++],g[f++]=m[d++],g[f++]=m[d++],g[f++]=255;r.putImageData(u,0,v*Ze)}else throw new Error(`bad image kind: ${t.kind}`)}function Zb(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,a=e%Ze,l=(e-a)/Ze,c=a===0?l:l+1,u=r.createImageData(i,Ze);let d=0;const f=t.data,m=u.data;for(let g=0;g<c;g++){const v=g<l?Ze:a;({srcPos:d}=GD({src:f,srcPos:d,dest:m,width:i,height:v,nonBlackColor:0})),r.putImageData(u,0,g*Ze)}}function vo(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)r[i]!==void 0&&(t[i]=r[i]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function Ic(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}function Jb(r,t){if(t)return!0;nt.singularValueDecompose2dScale(r,pn);const e=Math.fround(Hn.pixelRatio*ta.PDF_TO_CSS_UNITS);return pn[0]<=e&&pn[1]<=e}const XD=["butt","round","square"],WD=["miter","round","bevel"],KD={},tv={};class rr{constructor(t,e,i,a,l,{optionalContentConfig:c,markedContentStack:u=null},d,f,m){this.ctx=t,this.current=new Kb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=a,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new YD(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=m??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:a=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,i){const d=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...ne(this.compositeCtx))}this.ctx.save(),Ic(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ne(this.ctx)}executeOperatorList(t,e,i,a,l){const c=t.argsArray,u=t.fnArray;let d=e||0;const f=c.length;if(f===d)return d;const m=f-d>Wb&&typeof i=="function",g=m?Date.now()+qD:0;let v=0;const w=this.commonObjs,_=this.objs;let x,S;for(;;){if(a!==void 0&&d===a.nextBreakPoint)return a.breakIt(d,i),d;if(!l||l(d))if(x=u[d],S=c[d]??null,x!==hr.dependency)S===null?this[x](d):this[x](d,...S);else for(const E of S){this.dependencyTracker?.recordNamedData(E,d);const R=E.startsWith("g_")?w:_;if(!R.has(E))return R.get(E,i),d}if(d++,d===f)return d;if(m&&++v>Wb){if(Date.now()>g)return i(),d;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,a=t.height??t.displayHeight;let l=Math.max(Math.hypot(e[0],e[1]),1),c=Math.max(Math.hypot(e[2],e[3]),1),u=i,d=a,f="prescale1",m,g;for(;l>2&&u>1||c>2&&d>1;){let v=u,w=d;l>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/v),c>2&&d>1&&(w=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,c/=d/w),m=this.cachedCanvases.getCanvas(f,v,w),g=m.context,g.clearRect(0,0,v,w),g.drawImage(t,0,0,u,d,0,0,v,w),t=m.canvas,u=v,d=w,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const i=this.ctx,{width:a,height:l}=e,c=this.current.fillColor,u=this.current.patternFill,d=ne(i);let f,m,g,v;if((e.bitmap||e.data)&&e.count>1){const $=e.bitmap||e.data.buffer;m=JSON.stringify(u?d:[d.slice(0,4),c]),f=this._cachedBitmapsMap.get($),f||(f=new Map,this._cachedBitmapsMap.set($,f));const H=f.get(m);if(H&&!u){const J=Math.round(Math.min(d[0],d[2])+d[4]),at=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,Nn.transformAndFill),{canvas:H,offsetX:J,offsetY:at}}g=H}g||(v=this.cachedCanvases.getCanvas("maskCanvas",a,l),Zb(v.context,e));let w=nt.transform(d,[1/a,0,0,-1/l,0,0]);w=nt.transform(w,[1,0,0,1,0,-l]);const _=Ja.slice();nt.axialAlignedBoundingBox([0,0,a,l],w,_);const[x,S,E,R]=_,C=Math.round(E-x)||1,D=Math.round(R-S)||1,N=this.cachedCanvases.getCanvas("fillCanvas",C,D),L=N.context,j=x,K=S;L.translate(-j,-K),L.transform(...w),g||(g=this._scaleImage(v.canvas,Jn(L)),g=g.img,f&&u&&f.set(m,g)),L.imageSmoothingEnabled=Jb(ne(L),e.interpolate),Oc(L,g,0,0,g.width,g.height,0,0,a,l),L.globalCompositeOperation="source-in";const Y=nt.transform(Jn(L),[1,0,0,1,-j,-K]);return L.fillStyle=u?c.getPattern(i,this,Y,Le.FILL,t):c,L.fillRect(0,0,a,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(m,N.canvas)),this.dependencyTracker?.recordDependencies(t,Nn.transformAndFill),{canvas:N.canvas,offsetX:Math.round(j),offsetY:Math.round(K)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=XD[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=WD[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(e),a.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,a]of e)switch(i){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(a,e,i);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),vo(this.suspendedCtx,c),$D(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),vo(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,a){const l=a[0],c=a[1],u=a[2]-l,d=a[3]-c;u===0||d===0||(this.genericComposeSMask(e.context,i,u,d,e.subtype,e.backdrop,e.transferMap,l,c,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,a,l,c,u,d,f,m,g){let v=t.canvas,w=d-m,_=f-g;if(c)if(w<0||_<0||w+i>v.width||_+a>v.height){const S=this.cachedCanvases.getCanvas("maskExtension",i,a),E=S.context;E.drawImage(v,-w,-_),E.globalCompositeOperation="destination-atop",E.fillStyle=c,E.fillRect(0,0,i,a),E.globalCompositeOperation="source-over",v=S.canvas,w=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(w,_,i,a),t.clip(S),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(w,_,i,a),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const x=new Path2D;x.rect(d,f,i,a),e.clip(x),e.globalCompositeOperation="destination-in",e.drawImage(v,w,_,i,a,d,f,i,a),e.restore()}save(t){this.inSMaskMode&&vo(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&vo(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,a,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,a,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,a){let[l]=i;if(!a){l||=i[0]=new Path2D,this[e](t,l);return}if(this.dependencyTracker!==null){const c=e===hr.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-c,a[2]+c,a[1]-c,a[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=i[0]=Z1(l)),nt.axialAlignedBoundingBox(a,ne(this.ctx),this.current.minMax),this[e](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const a=this.ctx,l=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=l.getPattern(a,this,Jn(a),Le.STROKE,t),c){const u=new Path2D;u.addPath(e,a.getTransform().invertSelf().multiplySelf(c)),e=u}this.rescaleAndStroke(e,!1),a.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Nn.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Le.STROKE,ne(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const a=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=l.getPattern(a,this,Jn(a),Le.FILL,t),f){const m=new Path2D;m.addPath(e,a.getTransform().invertSelf().multiplySelf(f)),e=m}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(a.fill(e,"evenodd"),this.pendingEOFill=!1):a.fill(e)),this.dependencyTracker?.recordDependencies(t,Nn.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Nn.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=KD}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=tv}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;e!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(e!==void 0){const a=new Path2D,l=i.getTransform().invertSelf();for(const{transform:c,x:u,y:d,fontSize:f,path:m}of e)m&&a.addPath(m,new DOMMatrix(c).preMultiplySelf(l).translate(u,d).scale(f,-f));i.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const a=this.commonObjs.get(e),l=this.current;if(!a)throw new Error(`Can't find font for ${e}`);if(l.fontMatrix=a.fontMatrix||Nf,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&wt("Invalid font matrix for font "+e),i<0?(i=-i,l.fontDirection=-1):l.fontDirection=1,this.current.font=a,this.current.fontSize=i,a.isType3Font)return;const c=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${c}", ${a.fallbackName}`;let d="normal";a.black?d="900":a.bold&&(d="bold");const f=a.italic?"italic":"normal";let m=i;i<Yb?m=Yb:i>Xb&&(m=Xb),this.current.fontSizeScale=i/m,this.ctx.font=`${f} ${d} ${m}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,i){const a=new Path2D;return a.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),a}paintChar(t,e,i,a,l,c){const u=this.ctx,d=this.current,f=d.font,m=d.textRenderingMode,g=d.fontSize/d.fontSizeScale,v=m&xe.FILL_STROKE_MASK,w=!!(m&xe.ADD_TO_PATH_FLAG),_=d.patternFill&&!f.missingFile,x=d.patternStroke&&!f.missingFile;let S;if((f.disableFontFace||w||_||x)&&!f.missingFile&&(S=f.getPathGenerator(this.commonObjs,e)),S&&(f.disableFontFace||_||x)){u.save(),u.translate(i,a),u.scale(g,-g),this.dependencyTracker?.recordCharacterBBox(t,u,f);let E;if(v===xe.FILL||v===xe.FILL_STROKE)if(l){E=u.getTransform(),u.setTransform(...l);const R=this.#i(S,E,l);u.fill(R)}else u.fill(S);if(v===xe.STROKE||v===xe.FILL_STROKE)if(c){E||=u.getTransform(),u.setTransform(...c);const{a:R,b:C,c:D,d:N}=E,L=nt.inverseTransform(c),j=nt.transform([R,C,D,N,0,0],L);nt.singularValueDecompose2dScale(j,pn),u.lineWidth*=Math.max(pn[0],pn[1])/g,u.stroke(this.#i(S,E,c))}else u.lineWidth/=g,u.stroke(S);u.restore()}else(v===xe.FILL||v===xe.FILL_STROKE)&&(u.fillText(e,i,a),this.dependencyTracker?.recordCharacterBBox(t,u,f,g,i,a,()=>u.measureText(e))),(v===xe.STROKE||v===xe.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,g,i,a,()=>u.measureText(e)).recordDependencies(t,Nn.stroke),u.strokeText(e,i,a));w&&((this.pendingTextPaths||=[]).push({transform:ne(u),x:i,y:a,fontSize:g,path:S}),this.dependencyTracker?.recordCharacterBBox(t,u,f,g,i,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let a=3;a<e.length;a+=4)if(e[a]>0&&e[a]<255){i=!0;break}return yt(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Nn.showText).resetBBox(t),this.current.textRenderingMode&xe.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,a=i.font;if(a.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const l=i.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=i.fontSizeScale,d=i.charSpacing,f=i.wordSpacing,m=i.fontDirection,g=i.textHScale*m,v=e.length,w=a.vertical,_=w?1:-1,x=a.defaultVMetrics,S=l*i.fontMatrix[0],E=i.textRenderingMode===xe.FILL&&!a.disableFontFace&&!i.patternFill;c.save(),i.textMatrix&&c.transform(...i.textMatrix),c.translate(i.x,i.y+i.textRise),m>0?c.scale(g,-1):c.scale(g,1);let R,C;const D=i.textRenderingMode&xe.FILL_STROKE_MASK,N=D===xe.FILL||D===xe.FILL_STROKE,L=D===xe.STROKE||D===xe.FILL_STROKE;if(N&&i.patternFill){c.save();const H=i.fillColor.getPattern(c,this,Jn(c),Le.FILL,t);R=ne(c),c.restore(),c.fillStyle=H}if(L&&i.patternStroke){c.save();const H=i.strokeColor.getPattern(c,this,Jn(c),Le.STROKE,t);C=ne(c),c.restore(),c.strokeStyle=H}let j=i.lineWidth;const K=i.textMatrixScale;if(K===0||j===0?L&&(j=this.getSinglePixelWidth()):j/=K,u!==1&&(c.scale(u,u),j/=u),c.lineWidth=j,a.isInvalidPDFjsFont){const H=[];let J=0;for(const rt of e)H.push(rt.unicode),J+=rt.width;const at=H.join("");if(c.fillText(at,0,0),this.dependencyTracker!==null){const rt=c.measureText(at);this.dependencyTracker.recordBBox(t,this.ctx,-rt.actualBoundingBoxLeft,rt.actualBoundingBoxRight,-rt.actualBoundingBoxAscent,rt.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=J*S*g,c.restore(),this.compose();return}let Y=0,$;for($=0;$<v;++$){const H=e[$];if(typeof H=="number"){Y+=_*H*l/1e3;continue}let J=!1;const at=(H.isSpace?f:0)+d,rt=H.fontChar,pt=H.accent;let P,q,tt=H.width;if(w){const k=H.vmetric||x,V=-(H.vmetric?k[1]:tt*.5)*S,Z=k[2]*S;tt=k?-k[0]:tt,P=V/u,q=(Y+Z)/u}else P=Y/u,q=0;let mt;if(a.remeasure&&tt>0){mt=c.measureText(rt);const k=mt.width*1e3/l*u;if(tt<k&&this.isFontSubpixelAAEnabled){const V=tt/k;J=!0,c.save(),c.scale(V,1),P/=V}else tt!==k&&(P+=(tt-k)/2e3*l/u)}if(this.contentVisible&&(H.isInFont||a.missingFile)){if(E&&!pt)c.fillText(rt,P,q),this.dependencyTracker?.recordCharacterBBox(t,c,mt?{bbox:null}:a,l/u,P,q,()=>mt??c.measureText(rt));else if(this.paintChar(t,rt,P,q,R,C),pt){const k=P+l*pt.offset.x/u,V=q-l*pt.offset.y/u;this.paintChar(t,pt.fontChar,k,V,R,C)}}const St=w?tt*S-at*m:tt*S+at*m;Y+=St,J&&c.restore()}w?i.y-=Y:i.x+=Y*g,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,a=this.current,l=a.font,c=a.fontSize,u=a.fontDirection,d=l.vertical?1:-1,f=a.charSpacing,m=a.wordSpacing,g=a.textHScale*u,v=a.fontMatrix||Nf,w=e.length,_=a.textRenderingMode===xe.INVISIBLE;let x,S,E,R;if(_||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),a.textMatrix&&i.transform(...a.textMatrix),i.translate(a.x,a.y+a.textRise),i.scale(g,u);const C=this.dependencyTracker;for(this.dependencyTracker=C?new lu(C,t):null,x=0;x<w;++x){if(S=e[x],typeof S=="number"){R=d*S*c/1e3,this.ctx.translate(R,0),a.x+=R*g;continue}const D=(S.isSpace?m:0)+f,N=l.charProcOperatorList[S.operatorListId];N?this.contentVisible&&(this.save(),i.scale(c,c),i.transform(...v),this.executeOperatorList(N),this.restore()):wt(`Type3 character "${S.operatorListId}" is not available.`);const L=[S.width,0];nt.applyTransform(L,v),E=L[0]*c+D,i.translate(E,0),a.x+=E*g}i.restore(),C&&(this.dependencyTracker=C)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,a,l,c,u){const d=new Path2D;d.rect(a,l,c-a,u-l),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,a,c,l,u).recordClipBox(t,this.ctx,a,c,l,u),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const a=this.baseTransform||ne(this.ctx),l={createCanvasGraphics:(c,u)=>new rr(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new lu(this.dependencyTracker,u,!0):null)};i=new Sp(e,this.ctx,l,a)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let a;return this.cachedPatterns.has(e)?a=this.cachedPatterns.get(e):(a=VD(this.getObject(t,e)),this.cachedPatterns.set(e,a)),i&&(a.matrix=i),a}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const a=this._getPattern(t,e);i.fillStyle=a.getPattern(i,this,Jn(i),Le.SHADING,t);const l=Jn(i);if(l){const{width:c,height:u}=i.canvas,d=Ja.slice();nt.axialAlignedBoundingBox([0,0,c,u],l,d);const[f,m,g,v]=d;this.ctx.fillRect(f,m,g-f,v-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Nn.transform).recordDependencies(t,Nn.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){qt("Should not call beginInlineImage")}beginImageData(){qt("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=ne(this.ctx),i)){nt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[a,l,c,u]=i,d=new Path2D;d.rect(a,l,c-a,u-l),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,a,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||bu("TODO: Support non-isolated groups."),e.knockout&&wt("Knockout groups not supported.");const a=ne(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let l=Ja.slice();nt.axialAlignedBoundingBox(e.bbox,ne(i),l);const c=[0,0,i.canvas.width,i.canvas.height];l=nt.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),d=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),m=Math.max(Math.ceil(l[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,m]);let g="groupAt"+this.groupLevel;e.smask&&(g+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(g,f,m),w=v.context;w.translate(-u,-d),w.transform(...a);let _=new Path2D;const[x,S,E,R]=e.bbox;if(_.rect(x,S,E-x,R-S),e.matrix){const C=new Path2D;C.addPath(_,new DOMMatrix(e.matrix)),_=C}w.clip(_),e.smask&&this.smaskStack.push({canvas:v.canvas,context:w,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(u,d),i.save()),vo(i,w),this.ctx=w,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=ne(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=Ja.slice();nt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],l,c),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,e,i,a,l,c){if(this.#t(),Ic(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const u=i[2]-i[0],d=i[3]-i[1];if(c&&this.annotationCanvasMap){a=a.slice(),a[4]-=i[0],a[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=u,i[3]=d,nt.singularValueDecompose2dScale(ne(this.ctx),pn);const{viewportScale:f}=this,m=Math.ceil(u*this.outputScaleX*f),g=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,g);const{canvas:v,context:w}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=w,this.ctx.save(),this.ctx.setTransform(pn[0],0,0,-pn[1],0,d*pn[1]),Ic(this.ctx)}else{Ic(this.ctx),this.endPath(t);const f=new Path2D;f.rect(i[0],i[1],u,d),this.ctx.clip(f)}}this.current=new Kb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const a=this.ctx,l=this._createMaskCanvas(t,e),c=l.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,a=0,l=0,c,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=ne(d);d.transform(i,a,l,c,0,0);const m=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,m.offsetX-f[4],m.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let g=0,v=u.length;g<v;g+=2){const w=nt.transform(f,[i,a,l,c,u[g],u[g+1]]);d.drawImage(m.canvas,w[4],w[5]),this.dependencyTracker?.recordBBox(t,this.ctx,w[4],w[4]+m.canvas.width,w[5],w[5]+m.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Nn.transformAndFill);for(const c of e){const{data:u,width:d,height:f,transform:m}=c,g=this.cachedCanvases.getCanvas("maskCanvas",d,f),v=g.context;v.save();const w=this.getObject(t,u,c);Zb(v,w),v.globalCompositeOperation="source-in",v.fillStyle=l?a.getPattern(v,this,Jn(i),Le.FILL,t):a,v.fillRect(0,0,d,f),v.restore(),i.save(),i.transform(...m),i.scale(1,-1),Oc(i,g.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,d,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){wt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,a,l){if(!this.contentVisible)return;const c=this.getObject(t,e);if(!c){wt("Dependent image isn't ready yet");return}const u=c.width,d=c.height,f=[];for(let m=0,g=l.length;m<g;m+=2)f.push({transform:[i,0,0,a,l[m],l[m+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:a}=t,l=this.cachedCanvases.getCanvas("inlineImage",i,a),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(e,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,a=e.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/i,-1/a);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const m=this.cachedCanvases.getCanvas("inlineImage",i,a).context;Qb(m,e),u=this.applyTransferMapsToCanvas(m)}const d=this._scaleImage(u,Jn(l));l.imageSmoothingEnabled=Jb(ne(l),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,i,-a,0).recordDependencies(t,Nn.imageXObject).recordOperation(t),Oc(l,d.img,0,0,d.paintWidth,d.paintHeight,0,-a,i,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const a=this.ctx;let l;if(e.bitmap)l=e.bitmap;else{const c=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;Qb(f,e),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of i)a.save(),a.transform(...c.transform),a.scale(1,-1),Oc(a,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Nn.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const l=this.ctx;this.pendingClip?(a||(this.pendingClip===tv?l.clip(e,"evenodd"):l.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ne(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,a)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:a,d:l}=this.ctx.getTransform();let c,u;if(i===0&&a===0){const d=Math.abs(e),f=Math.abs(l);if(d===f)if(t===0)c=u=1/d;else{const m=d*t;c=u=m<1?1/m:1}else if(t===0)c=1/d,u=1/f;else{const m=d*t,g=f*t;c=m<1?1/m:1,u=g<1?1/g:1}}else{const d=Math.abs(e*l-i*a),f=Math.hypot(e,i),m=Math.hypot(a,l);if(t===0)c=m/d,u=f/d;else{const g=t*d;c=m>g?m/g:1,u=f>g?f/g:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:a}}=this,[l,c]=this.getScaleForStroking();if(l===c){i.lineWidth=(a||1)*l,i.stroke(t);return}const u=i.getLineDash();e&&i.save(),i.scale(l,c),df.a=1/l,df.d=1/c;const d=new Path2D;if(d.addPath(t,df),u.length>0){const f=Math.max(l,c);i.setLineDash(u.map(m=>m/f)),i.lineDashOffset/=f}i.lineWidth=a||1,i.stroke(d),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const r in hr)rr.prototype[r]!==void 0&&(rr.prototype[hr[r]]=rr.prototype[r]);class Zs{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class QD{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Qa=Symbol("INTERNAL");class ZD{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:i,usage:a,rbGroups:l}){this.#t=!!(t&dn.DISPLAY),this.#e=!!(t&dn.PRINT),this.name=e,this.intent=i,this.usage=a,this.rbGroups=l}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==Qa&&qt("Internal method `_setVisible` called."),this.#i=i,this.#n=e}}class JD{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=dn.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const i of t.groups)this.#e.set(i.id,new ZD(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(Qa,!1);for(const i of t.on)this.#e.get(i)._setVisible(Qa,!0);for(const i of t.off)this.#e.get(i)._setVisible(Qa,!1);this.#i=this.getHash()}}#r(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let a=1;a<e;a++){const l=t[a];let c;if(Array.isArray(l))c=this.#r(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return wt(`Optional content group not found: ${l}`),!0;switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return bu("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(wt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return wt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return wt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return wt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return wt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return wt(`Unknown optional content policy ${t.policy}.`),!0}return wt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const a=this.#e.get(t);if(!a){wt(`Optional content group not found: ${t}`);return}if(i&&e&&a.rbGroups.length)for(const l of a.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(Qa,!1,!0);a._setVisible(Qa,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":i=a;continue}const l=this.#e.get(a);if(l)switch(i){case"ON":this.setVisibility(a,!0,e);break;case"OFF":this.setVisibility(a,!1,e);break;case"Toggle":this.setVisibility(a,!l.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new tw;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class tN{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Nt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:a,initialData:l,progressiveDone:c,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,l?.length>0){const d=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=a,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((d,f)=>{this._onReceiveData({begin:d,chunk:f})}),t.addProgressListener((d,f)=>{this._onProgress({loaded:d,total:f})}),t.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const a=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(i),!0)});Nt(a,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Nt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new eN(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new nN(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class eN{constructor(t,e,i=!1,a=null){this._stream=t,this._done=i||!1,this._filename=wu(a)?a:null,this._queuedChunks=e||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class nN{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function iN(r){let t=!0,e=i("filename\\*","i").exec(r);if(e){e=e[1];let m=u(e);return m=unescape(m),m=d(m),m=f(m),l(m)}if(e=c(r),e){const m=f(e);return l(m)}if(e=i("filename","i").exec(r),e){e=e[1];let m=u(e);return m=f(m),l(m)}function i(m,g){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function a(m,g){if(m){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const v=new TextDecoder(m,{fatal:!0}),w=Jo(g);g=v.decode(w),t=!1}catch{}}return g}function l(m){return t&&/[\x80-\xff]/.test(m)&&(m=a("utf-8",m),t&&(m=a("iso-8859-1",m))),m}function c(m){const g=[];let v;const w=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=w.exec(m))!==null;){let[,x,S,E]=v;if(x=parseInt(x,10),x in g){if(x===0)break;continue}g[x]=[S,E]}const _=[];for(let x=0;x<g.length&&x in g;++x){let[S,E]=g[x];E=u(E),S&&(E=unescape(E),x===0&&(E=d(E))),_.push(E)}return _.join("")}function u(m){if(m.startsWith('"')){const g=m.slice(1).split('\\"');for(let v=0;v<g.length;++v){const w=g[v].indexOf('"');w!==-1&&(g[v]=g[v].slice(0,w),g.length=v+1),g[v]=g[v].replaceAll(/\\(.)/g,"$1")}m=g.join('"')}return m}function d(m){const g=m.indexOf("'");if(g===-1)return m;const v=m.slice(0,g),_=m.slice(g+1).replace(/^[^']*'/,"");return a(v,_)}function f(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,v,w,_){if(w==="q"||w==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,S){return String.fromCharCode(parseInt(S,16))}),a(v,_);try{_=atob(_)}catch{}return a(v,_)})}return""}function lw(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const i in t){const a=t[i];a!==void 0&&e.append(i,a)}return e}function xu(r){return URL.parse(r)?.origin??null}function cw({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:i}){const a={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(r.get("Content-Length"),10);return!Number.isInteger(l)||(a.suggestedLength=l,l<=2*e)||i||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function uw(r){const t=r.get("Content-Disposition");if(t){let e=iN(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(wu(e))return e}return null}function sl(r,t){return new Fo(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r,r===404||r===0&&t.startsWith("file:"))}function hw(r){return r===200||r===206}function dw(r,t,e){return{method:"GET",headers:r,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function fw(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(wt(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class sN{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=lw(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Nt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new aN(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new rN(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class aN{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),a=e.url;fetch(a,dw(i,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=xu(l.url),!hw(l.status))throw sl(l.status,a);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:u,suggestedLength:d}=cw({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=d||this._contentLength,this._filename=uw(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Bi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:fw(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class rN{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const a=t.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${e}-${i-1}`);const c=a.url;fetch(c,dw(l,this._withCredentials,this._abortController)).then(u=>{const d=xu(u.url);if(d!==t._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${t._responseOrigin}".`);if(!hw(u.status))throw sl(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:fw(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const ff=200,pf=206;function oN(r){const t=r.response;return typeof t!="string"?t:Jo(t).buffer}class lN{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=lw(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,a=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[l,c]of this.headers)e.setRequestHeader(l,c);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),a.expectedStatus=pf):a.expectedStatus=ff,e.responseType="arraybuffer",Nt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),a.onHeadersReceived=t.onHeadersReceived,a.onDone=t.onDone,a.onError=t.onError,a.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const a=i.xhr;if(a.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),a.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],a.status===0&&this.isHttp){i.onError(a.status);return}const l=a.status||ff;if(!(l===ff&&i.expectedStatus===pf)&&l!==i.expectedStatus){i.onError(a.status);return}const u=oN(a);if(l===pf){const d=a.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);f?i.onDone({begin:parseInt(f[1],10),chunk:u}):(wt('Missing or invalid "Content-Range" header.'),i.onError(0))}else u?i.onDone({begin:0,chunk:u}):i.onError(a.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class cN{constructor(t){this._source=t,this._manager=new lN(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Nt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new uN(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new hN(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class uN{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=xu(e.responseURL);const i=e.getAllResponseHeaders(),a=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[d,...f]=u.split(": ");return[d,f.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=cw({responseHeaders:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=uw(a),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=sl(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class hN{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=xu(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=sl(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const dN=/^[a-z][a-z0-9\-+.]+:/i;function fN(r){if(dN.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}class pN{constructor(t){this.source=t,this.url=fN(t.url),Nt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Nt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new mN(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new gN(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class mN{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(a=>{this._contentLength=a.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},a=>{a.code==="ENOENT"&&(a=sl(0,this._url.href)),this._storedError=a,this._headersCapability.reject(a)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Bi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class gN{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const a=t.source;this._isStreamingSupported=!a.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const wo=Symbol("INITIAL_DATA");class pw{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:wo}}get(t,e=null){if(e){const a=this.#e(t);return a.promise.then(()=>e(a.data)),null}const i=this.#t[t];if(!i||i.data===wo)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==wo}delete(t){const e=this.#t[t];return!e||e.data===wo?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==wo&&(yield[t,e])}}}const yN=1e5,ev=30;class Je{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#S=null;static#x=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#m=t;else if(typeof t=="object")this.#m=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=i.scale*Hn.pixelRatio,this.#d=i.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:l,pageX:c,pageY:u}=i.rawDims;this.#y=[1,0,0,-1,-c,u+l],this.#o=a,this.#s=l,Je.#D(),e.style.setProperty("--min-font-size",Je.#S),Es(e,i),this.#t.promise.finally(()=>{Je.#x.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=ve.platform;return yt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#r??=e.lang,Object.assign(this.#f,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#m.getReader(),Je.#x.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*Hn.pixelRatio,a=t.rotation;if(a!==this.#d&&(e?.(),this.#d=a,Es(this.#l,{rotation:a})),i!==this.#h){e?.(),this.#h=i;const l={div:null,properties:null,ctx:Je.#N(this.#r)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#_(l)}}cancel(){const t=new Bi("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#C(t){if(this.#i)return;this.#a.ctx??=Je.#N(this.#r);const e=this.#u,i=this.#g;for(const a of t){if(e.length>yN){wt("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),l.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(a.str),this.#w(a)}}#w(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const a=nt.transform(this.#y,t.transform);let l=Math.atan2(a[1],a[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#n&&c.fontSubstitution||c.fontFamily;u=Je.fontFamilyMap.get(u)||u;const d=Math.hypot(a[2],a[3]),f=d*Je.#j(u,c,this.#r);let m,g;l===0?(m=a[4],g=a[5]-f):(m=a[4]+f*Math.sin(l),g=a[5]-f*Math.cos(l));const v=e.style;v.left=`${(100*m/this.#o).toFixed(2)}%`,v.top=`${(100*g/this.#s).toFixed(2)}%`,v.setProperty("--font-height",`${d.toFixed(2)}px`),v.fontFamily=u,i.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(i.angle=l*(180/Math.PI));let w=!1;if(t.str.length>1)w=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),x=Math.abs(t.transform[3]);_!==x&&Math.max(_,x)/Math.min(_,x)>1.5&&(w=!0)}if(w&&(i.canvasWidth=c.vertical?t.height:t.width),this.#p.set(e,i),this.#a.div=e,this.#a.properties=i,this.#_(this.#a),i.hasText&&this.#e.append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#_(t){const{div:e,properties:i,ctx:a}=t,{style:l}=e;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=l,{canvasWidth:u,fontSize:d}=i;Je.#R(a,d*this.#h,c);const{width:f}=a.measureText(e.textContent);f>0&&l.setProperty("--scale-x",u*this.#h/f)}i.angle!==0&&l.setProperty("--rotate",`${i.angle}deg`)}static cleanup(){if(!(this.#x.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#N(t=null){let e=this.#b.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#R(t,e,i){const a=this.#E.get(t);e===a.size&&i===a.family||(t.font=`${e}px ${i}`,a.size=e,a.family=i)}static#D(){if(this.#S!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#S=t.getBoundingClientRect().height,t.remove()}static#j(t,e,i){const a=this.#v.get(t);if(a)return a;const l=this.#N(i);l.canvas.width=l.canvas.height=ev,this.#R(l,ev,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,d=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+d):(ve.platform.isFirefox&&wt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#v.set(t,f),f}}const bN=100;function mw(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new _p,{docId:e}=t,i=r.url?TD(r.url):null,a=r.data?CD(r.data):null,l=r.httpHeaders||null,c=r.withCredentials===!0,u=r.password??null,d=r.range instanceof Ep?r.range:null,f=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let m=r.worker instanceof dr?r.worker:null;const g=r.verbosity,v=typeof r.docBaseUrl=="string"&&!el(r.docBaseUrl)?r.docBaseUrl:null,w=Nc(r.cMapUrl),_=r.cMapPacked!==!1,x=r.CMapReaderFactory||(Ue?OD:zb),S=Nc(r.iccUrl),E=Nc(r.standardFontDataUrl),R=r.StandardFontDataFactory||(Ue?ID:Hb),C=Nc(r.wasmUrl),D=r.WasmFactory||(Ue?PD:Vb),N=r.stopAtErrors!==!0,L=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,j=r.isEvalSupported!==!1,K=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Ue,Y=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!Ue&&(ve.platform.isFirefox||!globalThis.chrome),$=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,H=typeof r.disableFontFace=="boolean"?r.disableFontFace:Ue,J=r.fontExtraProperties===!0,at=r.enableXfa===!0,rt=r.ownerDocument||globalThis.document,pt=r.disableRange===!0,P=r.disableStream===!0,q=r.disableAutoFetch===!0,tt=r.pdfBug===!0,mt=r.CanvasFactory||(Ue?LD:ND),St=r.FilterFactory||(Ue?kD:MD),k=r.enableHWA===!0,V=r.useWasm!==!1,Z=d?d.length:r.length??NaN,et=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Ue&&!H,ut=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(x===zb&&R===Hb&&D===Vb&&w&&E&&C&&To(w,document.baseURI)&&To(E,document.baseURI)&&To(C,document.baseURI)),gt=null;rD(g);const ht={canvasFactory:new mt({ownerDocument:rt,enableHWA:k}),filterFactory:new St({docId:e,ownerDocument:rt}),cMapReaderFactory:ut?null:new x({baseUrl:w,isCompressed:_}),standardFontDataFactory:ut?null:new R({baseUrl:E}),wasmFactory:ut?null:new D({baseUrl:C})};m||(m=dr.create({verbosity:g,port:Zs.workerPort}),t._worker=m);const ae={docId:e,apiVersion:"5.4.530",data:a,password:u,disableAutoFetch:q,rangeChunkSize:f,length:Z,docBaseUrl:v,enableXfa:at,evaluatorOptions:{maxImageSize:L,disableFontFace:H,ignoreErrors:N,isEvalSupported:j,isOffscreenCanvasSupported:K,isImageDecoderSupported:Y,canvasMaxAreaInBytes:$,fontExtraProperties:J,useSystemFonts:et,useWasm:V,useWorkerFetch:ut,cMapUrl:w,iccUrl:S,standardFontDataUrl:E,wasmUrl:C}},Pt={ownerDocument:rt,pdfBug:tt,styleElement:gt,loadingParams:{disableAutoFetch:q,enableXfa:at}};return m.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const Gn=m.messageHandler.sendWithPromise("GetDocRequest",ae,a?[a.buffer]:null);let qn;if(d)qn=new tN(d,{disableRange:pt,disableStream:P});else if(!a){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Ln=To(i)?sN:Ue?pN:cN;qn=new Ln({url:i,length:Z,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:pt,disableStream:P})}return Gn.then(Ln=>{if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const aa=new Co(e,Ln,m.port),$n=new xN(aa,t,qn,Pt,ht,k);t._transport=$n,aa.send("Ready",null)})}).catch(t._capability.reject),t}class _p{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${_p.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Ep{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#r=[];constructor(t,e,i=!1,a=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=a}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#r)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#n)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){qt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class vN{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return yt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class wN{#t=!1;constructor(t,e,i,a=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=a?new Ob:null,this._pdfBug=a,this.commonObjs=i.commonObjs,this.objs=new pw,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:a=0,dontFlip:l=!1}={}){return new tl({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:a,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return yt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:a="display",annotationMode:l=Di.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:g=null,isEditing:v=!1,recordOperations:w=!1,operationsFilter:_=null}){this._stats?.time("Overall");const x=this._transport.getRenderingIntent(a,l,g,v),{renderingIntent:S,cacheKey:E}=x;this.#t=!1,d||=this._transport.getOptionalContentConfig(S);let R=this._intentStates.get(E);R||(R=Object.create(null),this._intentStates.set(E,R)),R.streamReaderCancelTimeout&&(clearTimeout(R.streamReaderCancelTimeout),R.streamReaderCancelTimeout=null);const C=!!(S&dn.PRINT);R.displayReadyCapability||(R.displayReadyCapability=Promise.withResolvers(),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(x));const D=!!(this._pdfBug&&globalThis.StepperManager?.enabled),N=!this.recordedBBoxes&&(w||D),L=Y=>{if(R.renderTasks.delete(j),N){const $=j.gfx?.dependencyTracker.take();$&&(j.stepper&&j.stepper.setOperatorBBoxes($,j.gfx.dependencyTracker.takeDebugMetadata()),w&&(this.recordedBBoxes=$))}C&&(this.#t=!0),this.#e(),Y?(j.capability.reject(Y),this._abortOperatorList({intentState:R,reason:Y instanceof Error?Y:new Error(Y)})):j.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},j=new tr({callback:L,params:{canvas:e,canvasContext:t,dependencyTracker:N?new BD(e,R.operatorList.length,D):null,viewport:i,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:R.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:m,enableHWA:this._transport.enableHWA,operationsFilter:_});(R.renderTasks||=new Set).add(j);const K=j.task;return Promise.all([R.displayReadyCapability.promise,d]).then(([Y,$])=>{if(this.destroyed){L();return}if(this._stats?.time("Rendering"),!($.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");j.initializeGraphics({transparency:Y,optionalContentConfig:$}),j.operatorListChanged()}).catch(L),K}getOperatorList({intent:t="display",annotationMode:e=Di.ENABLE,printAnnotationStorage:i=null,isEditing:a=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const c=this._transport.getRenderingIntent(t,e,i,a,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>zo.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,a){function l(){c.read().then(function({value:d,done:f}){if(f){i(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),l()},a)}const c=e.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new Ob),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,a=t.length;i<a;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:a}){const{map:l,transfer:c}=i,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:l,modifiedIds:a},c).getReader(),f=this._intentStates.get(e);f.streamReader=d;const m=()=>{d.read().then(({value:g,done:v})=>{if(v){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,f),m())},g=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const v of f.renderTasks)v.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(g);else if(f.opListReadCapability)f.opListReadCapability.reject(g);else throw g}})};m()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof vu){let a=bN;e.extraDelay>0&&e.extraDelay<1e3&&(a+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},a);return}}if(t.streamReader.cancel(new Bi(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,l]of this._intentStates)if(l===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var vs,jn,Ri,Ws,uu,Ks,Qs,ze,qc,gw,yw,Ro,or,$c;const Jt=class Jt{constructor({name:t=null,port:e=null,verbosity:i=oD()}={}){Qn(this,ze);Qn(this,vs,Promise.withResolvers());Qn(this,jn,null);Qn(this,Ri,null);Qn(this,Ws,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Zt(Jt,Qs).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Zt(Jt,Qs).set(e,this),Zn(this,ze,gw).call(this,e)}else Zn(this,ze,yw).call(this)}get promise(){return Zt(this,vs).promise}get port(){return Zt(this,Ri)}get messageHandler(){return Zt(this,jn)}destroy(){this.destroyed=!0,Zt(this,Ws)?.terminate(),Ke(this,Ws,null),Zt(Jt,Qs).delete(Zt(this,Ri)),Ke(this,Ri,null),Zt(this,jn)?.destroy(),Ke(this,jn,null)}static create(t){const e=Zt(this,Qs).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Jt(t)}static get workerSrc(){if(Zs.workerSrc)return Zs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return yt(this,"_setupFakeWorkerGlobal",(async()=>Zt(this,or,$c)?Zt(this,or,$c):(await import(this.workerSrc)).WorkerMessageHandler)())}};vs=new WeakMap,jn=new WeakMap,Ri=new WeakMap,Ws=new WeakMap,uu=new WeakMap,Ks=new WeakMap,Qs=new WeakMap,ze=new WeakSet,qc=function(){Zt(this,vs).resolve(),Zt(this,jn).send("configure",{verbosity:this.verbosity})},gw=function(t){Ke(this,Ri,t),Ke(this,jn,new Co("main","worker",t)),Zt(this,jn).on("ready",()=>{}),Zn(this,ze,qc).call(this)},yw=function(){if(Zt(Jt,Ks)||Zt(Jt,or,$c)){Zn(this,ze,Ro).call(this);return}let{workerSrc:t}=Jt;try{Jt._isSameOrigin(window.location,t)||(t=Jt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Co("main","worker",e),a=()=>{l.abort(),i.destroy(),e.terminate(),this.destroyed?Zt(this,vs).reject(new Error("Worker was destroyed")):Zn(this,ze,Ro).call(this)},l=new AbortController;e.addEventListener("error",()=>{Zt(this,Ws)||a()},{signal:l.signal}),i.on("test",u=>{if(l.abort(),this.destroyed||!u){a();return}Ke(this,jn,i),Ke(this,Ri,e),Ke(this,Ws,e),Zn(this,ze,qc).call(this)}),i.on("ready",u=>{if(l.abort(),this.destroyed){a();return}try{c()}catch{Zn(this,ze,Ro).call(this)}});const c=()=>{const u=new Uint8Array;i.send("test",u,[u.buffer])};c();return}catch{bu("The worker has been disabled.")}Zn(this,ze,Ro).call(this)},Ro=function(){Zt(Jt,Ks)||(wt("Setting up fake worker."),Ke(Jt,Ks,!0)),Jt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Zt(this,vs).reject(new Error("Worker was destroyed"));return}const e=new DD;Ke(this,Ri,e);const i=`fake${Ry(Jt,uu)._++}`,a=new Co(i+"_worker",i,e);t.setup(a,e),Ke(this,jn,new Co(i,i+"_worker",e)),Zn(this,ze,qc).call(this)}).catch(t=>{Zt(this,vs).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},or=new WeakSet,$c=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Qn(Jt,or),Qn(Jt,uu,0),Qn(Jt,Ks,!1),Qn(Jt,Qs,new WeakMap),Ue&&(Ke(Jt,Ks,!0),Zs.workerSrc||="./pdf.worker.mjs"),Jt._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const a=new URL(e,i);return i.origin===a.origin},Jt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Jt.fromPort=t=>{if(gD("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Jt.create(t)};let dr=Jt;class xN{#t=new Map;#e=new Map;#i=new Map;#n=new Map;#r=null;constructor(t,e,i,a,l,c){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new pw,this.fontLoader=new SD({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#a(t,e=null){const i=this.#t.get(t);if(i)return i;const a=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,a),a}get annotationStorage(){return yt(this,"annotationStorage",new wp)}getRenderingIntent(t,e=Di.ENABLE,i=null,a=!1,l=!1){let c=dn.DISPLAY,u=Lf;switch(t){case"any":c=dn.ANY;break;case"display":break;case"print":c=dn.PRINT;break;default:wt(`getRenderingIntent - invalid intent: ${t}`)}const d=c&dn.PRINT&&i instanceof ew?i:this.annotationStorage;switch(e){case Di.DISABLE:c+=dn.ANNOTATIONS_DISABLE;break;case Di.ENABLE:break;case Di.ENABLE_FORMS:c+=dn.ANNOTATIONS_FORMS;break;case Di.ENABLE_STORAGE:c+=dn.ANNOTATIONS_STORAGE,u=d.serializable;break;default:wt(`getRenderingIntent - invalid annotationMode: ${e}`)}a&&(c+=dn.IS_EDITING),l&&(c+=dn.OPLIST);const{ids:f,hash:m}=d.modifiedIds,g=[c,u.hash,m];return{renderingIntent:c,cacheKey:g.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Je.cleanup(),this._networkStream?.cancelAllRequests(new Bi("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,a)=>{Nt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},a.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){a.close();return}Nt(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{this._fullReader.cancel(l),a.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:a,isRangeSupported:l,contentLength:c}=this._fullReader;return(!a||!l)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:a,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(i,a)=>{Nt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(i.begin,i.end);if(!l){a.close();return}a.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){a.close();return}Nt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{a.error(c)})},a.onCancel=c=>{l.cancel(c),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new vN(i,this))}),t.on("DocException",i=>{e._capability.reject(Qe(i))}),t.on("PasswordRequest",i=>{this.#r=Promise.withResolvers();try{if(!e.onPassword)throw Qe(i);const a=l=>{l instanceof Error?this.#r.reject(l):this.#r.resolve({password:l})};e.onPassword(a,i.code)}catch(a){this.#r.reject(a)}return this.#r.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,a,l])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(a){case"Font":if("error"in l){const g=l.error;wt(`Error during font loading: ${g}`),this.commonObjs.resolve(i,g);break}const c=new Ht(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(g,v)=>globalThis.FontInspector.fontAdded(g,v):null,d=new _D(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(i,d)});break;case"CopyLocalImage":const{imageRef:f}=l;Nt(f,"The imageRef must be defined.");for(const g of this.#e.values())for(const[,v]of g.objs)if(v?.ref===f)return v.dataLen?(this.commonObjs.resolve(i,structuredClone(v)),v.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new ED(l));break;case"Image":this.commonObjs.resolve(i,l);break;case"Pattern":const m=new Ee(l);this.commonObjs.resolve(i,m.getIR());break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([i,a,l,c])=>{if(this.destroyed)return;const u=this.#e.get(a);if(!u.objs.has(i)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(i,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[i.type];if(!a)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&wt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#i.get(e);if(i)return i;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#n.set(l.refStr,t);const c=new wN(e,l,this,this._params.pdfBug);return this.#e.set(e,c),c});return this.#i.set(e,a),a}getPageIndex(t){return Of(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#a("GetOptionalContentConfig").then(e=>new JD(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new QD(a[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:a[2]}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Je.cleanup()}}cachedPageNumber(t){if(!Of(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#n.get(e)??null}}class AN{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class tr{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:a,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:m=!1,pdfBug:g=!1,pageColors:v=null,enableHWA:w=!1,operationsFilter:_=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=a,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=g,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new AN(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=w,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=_}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(tr.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");tr.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:a,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new rr(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:a,viewport:i,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),tr.#e.delete(this._canvas),t||=new vu(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),tr.#e.delete(this._canvas),this.callback())))}}const bw="5.4.530",vw="50cc4adac";class fn{#t=null;#e=null;#i;#n=null;#r=!1;#a=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return yt(this,"_keyboardManager",new nl([[["Escape","mac+Escape"],fn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],fn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],fn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],fn.prototype._moveToPrevious],[["Home","mac+Home"],fn.prototype._moveToBeginning],[["End","mac+End"],fn.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#a=!1,this.#s=t):this.#a=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",fn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,t.append(i),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",mn,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[i,a]of this.#l.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",a),l.title=i,l.setAttribute("data-l10n-id",fn.#d[i]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=a,l.ariaSelected=a===this.#i,l.addEventListener("click",this.#f.bind(this,a),{signal:e}),t.append(l)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Rt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#m(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#m(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#m(t);return}this.#n.lastElementChild?.focus()}#g(t){fn._keyboardManager.exec(this,t)}#m(t){if(this.#p){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}}class Ho{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,Ho.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:i}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=i||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",Ho.#n[t]),a.addEventListener("input",()=>{this.#i.updateParams(e,a.value)},{signal:this.#i._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function nv(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function xo(r){return Math.max(0,Math.min(255,255*r))}class iv{static CMYK_G([t,e,i,a]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=xo(t),[t,t,t]}static G_HTML([t]){const e=nv(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(xo)}static RGB_HTML(t){return`#${t.map(nv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,i+a),1-Math.min(1,e+a)]}static CMYK_rgb([t,e,i,a]){return[xo(1-Math.min(1,t+a)),xo(1-Math.min(1,i+a)),xo(1-Math.min(1,e+a))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const a=1-t,l=1-e,c=1-i,u=Math.min(a,l,c);return["CMYK",a,l,c,u]}}class SN{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),i||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${e}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){qt("Abstract method `_createSVG` called.")}}class Vo extends SN{_createSVG(t){return document.createElementNS(Ci,t)}}const _N=9,ea=new WeakSet,EN=new Date().getTimezoneOffset()*60*1e3;class mf{static create(t){switch(t.data.annotationType){case he.LINK:return new Tp(t);case he.TEXT:return new CN(t);case he.WIDGET:switch(t.data.fieldType){case"Tx":return new RN(t);case"Btn":return t.data.radioButton?new ww(t):t.data.checkBox?new NN(t):new MN(t);case"Ch":return new kN(t);case"Sig":return new DN(t)}return new sa(t);case he.POPUP:return new jf(t);case he.FREETEXT:return new xw(t);case he.LINE:return new ON(t);case he.SQUARE:return new IN(t);case he.CIRCLE:return new PN(t);case he.POLYLINE:return new Aw(t);case he.CARET:return new BN(t);case he.INK:return new Cp(t);case he.POLYGON:return new jN(t);case he.HIGHLIGHT:return new Sw(t);case he.UNDERLINE:return new UN(t);case he.SQUIGGLY:return new FN(t);case he.STRIKEOUT:return new zN(t);case he.STAMP:return new _w(t);case he.FILEATTACHMENT:return new HN(t);default:return new se(t)}}}class se{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(i)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return se._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:a}=this.data;let l=-1/0,c=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>c?(c=e[u+1],l=e[u+2]):e[u+1]===c&&(l=Math.max(l,e[u+2]));return[l,c]}if(i?.length>=1){for(const u of i)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>c?(c=u[d+1],l=u[d]):u[d+1]===c&&(l=Math.max(l,u[d]));if(l!==1/0)return[l,c]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-l)/i,t[1]=100*(t[1]-c)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Uo}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Uo}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#n(e);let a=this.#i?.popup||this.popup;!a&&i?.text&&(this._createPopup(i),a=this.#i.popup),a&&(a.updateEdited(t),i?.deleted&&(a.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:i,rotation:a},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:d}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-u)/l}%`,e.top=`${100*(c-t[3]+d)/c}%`,a===0?(e.width=`${100*(t[2]-t[0])/l}%`,e.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(a)}_createContainer(t){const{data:e,parent:{page:i,viewport:a}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",e.id),!(this instanceof sa)&&!(this instanceof Tp)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(l.title=e.alternativeText),e.noRotate&&l.classList.add("norotate"),!e.rect||this instanceof jf){const{rotation:x}=e;return!e.hasOwnCanvas&&x!==0&&this.setRotation(x,l),l}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){c.borderWidth=`${e.borderStyle.width}px`;const x=e.borderStyle.horizontalCornerRadius,S=e.borderStyle.verticalCornerRadius;if(x>0||S>0){const R=`calc(${x}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;c.borderRadius=R}else if(this instanceof ww){const R=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;c.borderRadius=R}switch(e.borderStyle.style){case Ka.SOLID:c.borderStyle="solid";break;case Ka.DASHED:c.borderStyle="dashed";break;case Ka.BEVELED:wt("Unimplemented border style: beveled");break;case Ka.INSET:wt("Unimplemented border style: inset");break;case Ka.UNDERLINE:c.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,c.borderColor=nt.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):c.borderWidth=0}const f=nt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:m,pageHeight:g,pageX:v,pageY:w}=a.rawDims;c.left=`${100*(f[0]-v)/m}%`,c.top=`${100*(f[1]-w)/g}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(c.width=`${100*u/m}%`,c.height=`${100*d/g}%`):this.setRotation(_,l),l}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:a}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),e.style.width=`${100*l/i}%`,e.style.height=`${100*c/a}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,a)=>{const l=a.detail[e],c=l[0],u=l.slice(1);a.target.style[i]=iv[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[i]:iv[`${c}_rgb`](u)})};return yt(this,"_commonActions",{display:e=>{const{display:i}=e.detail,a=i%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const a of Object.keys(e.detail))(t[a]||i[a])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[a,l]of Object.entries(e)){const c=i[a];if(c){const u={detail:{[a]:l},target:t};c(u),delete e[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,a,l]=this.data.rect.map(x=>Math.fround(x));if(t.length===8){const[x,S,E,R]=t.subarray(2,6);if(a===x&&l===S&&e===E&&i===R)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:x,borderWidth:S}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const d=a-e,f=l-i,{svgFactory:m}=this,g=m.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0),g.role="none";const v=m.createElement("defs");g.append(v);const w=m.createElement("clipPath"),_=`clippath_${this.data.id}`;w.setAttribute("id",_),w.setAttribute("clipPathUnits","objectBoundingBox"),v.append(w);for(let x=2,S=t.length;x<S;x+=8){const E=t[x],R=t[x+1],C=t[x+2],D=t[x+3],N=m.createElement("rect"),L=(C-e)/d,j=(l-R)/f,K=(E-C)/d,Y=(R-D)/f;N.setAttribute("x",L),N.setAttribute("y",j),N.setAttribute("width",K),N.setAttribute("height",Y),w.append(N),u?.push(`<rect vector-effect="non-scaling-stroke" x="${L}" y="${j}" width="${K}" height="${Y}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(g),this.container.style.clipPath=`url(#${_})`}_createPopup(t=null){const{data:e}=this;let i,a;t?(i={str:t.text},a=t.date):(i=e.contentsObj,a=e.modificationDate),this.#i=new jf({data:{color:e.color,titleObj:e.titleObj,modificationDate:a,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){qt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:l,id:c,exportValues:u}of a){if(l===-1||c===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!ea.has(f)){wt(`_getElementsByName - element not allowed: ${c}`);continue}i.push({id:c,exportValue:d,domElement:f})}return i}for(const a of document.getElementsByName(t)){const{exportValue:l}=a,c=a.getAttribute("data-element-id");c!==e&&ea.has(a)&&i.push({id:c,exportValue:l,domElement:a})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class TN extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Tp extends se{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let a=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#i(i,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),a=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(i,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=i,this.container.append(i)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",a=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,a),!1),this.#t()}#i(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(e.actions)){const l=i.get(a);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:a}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){wt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:a,refs:l,include:c}=e,u=[];if(a.length!==0||l.length!==0){const m=new Set(l);for(const g of a){const v=this._fieldObjects[g]||[];for(const{id:w}of v)m.add(w)}for(const g of Object.values(this._fieldObjects))for(const v of g)m.has(v.id)===c&&u.push(v)}else for(const m of Object.values(this._fieldObjects))u.push(...m);const d=this.annotationStorage,f=[];for(const m of u){const{id:g}=m;switch(f.push(g),m.type){case"text":{const w=m.defaultValue||"";d.setValue(g,{value:w});break}case"checkbox":case"radiobutton":{const w=m.defaultValue===m.exportValues;d.setValue(g,{value:w});break}case"combobox":case"listbox":{const w=m.defaultValue||"";d.setValue(g,{value:w});break}default:continue}const v=document.querySelector(`[data-element-id="${g}"]`);if(v){if(!ea.has(v)){wt(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class CN extends se{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class sa extends se{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return ve.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,a,l){i.includes("mouse")?t.addEventListener(i,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(i,c=>{if(i==="blur"){if(!e.focused||!c.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:l(c)}})})}_setEventListeners(t,e,i,a){for(const[l,c]of i)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,l,c,a),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":nt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||_N,l=t.style;let c;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),m=Math.round(f/(of*a))||1,g=f/m;c=Math.min(a,d(g/of))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(a,d(f/of))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=nt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(l.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class RN extends sa{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,a){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[e]=i),l.setValue(c.id,{[a]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let l=a.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),ea.add(i),this.contentElement=i,i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:m,timeStep:g}=this.data,v=!!m&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",_=>{t.setValue(e,{value:_.target.value}),this.setPropertyOnSiblings(i,"value",_.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",_=>{const x=this.data.defaultFieldValue??"";i.value=d.userValue=x,d.formattedValue=null});let w=_=>{const{formattedValue:x}=d;x!=null&&(_.target.value=x),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",x=>{if(d.focused)return;const{target:S}=x;if(v&&(S.type=m,g&&(S.step=g)),d.userValue){const E=d.userValue;if(v)if(m==="time"){const R=new Date(E),C=[R.getHours(),R.getMinutes(),R.getSeconds()];S.value=C.map(D=>D.toString().padStart(2,"0")).join(":")}else S.value=new Date(E-EN).toISOString().split(m==="date"?"T":".",1)[0];else S.value=E}d.lastCommittedValue=S.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const S={value(E){d.userValue=E.detail.value??"",v||t.setValue(e,{value:d.userValue.toString()}),E.target.value=d.userValue},formattedValue(E){const{formattedValue:R}=E.detail;d.formattedValue=R,R!=null&&E.target!==document.activeElement&&(E.target.value=R);const C={formattedValue:R};v&&(C.value=R),t.setValue(e,C)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:R}=E.detail,{target:C}=E;if(R===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",R);let D=d.userValue;!D||D.length<=R||(D=D.slice(0,R),C.value=d.userValue=D,t.setValue(e,{value:D}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(S,x)}),i.addEventListener("keydown",x=>{d.commitKey=1;let S=-1;if(x.key==="Escape"?S=0:x.key==="Enter"&&!this.data.multiLine?S=2:x.key==="Tab"&&(d.commitKey=3),S===-1)return;const{value:E}=x.target;d.lastCommittedValue!==E&&(d.lastCommittedValue=E,d.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:S,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const _=w;w=null,i.addEventListener("blur",x=>{if(!d.focused||!x.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:S}=x;let{value:E}=S;if(v){if(E&&m==="time"){const R=E.split(":").map(C=>parseInt(C,10));E=new Date(2e3,0,1,R[0],R[1],R[2]||0).valueOf(),S.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();S.type="text"}d.userValue=E,d.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:d.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}),_(x)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",x=>{d.lastCommittedValue=null;const{data:S,target:E}=x,{value:R,selectionStart:C,selectionEnd:D}=E;let N=C,L=D;switch(x.inputType){case"deleteWordBackward":{const j=R.substring(0,C).match(/\w*[^\w]*$/);j&&(N-=j[0].length);break}case"deleteWordForward":{const j=R.substring(C).match(/^[^\w]*\w*/);j&&(L+=j[0].length);break}case"deleteContentBackward":C===D&&(N-=1);break;case"deleteContentForward":C===D&&(L+=1);break}x.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,change:S||"",willCommit:!1,selStart:N,selEnd:L}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(w&&i.addEventListener("blur",w),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${x}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class DN extends sa{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class NN extends sa{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let a=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(i,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return ea.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=e.fieldName,a&&l.setAttribute("checked",!0),l.setAttribute("exportValue",e.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i)){const m=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=m),t.setValue(f.id,{value:m})}t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue||"Off";c.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(i,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class ww extends sa{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let a=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof a=="string"&&(a=a!==e.buttonValue,t.setValue(i,{value:a})),a)for(const c of this._getElementsByName(e.fieldName,i))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(ea.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=e.fieldName,a&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue;c.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const c=e.buttonValue;l.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const m=c===f.detail.value;for(const g of this._getElementsByName(f.target.name)){const v=m&&g.id===i;g.domElement&&(g.domElement.checked=v),t.setValue(g.id,{value:v})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class MN extends Tp{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class kN extends sa{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),a=document.createElement("select");ea.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",m=>{const g=this.data.defaultFieldValue;for(const v of a.options)v.selected=v.value===g});for(const m of this.data.options){const g=document.createElement("option");g.textContent=m.displayValue,g.value=m.exportValue,i.value.includes(m.exportValue)&&(g.setAttribute("selected",!0),l=!1),a.append(g)}let c=null;if(l){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),a.prepend(m),c=()=>{m.remove(),a.removeEventListener("input",c),c=null},a.addEventListener("input",c)}const u=m=>{const g=m?"value":"textContent",{options:v,multiple:w}=a;return w?Array.prototype.filter.call(v,_=>_.selected).map(_=>_[g]):v.selectedIndex===-1?null:v[v.selectedIndex][g]};let d=u(!1);const f=m=>{const g=m.target.options;return Array.prototype.map.call(g,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",m=>{const g={value(v){c?.();const w=v.detail.value,_=new Set(Array.isArray(w)?w:[w]);for(const x of a.options)x.selected=_.has(x.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(v){a.multiple=!0},remove(v){const w=a.options,_=v.detail.remove;w[_].selected=!1,a.remove(_),w.length>0&&Array.prototype.findIndex.call(w,S=>S.selected)===-1&&(w[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},clear(v){for(;a.length!==0;)a.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(v){const{index:w,displayValue:_,exportValue:x}=v.detail.insert,S=a.children[w],E=document.createElement("option");E.textContent=_,E.value=x,S?S.before(E):a.append(E),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},items(v){const{items:w}=v.detail;for(;a.length!==0;)a.remove(0);for(const _ of w){const{displayValue:x,exportValue:S}=_,E=document.createElement("option");E.textContent=x,E.value=S,a.append(E)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},indices(v){const w=new Set(v.detail.indices);for(const _ of v.target.options)_.selected=w.has(_.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(g,m)}),a.addEventListener("input",m=>{const g=u(!0),v=u(!1);t.setValue(e,{value:g}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:v,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):a.addEventListener("input",function(m){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class jf extends se{constructor(t){const{data:e,elements:i,parent:a}=t,l=!!a._commentManager;if(super(t,{isRenderable:!l&&se._hasPopupData(e)}),this.elements=i,l&&se._hasPopupData(e)){const c=this.popup=this.#t();for(const u of i)u.popup=c}else this.popup=null}#t(){return new LN({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const a of this.elements)a.popup=e,a.container.ariaHasPopup="dialog",i.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(a=>`${Za}${a}`).join(",")),this.container}}class LN{#t=null;#e=this.#G.bind(this);#i=this.#U.bind(this);#n=this.#L.bind(this);#r=this.#A.bind(this);#a=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#v=null;#b=null;#E=null;#S=null;#x=null;#C=!1;#w=null;#_=null;constructor({container:t,color:e,elements:i,titleObj:a,modificationDate:l,contentsObj:c,richText:u,parent:d,rect:f,parentRect:m,open:g,commentManager:v=null}){this.#s=t,this.#S=a,this.#o=c,this.#E=u,this.#d=d,this.#a=e,this.#b=f,this.#h=m,this.#l=i,this.#t=v,this.#w=i[0],this.#c=ru.toDateObject(l),this.trigger=i.flatMap(w=>w.getElementsToTriggerPopup()),v||(this.#N(),this.#s.hidden=!0,g&&this.#A())}#N(){if(this.#m)return;this.#m=new AbortController;const{signal:t}=this.#m;for(const e of this.trigger)e.addEventListener("click",this.#r,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#w.container.after(this.#p);return}if(this.#y||this.#R(),!this.#y)return;const{signal:t}=this.#m=new AbortController,e=this.#w.hasOwnCommentButton,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#w.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#w.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#j(),this.#D(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#D(){if(this.#w.extraPopupElement&&!this.#w.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#y,{style:i}=this.#p;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#j(){this.#w.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#w.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:a,modificationDate:l}=this.#w.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:a,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#_||=this.#w.commentText,this.#_}set comment(t){t!==this.comment&&(this.#w.commentText=this.#_=t)}focus(){this.#w.container?.focus()}get parentBoundingClientRect(){return this.#w.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:e,height:i}=this.#p.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=this.#w.layer.getBoundingClientRect();return[(t-a)/c,(e+i-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#v||this.commentButtonPosition.map(f=>f/100),a=this.parentBoundingClientRect,{x:l,y:c,width:u,height:d}=a;this.#t.showDialog(null,this,l+e*u,c+i*d,{...t,parentDimensions:a})}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#a){const i=t.style.outlineColor=nt.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#S?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#S}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}yp({html:this.#k||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#s.append(t)}get#k(){const t=this.#E,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#O(){return this.#k?.attributes?.style?.fontSize||0}get#B(){return this.#k?.attributes?.style?.color||null}#I(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},a={style:{color:this.#B,fontSize:this.#O?`calc(${this.#O}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))e.push({name:"span",value:l,attributes:a});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#A()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#_=null):e&&(e.deleted?this.remove():(this.#j(),this.#_=e.text)),t&&(this.#y=null,this.#R(),this.#D());return}if(i||e?.deleted){this.remove();return}this.#N(),this.#x||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),e&&e.text&&(this.#E=this.#I(e.text),this.#c=ru.toDateObject(e.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#x&&({contentsObj:this.#o,richText:this.#E}=this.#x,this.#x=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:a,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const _ of this.#l)if(!u||nt.intersect(_.data.rect,u)!==null){u=_.data.rect,c=!0;break}const d=nt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),m=c?u[2]-u[0]+5:0,g=d[0]+m,v=d[1];this.#u=[100*(g-a)/e,100*(v-l)/i];const{style:w}=this.#s;w.left=`${this.#u[0]}%`,w.top=`${this.#u[1]}%`}#A(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#L(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#U(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#L(){this.#g||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#U(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#N(),this.#C&&(this.#g||this.#L(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class xw extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=vt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class ON extends se{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class IN extends se{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",e-l),c.setAttribute("height",i-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class PN extends se{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",e/2),c.setAttribute("cy",i/2),c.setAttribute("rx",e/2-l/2),c.setAttribute("ry",i/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Aw extends se{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:a},width:l,height:c}=this;if(!e)return this.container;const u=this.svgFactory.create(l,c,!0);let d=[];for(let m=0,g=e.length;m<g;m+=2){const v=e[m]-t[0],w=t[3]-e[m+1];d.push(`${v},${w}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class jN extends Aw{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class BN extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Cp extends se{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?vt.HIGHLIGHT:vt.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:a,popupRef:l}}=this,{transform:c,width:u,height:d}=this.#i(e,t),f=this.svgFactory.create(u,d,!0),m=this.#t=this.svgFactory.createElement("svg:g");f.append(m),m.setAttribute("stroke-width",a.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",c);for(let g=0,v=i.length;g<v;g++){const w=this.svgFactory.createElement(this.svgElementName);this.#e.push(w),w.setAttribute("points",i[g].join(",")),m.append(w)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:a}=t,l=this.#t;if(e>=0&&l.setAttribute("stroke-width",e||1),i)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",i[c].join(","));if(a){const{transform:c,width:u,height:d}=this.#i(this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Sw extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=vt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class UN extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class FN extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class zN extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class _w extends se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=vt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class HN extends se{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:a}=ve.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Au{#t=null;#e=null;#i=null;#n=new Map;#r=null;#a=null;#s=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:a,page:l,viewport:c,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:m}){this.div=t,this.#t=e,this.#e=i,this.#r=u||null,this.#a=f||null,this.#i=m||new wp,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=d||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,i=this.div;Es(i,this.viewport);const a=new Map,l=[],c={data:null,layer:i,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Vo,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of e){if(u.noHTML)continue;const d=u.annotationType===he.POPUP;if(d){const g=a.get(u.id);if(!g)continue;if(!this._commentManager){l.push(u);continue}c.elements=g}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=mf.create(c);if(!f.isRenderable)continue;if(!d&&(this.#s.push(f),u.popupRef)){const g=a.get(u.popupRef);g?g.push(f):a.set(u.popupRef,[f])}const m=f.render();u.hidden&&(m.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const d=c.elements=a.get(u.id);c.data=u;const f=mf.create(c);if(!f.isRenderable)continue;const m=f.render();f.contentElement.id=`${Za}${u.id}`,u.hidden&&(m.style.visibility="hidden"),d.at(-1).container.after(m)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:i,data:{id:a}}of this.#s){const l=i.id=`${Za}${a}`;t.push(this.#r?.getAriaAttributes(l).then(c=>{if(c)for(const[u,d]of c)i.setAttribute(u,d)}))}}this.#s.sort(({data:{rect:[i,a,l,c]}},{data:{rect:[u,d,f,m]}})=>{if(i===l&&a===c)return 1;if(u===f&&d===m)return-1;const g=c,v=a,w=(a+c)/2,_=m,x=d,S=(d+m)/2;if(w>=_&&S<=v)return-1;if(S>=g&&w<=x)return 1;const E=(i+l)/2,R=(u+f)/2;return E-R});const e=document.createDocumentFragment();for(const i of this.#s)e.append(i.container),this._commentManager?(i.extraPopupElement?.popup||i.popup)?.renderCommentButton():i.extraPopupElement&&e.append(i.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const i of this.#s)this.#t.addPointerInTextLayer(i.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#a,svgFactory:new Vo,parent:this};for(const i of t){i.borderStyle||=Au._defaultBorderStyle,e.data=i;const a=mf.create(e);a.isRenderable&&(a.render(),a.contentElement.id=`${Za}${i.id}`,this.#s.push(a))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,Es(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const a=t.querySelector(`[data-annotation-id="${e}"]`);if(!a)continue;i.className="annotationContent";const{firstChild:l}=a;l?l.nodeName==="CANVAS"?l.replaceWith(i):l.classList.contains("annotationContent")?l.after(i):l.before(i):a.append(i);const c=this.#n.get(e);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,a.id,i),c._hasNoCanvas=!1):c.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:a}=t,l=new TN({data:{id:i,rect:t.getPDFRect(),rotation:a},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#i});return l.render(),l.contentElement.id=`${Za}${i}`,l.createOrUpdatePopup(),this.#s.push(l),l}removeAnnotation(t){const e=this.#s.findIndex(a=>a.data.id===t);if(e<0)return;const[i]=this.#s.splice(e,1);this.#t?.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return yt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Ka.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Pc=/\r\n?|\n/g;class Te extends ct{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Te.prototype,e=l=>l.isEmpty(),i=Ui.TRANSLATE_SMALL,a=Ui.TRANSLATE_BIG;return yt(this,"_keyboardManager",new nl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:e}]]))}static _type="freetext";static _editorType=vt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Te._defaultColor||ct._defaultLineColor,this.#n=t.fontSize||Te._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){ct.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Rt.FREETEXT_SIZE:Te._defaultFontSize=e;break;case Rt.FREETEXT_COLOR:Te._defaultColor=e;break}}updateParams(t,e){switch(t){case Rt.FREETEXT_SIZE:this.#r(e);break;case Rt.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[Rt.FREETEXT_SIZE,Te._defaultFontSize],[Rt.FREETEXT_COLOR,Te._defaultColor||ct._defaultLineColor]]}get propertiesToUpdate(){return[[Rt.FREETEXT_SIZE,this.#n],[Rt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Ho(this),[["colorPicker",this._colorPicker]]}get colorType(){return Rt.FREETEXT_COLOR}#r(t){const e=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#n)*this.parentScale),this.#n=a,this.#o()},i=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const e=a=>{this.color=a,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Te._internalPadding*t,-(Te._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(Te.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#s().trimEnd();if(t===e)return;const i=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Te._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,m]=this.pageDimensions,[g,v]=this.pageTranslation;let w,_;switch(this.rotation){case 0:w=t+(c[0]-g)/f,_=e+this.height-(c[1]-v)/m;break;case 90:w=t+(c[0]-g)/f,_=e-(c[1]-v)/m,[u,d]=[d,-u];break;case 180:w=t-this.width+(c[0]-g)/f,_=e-(c[1]-v)/m,[u,d]=[-u,-d];break;case 270:w=t+(c[0]-g-this.height*m)/f,_=e+(c[1]-v-this.width*f)/m,[u,d]=[-d,u];break}this.setAt(w*a,_*l,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Pc,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const a=Te.#h(e.getData("text")||"").replaceAll(Pc,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!a.includes(`
`)){c.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:d}=c,f=[],m=[];if(u.nodeType===Node.TEXT_NODE){const w=u.parentElement;if(m.push(u.nodeValue.slice(d).replaceAll(Pc,"")),w!==this.editorDiv){let _=f;for(const x of this.editorDiv.childNodes){if(x===w){_=m;continue}_.push(Te.#c(x))}}f.push(u.nodeValue.slice(0,d).replaceAll(Pc,""))}else if(u===this.editorDiv){let w=f,_=0;for(const x of this.editorDiv.childNodes)_++===d&&(w=m),w.push(Te.#c(x))}this.#t=`${f.join(`
`)}${a}${m.join(`
`)}`,this.#l();const g=new Range;let v=Math.sumPrecise(f.map(w=>w.length));for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const _=w.nodeValue.length;if(v<=_){g.setStart(w,v),g.setEnd(w,v);break}v-=_}l.removeAllRanges(),l.addRange(g)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Te._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let a=null;if(t instanceof xw){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:f,id:m,popupRef:g,richText:v,contentsObj:w,creationDate:_,modificationDate:x},textContent:S,textPosition:E,parent:{page:{pageNumber:R}}}=t;if(!S||S.length===0)return null;a=t={annotationType:vt.FREETEXT,color:Array.from(u),fontSize:c,value:S.join(`
`),position:E,pageIndex:R-1,rect:d.slice(0),rotation:f,annotationElementId:m,id:m,deleted:!1,popupRef:g,comment:w?.str||null,richText:v,creationDate:_,modificationDate:x}}const l=await super.deserialize(t,e,i);return l.#n=t.fontSize,l.color=nt.makeHexColor(...t.color),l.#t=Te.#h(t.value),l._initialData=a,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=ct._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((c,u)=>c!==a[u])||t.pageIndex!==l}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const a of this.#t.split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),e.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class it{static PRECISION=1e-4;toSVGPath(){qt("Abstract method `toSVGPath` must be implemented.")}get box(){qt("Abstract getter `box` must be implemented.")}serialize(t,e){qt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,a,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u]*a,c[u+1]=i+t[u+1]*l;return c}static _rescaleAndSwap(t,e,i,a,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u+1]*a,c[u+1]=i+t[u]*l;return c}static _translate(t,e,i,a){a||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l],a[l+1]=i+t[l+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,a,l){switch(l){case 90:return[1-e/i,t/a];case 180:return[1-t/i,1-e/a];case 270:return[e/i,1-t/a];default:return[t/i,e/a]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,a,l,c){return[(t+5*i)/6,(e+5*a)/6,(5*i+l)/6,(5*a+c)/6,(i+l)/2,(a+c)/2]}}class Xs{#t;#e=[];#i;#n;#r=[];#a=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=Xs.#g+Xs.#m;constructor({x:t,y:e},i,a,l,c,u=0){this.#t=i,this.#h=l*a,this.#n=c,this.#a.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#l=Xs.#g*a,this.#c=Xs.#u*a,this.#d=a,this.#f.push(t,e)}isEmpty(){return isNaN(this.#a[8])}#p(){const t=this.#a.subarray(4,6),e=this.#a.subarray(16,18),[i,a,l,c]=this.#t;return[(this.#s+(t[0]-e[0])/2-i)/l,(this.#o+(t[1]-e[1])/2-a)/c,(this.#s+(e[0]-t[0])/2-i)/l,(this.#o+(e[1]-t[1])/2-a)/c]}add({x:t,y:e}){this.#s=t,this.#o=e;const[i,a,l,c]=this.#t;let[u,d,f,m]=this.#a.subarray(8,12);const g=t-f,v=e-m,w=Math.hypot(g,v);if(w<this.#c)return!1;const _=w-this.#l,x=_/w,S=x*g,E=x*v;let R=u,C=d;u=f,d=m,f+=S,m+=E,this.#f?.push(t,e);const D=-E/_,N=S/_,L=D*this.#h,j=N*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+L,m+j],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-L,m-j],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([u+L,d+j],2),this.#r.push(NaN,NaN,NaN,NaN,(u+L-i)/l,(d+j-a)/c),this.#a.set([u-L,d-j],14),this.#e.push(NaN,NaN,NaN,NaN,(u-L-i)/l,(d-j-a)/c)),this.#a.set([R,C,u,d,f,m],6),!this.isEmpty()):(this.#a.set([R,C,u,d,f,m],6),Math.abs(Math.atan2(C-d,R-u)-Math.atan2(E,S))<Math.PI/2?([u,d,f,m]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-i)/l,((d+m)/2-a)/c),[u,d,R,C]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((R+u)/2-i)/l,((C+d)/2-a)/c),!0):([R,C,u,d,f,m]=this.#a.subarray(0,6),this.#r.push(((R+5*u)/6-i)/l,((C+5*d)/6-a)/c,((5*u+f)/6-i)/l,((5*d+m)/6-a)/c,((u+f)/2-i)/l,((d+m)/2-a)/c),[f,m,u,d,R,C]=this.#a.subarray(12,18),this.#e.push(((R+5*u)/6-i)/l,((C+5*d)/6-a)/c,((5*u+f)/6-i)/l,((5*d+m)/6-a)/c,((u+f)/2-i)/l,((d+m)/2-a)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,e=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?i.push(`L${t[a+4]} ${t[a+5]}`):i.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#b(i);for(let a=e.length-6;a>=6;a-=6)isNaN(e[a])?i.push(`L${e[a+4]} ${e[a+5]}`):i.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);return this.#v(i),i.join(" ")}#y(){const[t,e,i,a]=this.#t,[l,c,u,d]=this.#p();return`M${(this.#a[2]-t)/i} ${(this.#a[3]-e)/a} L${(this.#a[4]-t)/i} ${(this.#a[5]-e)/a} L${l} ${c} L${u} ${d} L${(this.#a[16]-t)/i} ${(this.#a[17]-e)/a} L${(this.#a[14]-t)/i} ${(this.#a[15]-e)/a} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,i,a,l]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[d,f,m,g]=this.#p();t.push(`L${(c[0]-e)/a} ${(c[1]-i)/l} L${d} ${f} L${m} ${g} L${(u[0]-e)/a} ${(u[1]-i)/l}`)}newFreeDrawOutline(t,e,i,a,l,c){return new Ew(t,e,i,a,l,c)}getOutlines(){const t=this.#r,e=this.#e,i=this.#a,[a,l,c,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let g=0,v=d.length-2;g<v;g+=2)d[g]=(this.#f[g]-a)/c,d[g+1]=(this.#f[g+1]-l)/u;if(d[d.length-2]=(this.#s-a)/c,d[d.length-1]=(this.#o-l)/u,isNaN(i[6])&&!this.isEmpty())return this.#E(d);const f=new Float32Array(this.#r.length+24+this.#e.length);let m=t.length;for(let g=0;g<m;g+=2){if(isNaN(t[g])){f[g]=f[g+1]=NaN;continue}f[g]=t[g],f[g+1]=t[g+1]}m=this.#x(f,m);for(let g=e.length-6;g>=6;g-=6)for(let v=0;v<6;v+=2){if(isNaN(e[g+v])){f[m]=f[m+1]=NaN,m+=2;continue}f[m]=e[g+v],f[m+1]=e[g+v+1],m+=2}return this.#S(f,m),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#i,this.#n)}#E(t){const e=this.#a,[i,a,l,c]=this.#t,[u,d,f,m]=this.#p(),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(e[2]-i)/l,(e[3]-a)/c,NaN,NaN,NaN,NaN,(e[4]-i)/l,(e[5]-a)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(e[16]-i)/l,(e[17]-a)/c,NaN,NaN,NaN,NaN,(e[14]-i)/l,(e[15]-a)/c],0),this.newFreeDrawOutline(g,t,this.#t,this.#d,this.#i,this.#n)}#S(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#x(t,e){const i=this.#a.subarray(4,6),a=this.#a.subarray(16,18),[l,c,u,d]=this.#t,[f,m,g,v]=this.#p();return t.set([NaN,NaN,NaN,NaN,(i[0]-l)/u,(i[1]-c)/d,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,g,v,NaN,NaN,NaN,NaN,(a[0]-l)/u,(a[1]-c)/d],e),e+=24}}class Ew extends it{#t;#e=new Float32Array(4);#i;#n;#r;#a;#s;constructor(t,e,i,a,l,c){super(),this.#s=t,this.#r=e,this.#t=i,this.#a=a,this.#i=l,this.#n=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(c);const[u,d,f,m]=this.#e;for(let g=0,v=t.length;g<v;g+=2)t[g]=(t[g]-u)/f,t[g+1]=(t[g+1]-d)/m;for(let g=0,v=e.length;g<v;g+=2)e[g]=(e[g]-u)/f,e[g+1]=(e[g+1]-d)/m}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let e=6,i=this.#s.length;e<i;e+=6){if(isNaN(this.#s[e])){t.push(`L${this.#s[e+4]} ${this.#s[e+5]}`);continue}t.push(`C${this.#s[e]} ${this.#s[e+1]} ${this.#s[e+2]} ${this.#s[e+3]} ${this.#s[e+4]} ${this.#s[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,a],l){const c=i-t,u=a-e;let d,f;switch(l){case 0:d=it._rescale(this.#s,t,a,c,-u),f=it._rescale(this.#r,t,a,c,-u);break;case 90:d=it._rescaleAndSwap(this.#s,t,e,c,u),f=it._rescaleAndSwap(this.#r,t,e,c,u);break;case 180:d=it._rescale(this.#s,i,e,-c,u),f=it._rescale(this.#r,i,e,-c,u);break;case 270:d=it._rescaleAndSwap(this.#s,i,a,-c,-u),f=it._rescaleAndSwap(this.#r,i,a,-c,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#s;let i=e[4],a=e[5];const l=[i,a,i,a];let c=i,u=a,d=i,f=a;const m=t?Math.max:Math.min,g=new Float32Array(4);for(let w=6,_=e.length;w<_;w+=6){const x=e[w+4],S=e[w+5];isNaN(e[w])?(nt.pointBoundingBox(x,S,l),u>S?(c=x,u=S):u===S&&(c=m(c,x)),f<S?(d=x,f=S):f===S&&(d=m(d,x))):(g[0]=g[1]=1/0,g[2]=g[3]=-1/0,nt.bezierBoundingBox(i,a,...e.slice(w,w+6),g),nt.rectBoundingBox(g[0],g[1],g[2],g[3],l),u>g[1]?(c=g[0],u=g[1]):u===g[1]&&(c=m(c,g[0])),f<g[3]?(d=g[2],f=g[3]):f===g[3]&&(d=m(d,g[2]))),i=x,a=S}const v=this.#e;v[0]=l[0]-this.#i,v[1]=l[1]-this.#i,v[2]=l[2]-l[0]+2*this.#i,v[3]=l[3]-l[1]+2*this.#i,this.firstPoint=[c,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,i,a,l,c=0){return new Xs(t,e,i,a,l,c)}getNewOutline(t,e){const[i,a,l,c]=this.#e,[u,d,f,m]=this.#t,g=l*f,v=c*m,w=i*f+u,_=a*m+d,x=this.newOutliner({x:this.#r[0]*g+w,y:this.#r[1]*v+_},this.#t,this.#a,t,this.#n,e??this.#i);for(let S=2;S<this.#r.length;S+=2)x.add({x:this.#r[S]*g+w,y:this.#r[S+1]*v+_});return x.getOutlines()}}class Bf{#t;#e;#i;#n=[];#r=[];constructor(t,e=0,i=0,a=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x,y:S,width:E,height:R}of t){const C=Math.floor((x-e)/c)*c,D=Math.ceil((x+E+e)/c)*c,N=Math.floor((S-e)/c)*c,L=Math.ceil((S+R+e)/c)*c,j=[C,N,L,!0],K=[D,N,L,!1];this.#n.push(j,K),nt.rectBoundingBox(C,N,D,L,l)}const u=l[2]-l[0]+2*i,d=l[3]-l[1]+2*i,f=l[0]-i,m=l[1]-i;let g=a?-1/0:1/0,v=1/0;const w=this.#n.at(a?-1:-2),_=[w[0],w[2]];for(const x of this.#n){const[S,E,R,C]=x;!C&&a?E<v?(v=E,g=S):E===v&&(g=Math.max(g,S)):C&&!a&&(E<v?(v=E,g=S):E===v&&(g=Math.min(g,S))),x[0]=(S-f)/u,x[1]=(E-m)/d,x[2]=(R-m)/d}this.#t=new Float32Array([f,m,u,d]),this.#e=[g,v],this.#i=_}getOutlines(){this.#n.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#a(t)}#a(t){const e=[],i=new Set;for(const c of t){const[u,d,f]=c;e.push([u,d,c],[u,f,c])}e.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=e.length;c<u;c+=2){const d=e[c][2],f=e[c+1][2];d.push(f),f.push(d),i.add(d),i.add(f)}const a=[];let l;for(;i.size>0;){const c=i.values().next().value;let[u,d,f,m,g]=c;i.delete(c);let v=u,w=d;for(l=[u,f],a.push(l);;){let _;if(i.has(m))_=m;else if(i.has(g))_=g;else break;i.delete(_),[u,d,f,m,g]=_,v!==u&&(l.push(v,w,u,w===d?d:f),v=u),w=w===d?f:d}l.push(v,w)}return new VN(a,this.#t,this.#e,this.#i)}#s(t){const e=this.#r;let i=0,a=e.length-1;for(;i<=a;){const l=i+a>>1,c=e[l][0];if(c===t)return l;c<t?i=l+1:a=l-1}return a+1}#o([,t,e]){const i=this.#s(t);this.#r.splice(i,0,[t,e])}#c([,t,e]){const i=this.#s(t);for(let a=i;a<this.#r.length;a++){const[l,c]=this.#r[a];if(l!==t)break;if(l===t&&c===e){this.#r.splice(a,1);return}}for(let a=i-1;a>=0;a--){const[l,c]=this.#r[a];if(l!==t)break;if(l===t&&c===e){this.#r.splice(a,1);return}}}#l(t){const[e,i,a]=t,l=[[e,i,a]],c=this.#s(a);for(let u=0;u<c;u++){const[d,f]=this.#r[u];for(let m=0,g=l.length;m<g;m++){const[,v,w]=l[m];if(!(f<=v||w<=d)){if(v>=d){if(w>f)l[m][1]=f;else{if(g===1)return[];l.splice(m,1),m--,g--}continue}l[m][2]=d,w>f&&l.push([e,f,w])}}}return l}}class VN extends it{#t;#e;constructor(t,e,i,a){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=a}toSVGPath(){const t=[];for(const e of this.#e){let[i,a]=e;t.push(`M${i} ${a}`);for(let l=2;l<e.length;l+=2){const c=e[l],u=e[l+1];c===i?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${c}`),i=c)}t.push("Z")}return t.join(" ")}serialize([t,e,i,a],l){const c=[],u=i-t,d=a-e;for(const f of this.#e){const m=new Array(f.length);for(let g=0;g<f.length;g+=2)m[g]=t+f[g]*u,m[g+1]=a-f[g+1]*d;c.push(m)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Uf extends Xs{newFreeDrawOutline(t,e,i,a,l,c){return new GN(t,e,i,a,l,c)}}class GN extends Ew{newOutliner(t,e,i,a,l,c=0){return new Uf(t,e,i,a,l,c)}}class de extends ct{#t=null;#e=0;#i;#n=null;#r=null;#a=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=vt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=de.prototype;return yt(this,"_keyboardManager",new nl([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||de._defaultColor,this.#p=t.thickness||de._defaultThickness,this.opacity=t.opacity||de._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#w()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#w(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new Bf(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Bf(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#a=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:a}=this.#a;this.#g=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const a=1.5;if(this.#a=t.getNewOutline(this.#p/2+a,.0025),e>=0)this.#d=e,this.#n=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:de.#_(this.#l.box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:de.#_(this.#a.box,g),path:{d:this.#a.toSVGPath()}})}const[l,c,u,d]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=d;break;case 90:{const[g,v]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*v/g,this.height=d*g/v;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=d;break;case 270:{const[g,v]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*v/g,this.height=d*g/v;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/d];const{lastPoint:m}=this.#a;this.#g=[(m[0]-l)/u,(m[1]-c)/d]}static initialize(t,e){ct.initialize(t,e),de._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Rt.HIGHLIGHT_COLOR:de._defaultColor=e;break;case Rt.HIGHLIGHT_THICKNESS:de._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Rt.HIGHLIGHT_COLOR:this.#E(e);break;case Rt.HIGHLIGHT_THICKNESS:this.#S(e);break}}static get defaultPropertiesToUpdate(){return[[Rt.HIGHLIGHT_COLOR,de._defaultColor],[Rt.HIGHLIGHT_THICKNESS,de._defaultThickness]]}get propertiesToUpdate(){return[[Rt.HIGHLIGHT_COLOR,this.color||de._defaultColor],[Rt.HIGHLIGHT_THICKNESS,this.#p||de._defaultThickness],[Rt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#E(t){const e=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},i=this.color,a=this.opacity;this.addCommands({cmd:e.bind(this,t,de._defaultOpacity),undo:e.bind(this,i,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#S(t){const e=this.#p,i=a=>{this.#p=a,this.#x(a)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new fn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#w(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#w(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#x(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#w(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#_([t,e,i,a],l){switch(l){case 90:return[1-e-a,t,a,i];case 180:return[1-t-i,1-e-a,i,a];case 270:return[e,1-t-i,a,i]}return[t,e,i,a]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#h?(t=(t-this.rotation+360)%360,i=de.#_(this.#l.box,t)):i=de.#_([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#m,{bbox:de.#_(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#N.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),J1(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#N(t){de._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#s,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#j(){if(this.#h)return null;const[t,e]=this.pageDimensions,[i,a]=this.pageTranslation,l=this.#i,c=new Float32Array(l.length*8);let u=0;for(const{x:d,y:f,width:m,height:g}of l){const v=d*t+i,w=(1-f)*e+a;c[u]=c[u+4]=v,c[u+1]=c[u+3]=w,c[u+2]=c[u+6]=v+m*t,c[u+5]=c[u+7]=w-g*e,u+=8}return c}#k(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,e,{target:i,x:a,y:l}){const{x:c,y:u,width:d,height:f}=i.getBoundingClientRect(),m=new AbortController,g=t.combinedSignal(m),v=w=>{m.abort(),this.#B(t,w)};window.addEventListener("blur",v,{signal:g}),window.addEventListener("pointerup",v,{signal:g}),window.addEventListener("pointerdown",ie,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",mn,{signal:g}),i.addEventListener("pointermove",this.#O.bind(this,t),{signal:g}),this._freeHighlight=new Uf({x:a,y:l},[c,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#O(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let a=null;if(t instanceof Sw){const{data:{quadPoints:_,rect:x,rotation:S,id:E,color:R,opacity:C,popupRef:D,richText:N,contentsObj:L,creationDate:j,modificationDate:K},parent:{page:{pageNumber:Y}}}=t;a=t={annotationType:vt.HIGHLIGHT,color:Array.from(R),opacity:C,quadPoints:_,boxes:null,pageIndex:Y-1,rect:x.slice(0),rotation:S,annotationElementId:E,id:E,deleted:!1,popupRef:D,richText:N,comment:L?.str||null,creationDate:j,modificationDate:K}}else if(t instanceof Cp){const{data:{inkLists:_,rect:x,rotation:S,id:E,color:R,borderStyle:{rawWidth:C},popupRef:D,richText:N,contentsObj:L,creationDate:j,modificationDate:K},parent:{page:{pageNumber:Y}}}=t;a=t={annotationType:vt.HIGHLIGHT,color:Array.from(R),thickness:C,inkLists:_,boxes:null,pageIndex:Y-1,rect:x.slice(0),rotation:S,annotationElementId:E,id:E,deleted:!1,popupRef:D,richText:N,comment:L?.str||null,creationDate:j,modificationDate:K}}const{color:l,quadPoints:c,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,i);f.color=nt.makeHexColor(...l),f.opacity=d||1,u&&(f.#p=t.thickness),f._initialData=a,t.comment&&f.setCommentData(t);const[m,g]=f.pageDimensions,[v,w]=f.pageTranslation;if(c){const _=f.#i=[];for(let x=0;x<c.length;x+=8)_.push({x:(c[x]-v)/m,y:1-(c[x+1]-w)/g,width:(c[x+2]-c[x])/m,height:(c[x+1]-c[x+5])/g});f.#v(),f.#w(),f.rotate(f.rotation)}else if(u){f.#h=!0;const _=u[0],x={x:_[0]-v,y:g-(_[1]-w)},S=new Uf(x,[0,0,m,g],1,f.#p/2,!0,.001);for(let C=0,D=_.length;C<D;C+=2)x.x=_[C]-v,x.y=g-(_[C+1]-w),S.add(x);const{id:E,clipPathId:R}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);f.#b({highlightOutlines:S.getOutlines(),highlightId:E,clipPathId:R}),f.#w(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#j(),outlines:this.#k(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#I(i)?null:(i.id=this.annotationElementId,i)}#I(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,a)=>i!==e[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Tw{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){qt("Not implemented")}}class Ot extends ct{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,e){const{id:i}=e.drawLayer.draw(Ot._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[a,l]of Object.entries(e))i.has(a)?Object.assign(t[a],l):t[a]=l;return t}static getDefaultDrawingOptions(t){qt("Not implemented")}static get typesMap(){qt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(Ot.#i.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,a]of this.typesMap)t.push([i,e[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,a]of this.constructor.typesMap)t.push([i,e[a]]);return t}_updateProperty(t,e,i){const a=this._drawingOptions,l=a[e],c=u=>{a.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Ot._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Ot._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Ot._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#l([t,e,i,a]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[e,1-t,i*(c/l),a*(l/c)];case 180:return[1-t,1-e,i,a];case 270:return[1-e,t,i*(c/l),a*(l/c)];default:return[t,e,i,a]}}#d(){const{x:t,y:e,width:i,height:a,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-e,t,i*(l/c),a*(c/l)];case 180:return[1-t,1-e,i,a];case 270:return[e,1-t,i*(l/c),a*(c/l)];default:return[t,e,i,a]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:i,height:a,rotation:l,parentRotation:c,parentDimensions:[u,d]}=this;switch((l*4+c)/90){case 1:return[1-e-a,t,a,i];case 2:return[1-t-i,1-e-a,i,a];case 3:return[e,1-t-i,a,i];case 4:return[t,e-i*(u/d),a*(d/u),i*(u/d)];case 5:return[1-e,t,i*(u/d),a*(d/u)];case 6:return[1-t-a*(d/u),1-e,a*(d/u),i*(u/d)];case 7:return[e-i*(u/d),1-t-a*(d/u),i*(u/d),a*(d/u)];case 8:return[t-i,e-a,i,a];case 9:return[1-e,t-i,a,i];case 10:return[1-t,1-e,i,a];case 11:return[e-a,1-t,a,i];case 12:return[t-a*(d/u),e,a*(d/u),i*(u/d)];case 13:return[1-e-i*(u/d),t-a*(d/u),i*(u/d),a*(d/u)];case 14:return[1-t,1-e-i*(u/d),a*(d/u),i*(u/d)];case 15:return[e,1-t,i*(u/d),a*(d/u)];default:return[t,e,i,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ot._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const a=document.createElement("div");return i.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,a,l){qt("Not implemented")}static startDrawing(t,e,i,a){const{target:l,offsetX:c,offsetY:u,pointerId:d,pointerType:f}=a;if(It.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:m}}=t,{width:g,height:v}=l.getBoundingClientRect(),w=Ot.#n=new AbortController,_=t.combinedSignal(w);if(It.setPointer(f,d),window.addEventListener("pointerup",x=>{It.isSamePointerIdOrRemove(x.pointerId)&&this._endDraw(x)},{signal:_}),window.addEventListener("pointercancel",x=>{It.isSamePointerIdOrRemove(x.pointerId)&&this._currentParent.endDrawingSession()},{signal:_}),window.addEventListener("pointerdown",x=>{It.isSamePointerType(x.pointerType)&&(It.initializeAndAddPointerId(x.pointerId),Ot.#i.isCancellable()&&(Ot.#i.removeLastElement(),Ot.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",mn,{signal:_}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),l.addEventListener("touchmove",x=>{It.isSameTimeStamp(x.timeStamp)&&ie(x)},{signal:_}),t.toggleDrawing(),e._editorUndoBar?.hide(),Ot.#i){t.drawLayer.updateProperties(this._currentDrawId,Ot.#i.startNew(c,u,g,v,m));return}e.updateUIForDefaultProperties(this),Ot.#i=this.createDrawerInstance(c,u,g,v,m),Ot.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Ot.#r.toSVGProperties(),Ot.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(It.isSameTimeStamp(t.timeStamp),!Ot.#i)return;const{offsetX:e,offsetY:i,pointerId:a}=t;if(It.isSamePointerId(a)){if(It.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Ot.#i.add(e,i)),It.setTimeStamp(t.timeStamp),ie(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Ot.#i=null,Ot.#r=null,It.clearTimeStamp()),Ot.#n&&(Ot.#n.abort(),Ot.#n=null,It.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Ot.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=Ot.#i,a=this._currentDrawId,l=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(a,i.setLastElement(l))},undo:()=>{e.drawLayer.updateProperties(a,i.removeLastElement())},mustExec:!1,type:Rt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Rt.DRAW_STEP),!Ot.#i.isEmpty()){const{pageDimensions:[i,a],scale:l}=e,c=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Ot.#i.getOutlines(i*l,a*l,l,this._INNER_MARGIN),drawingOptions:Ot.#r,mustBeCommitted:!t});return this._cleanup(!0),c}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,a,l,c){qt("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:u}}=e.viewport,d=this.deserializeDraw(c,u,a,l,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#a({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[a,l]=this.pageDimensions;return this.#t.serialize([e,i,a,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class qN{#t=new Float64Array(6);#e;#i;#n;#r;#a;#s="";#o=0;#c=new al;#l;#d;constructor(t,e,i,a,l,c){this.#l=i,this.#d=a,this.#n=l,this.#r=c,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#a=[t,e],this.#i=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#r=e)}#h(t,e){return it._normalizePoint(t,e,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#a.length<=10}add(t,e){[t,e]=this.#h(t,e);const[i,a,l,c]=this.#t.subarray(2,6),u=t-l,d=e-c;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#a.push(t,e),isNaN(i)?(this.#t.set([l,c,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,a,l,c,t,e],0),this.#e.push(...it.createBezierPoints(i,a,l,c,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,a,l){this.#l=i,this.#d=a,this.#n=l,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#a=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:c,points:this.#a}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#a=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#s="";for(let t=0,e=this.#i.length;t<e;t++){const{line:i,points:a}=this.#i[t];this.#e=i,this.#a=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=it.svgRound(this.#e[4]),e=it.svgRound(this.#e[5]);if(this.#a.length===2)return this.#s=`${this.#s} M ${t} ${e} Z`,this.#s;if(this.#a.length<=6){const a=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,a)} M ${t} ${e}`,this.#o=6}if(this.#a.length===4){const a=it.svgRound(this.#e[10]),l=it.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${a} ${l}`,this.#o=12,this.#s}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let a=this.#o,l=this.#e.length;a<l;a+=6){const[c,u,d,f,m,g]=this.#e.slice(a,a+6).map(it.svgRound);i.push(`C${c} ${u} ${d} ${f} ${m} ${g}`)}return this.#s+=i.join(" "),this.#o=this.#e.length,this.#s}getOutlines(t,e,i,a){const l=this.#i.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#i,t,e,i,this.#n,this.#r,a),this.#t=null,this.#e=null,this.#i=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class al extends it{#t;#e=0;#i;#n;#r;#a;#s;#o;#c;build(t,e,i,a,l,c,u){this.#r=e,this.#a=i,this.#s=a,this.#o=l,this.#c=c,this.#i=u??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${it.svgRound(e[4])} ${it.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${it.svgRound(e[10])} ${it.svgRound(e[11])}`);continue}for(let i=6,a=e.length;i<a;i+=6){const[l,c,u,d,f,m]=e.subarray(i,i+6).map(it.svgRound);t.push(`C${l} ${c} ${u} ${d} ${f} ${m}`)}}return t.join("")}serialize([t,e,i,a],l){const c=[],u=[],[d,f,m,g]=this.#d();let v,w,_,x,S,E,R,C,D;switch(this.#o){case 0:D=it._rescale,v=t,w=e+a,_=i,x=-a,S=t+d*i,E=e+(1-f-g)*a,R=t+(d+m)*i,C=e+(1-f)*a;break;case 90:D=it._rescaleAndSwap,v=t,w=e,_=i,x=a,S=t+f*i,E=e+d*a,R=t+(f+g)*i,C=e+(d+m)*a;break;case 180:D=it._rescale,v=t+i,w=e,_=-i,x=a,S=t+(1-d-m)*i,E=e+f*a,R=t+(1-d)*i,C=e+(f+g)*a;break;case 270:D=it._rescaleAndSwap,v=t+i,w=e+a,_=-i,x=-a,S=t+(1-f-g)*i,E=e+(1-d-m)*a,R=t+(1-f)*i,C=e+(1-d)*a;break}for(const{line:N,points:L}of this.#n)c.push(D(N,v,w,_,x,l?new Array(N.length):null)),u.push(D(L,v,w,_,x,l?new Array(L.length):null));return{lines:c,points:u,rect:[S,E,R,C]}}static deserialize(t,e,i,a,l,{paths:{lines:c,points:u},rotation:d,thickness:f}){const m=[];let g,v,w,_,x;switch(d){case 0:x=it._rescale,g=-t/i,v=e/a+1,w=1/i,_=-1/a;break;case 90:x=it._rescaleAndSwap,g=-e/a,v=-t/i,w=1/a,_=1/i;break;case 180:x=it._rescale,g=t/i+1,v=-e/a,w=-1/i,_=1/a;break;case 270:x=it._rescaleAndSwap,g=e/a+1,v=t/i+1,w=-1/a,_=-1/i;break}if(!c){c=[];for(const E of u){const R=E.length;if(R===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(R===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const C=new Float32Array(3*(R-2));c.push(C);let[D,N,L,j]=E.subarray(0,4);C.set([NaN,NaN,NaN,NaN,D,N],0);for(let K=4;K<R;K+=2){const Y=E[K],$=E[K+1];C.set(it.createBezierPoints(D,N,L,j,Y,$),(K-2)*3),[D,N,L,j]=[L,j,Y,$]}}}for(let E=0,R=c.length;E<R;E++)m.push({line:x(c[E].map(C=>C??NaN),g,v,w,_),points:x(u[E].map(C=>C??NaN),g,v,w,_)});const S=new this.prototype.constructor;return S.build(m,i,a,1,d,f,l),S}#l(t=this.#c){const e=this.#i+t/2*this.#s;return this.#o%180===0?[e/this.#r,e/this.#a]:[e/this.#a,e/this.#r]}#d(){const[t,e,i,a]=this.#t,[l,c]=this.#l(0);return[t+l,e+c,i-2*l,a-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#n){if(a.length<=12){for(let u=4,d=a.length;u<d;u+=6)nt.pointBoundingBox(a[u],a[u+1],t);continue}let l=a[4],c=a[5];for(let u=6,d=a.length;u<d;u+=6){const[f,m,g,v,w,_]=a.subarray(u,u+6);nt.bezierBoundingBox(l,c,f,m,g,v,w,_,t),l=w,c=_}}const[e,i]=this.#l();t[0]=Pe(t[0]-e,0,1),t[1]=Pe(t[1]-i,0,1),t[2]=Pe(t[2]+e,0,1),t[3]=Pe(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[a,l]=this.#l(),[c,u]=[a-e,l-i],d=this.#t;return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateParentDimensions([t,e],i){const[a,l]=this.#l();this.#r=t,this.#a=e,this.#s=i;const[c,u]=this.#l(),d=c-a,f=u-l,m=this.#t;return m[0]-=d,m[1]-=f,m[2]+=2*d,m[3]+=2*f,m}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(it.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,a=0,l=0,c=0,u=0,d=0;switch(this.#e){case 90:a=e/t,l=-t/e,u=t;break;case 180:i=-1,c=-1,u=t,d=e;break;case 270:a=-e/t,l=t/e,d=e;break;default:return""}return`matrix(${i} ${a} ${l} ${c} ${it.svgRound(u)} ${it.svgRound(d)})`}getPathResizingSVGProperties([t,e,i,a]){const[l,c]=this.#l(),[u,d,f,m]=this.#t;if(Math.abs(f-l)<=it.PRECISION||Math.abs(m-c)<=it.PRECISION){const x=t+i/2-(u+f/2),S=e+a/2-(d+m/2);return{path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(e)}`,transform:`${this.rotationTransform} translate(${x} ${S})`}}}const g=(i-2*l)/(f-2*l),v=(a-2*c)/(m-2*c),w=f/i,_=m/a;return{path:{"transform-origin":`${it.svgRound(u)} ${it.svgRound(d)}`,transform:`${this.rotationTransform} scale(${w} ${_}) translate(${it.svgRound(l)} ${it.svgRound(c)}) scale(${g} ${v}) translate(${it.svgRound(-l)} ${it.svgRound(-c)})`}}}getPathResizedSVGProperties([t,e,i,a]){const[l,c]=this.#l(),u=this.#t,[d,f,m,g]=u;if(u[0]=t,u[1]=e,u[2]=i,u[3]=a,Math.abs(m-l)<=it.PRECISION||Math.abs(g-c)<=it.PRECISION){const S=t+i/2-(d+m/2),E=e+a/2-(f+g/2);for(const{line:R,points:C}of this.#n)it._translate(R,S,E,R),it._translate(C,S,E,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(i-2*l)/(m-2*l),w=(a-2*c)/(g-2*c),_=-v*(d+l)+t+l,x=-w*(f+c)+e+c;if(v!==1||w!==1||_!==0||x!==0)for(const{line:S,points:E}of this.#n)it._rescale(S,_,x,v,w,S),it._rescale(E,_,x,v,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[a,l]=i,c=this.#t,u=t-c[0],d=e-c[1];if(this.#r===a&&this.#a===l)for(const{line:f,points:m}of this.#n)it._translate(f,u,d,f),it._translate(m,u,d,m);else{const f=this.#r/a,m=this.#a/l;this.#r=a,this.#a=l;for(const{line:g,points:v}of this.#n)it._rescale(g,u,d,f,m,g),it._rescale(v,u,d,f,m,v);c[2]*=f,c[3]*=m}return c[0]=t,c[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${it.svgRound(t)} ${it.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${it.svgRound(t[0])} ${it.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Su extends Tw{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ct._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Su(this._viewParameters);return t.updateAll(this),t}}class Rp extends Ot{static _type="ink";static _editorType=vt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){ct.initialize(t,e),this._defaultDrawingOptions=new Su(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return yt(this,"typesMap",new Map([[Rt.INK_THICKNESS,"stroke-width"],[Rt.INK_COLOR,"stroke"],[Rt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,a,l){return new qN(t,e,i,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,a,l,c){return al.deserialize(t,e,i,a,l,c)}static async deserialize(t,e,i){let a=null;if(t instanceof Cp){const{data:{inkLists:c,rect:u,rotation:d,id:f,color:m,opacity:g,borderStyle:{rawWidth:v},popupRef:w,richText:_,contentsObj:x,creationDate:S,modificationDate:E},parent:{page:{pageNumber:R}}}=t;a=t={annotationType:vt.INK,color:Array.from(m),thickness:v,opacity:g,paths:{points:c},boxes:null,pageIndex:R-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:w,richText:_,comment:x?.str||null,creationDate:S,modificationDate:E}}const l=await super.deserialize(t,e,i);return l._initialData=a,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new Ho(this),[["colorPicker",this._colorPicker]]}get colorType(){return Rt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=Rp.getDefaultDrawingOptions({stroke:nt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:ct._colorManager.convert(a),opacity:l,thickness:c,paths:{lines:e,points:i}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==e[u])||t.thickness!==i||t.opacity!==a||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Ff extends al{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const jc=8,Ao=3;class Ys{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,a){return i-=t,a-=e,i===0?a>0?0:4:i===1?a+6:2-a}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,i,a,l,c,u){const d=this.#e(i,a,l,c);for(let f=0;f<8;f++){const m=(-f+d-u+16)%8,g=this.#i[2*m],v=this.#i[2*m+1];if(t[(i+g)*e+(a+v)]!==0)return m}return-1}static#r(t,e,i,a,l,c,u){const d=this.#e(i,a,l,c);for(let f=0;f<8;f++){const m=(f+d+u+16)%8,g=this.#i[2*m],v=this.#i[2*m+1];if(t[(i+g)*e+(a+v)]!==0)return m}return-1}static#a(t,e,i,a){const l=t.length,c=new Int32Array(l);for(let m=0;m<l;m++)c[m]=t[m]<=a?1:0;for(let m=1;m<i-1;m++)c[m*e]=c[m*e+e-1]=0;for(let m=0;m<e;m++)c[m]=c[e*i-1-m]=0;let u=1,d;const f=[];for(let m=1;m<i-1;m++){d=1;for(let g=1;g<e-1;g++){const v=m*e+g,w=c[v];if(w===0)continue;let _=m,x=g;if(w===1&&c[v-1]===0)u+=1,x-=1;else if(w>=1&&c[v+1]===0)u+=1,x+=1,w>1&&(d=w);else{w!==1&&(d=Math.abs(w));continue}const S=[g,m],E=x===g+1,R={isHole:E,points:S,id:u,parent:0};f.push(R);let C;for(const H of f)if(H.id===d){C=H;break}C?C.isHole?R.parent=E?C.parent:d:R.parent=E?d:C.parent:R.parent=E?d:0;const D=this.#n(c,e,m,g,_,x,0);if(D===-1){c[v]=-u,c[v]!==1&&(d=Math.abs(c[v]));continue}let N=this.#i[2*D],L=this.#i[2*D+1];const j=m+N,K=g+L;_=j,x=K;let Y=m,$=g;for(;;){const H=this.#r(c,e,Y,$,_,x,1);N=this.#i[2*H],L=this.#i[2*H+1];const J=Y+N,at=$+L;S.push(at,J);const rt=Y*e+$;if(c[rt+1]===0?c[rt]=-u:c[rt]===1&&(c[rt]=u),J===m&&at===g&&Y===j&&$===K){c[v]!==1&&(d=Math.abs(c[v]));break}else _=Y,x=$,Y=J,$=at}}}return f}static#s(t,e,i,a){if(i-e<=4){for(let j=e;j<i-2;j+=2)a.push(t[j],t[j+1]);return}const l=t[e],c=t[e+1],u=t[i-4]-l,d=t[i-3]-c,f=Math.hypot(u,d),m=u/f,g=d/f,v=m*c-g*l,w=d/u,_=1/f,x=Math.atan(w),S=Math.cos(x),E=Math.sin(x),R=_*(Math.abs(S)+Math.abs(E)),C=_*(1-R+R**2),D=Math.max(Math.atan(Math.abs(E+S)*C),Math.atan(Math.abs(E-S)*C));let N=0,L=e;for(let j=e+2;j<i-2;j+=2){const K=Math.abs(v-m*t[j+1]+g*t[j]);K>N&&(L=j,N=K)}N>(f*D)**2?(this.#s(t,e,L+2,a),this.#s(t,L,i,a)):a.push(l,c)}static#o(t){const e=[],i=t.length;return this.#s(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,a,l,c){const u=new Float32Array(c**2),d=-2*a**2,f=c>>1;for(let x=0;x<c;x++){const S=(x-f)**2;for(let E=0;E<c;E++)u[x*c+E]=Math.exp((S+(E-f)**2)/d)}const m=new Float32Array(256),g=-2*l**2;for(let x=0;x<256;x++)m[x]=Math.exp(x**2/g);const v=t.length,w=new Uint8Array(v),_=new Uint32Array(256);for(let x=0;x<i;x++)for(let S=0;S<e;S++){const E=x*e+S,R=t[E];let C=0,D=0;for(let L=0;L<c;L++){const j=x+L-f;if(!(j<0||j>=i))for(let K=0;K<c;K++){const Y=S+K-f;if(Y<0||Y>=e)continue;const $=t[j*e+Y],H=u[L*c+K]*m[Math.abs($-R)];C+=$*H,D+=H}}const N=w[E]=Math.round(C/D);_[N]++}return[w,_]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let a=-1/0,l=1/0;for(let u=0,d=i.length;u<d;u++){const f=i[u]=t[u<<2];a=Math.max(a,f),l=Math.min(l,f)}const c=255/(a-l);for(let u=0,d=i.length;u<d;u++)i[u]=(i[u]-l)*c;return i}static#h(t){let e,i=-1/0,a=-1/0;const l=t.findIndex(d=>d!==0);let c=l,u=l;for(e=l;e<256;e++){const d=t[e];d>i&&(e-c>a&&(a=e-c,u=e-1),i=d,c=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:a}=t,{maxDim:l}=this.#t;let c=i,u=a;if(i>l||a>l){let v=i,w=a,_=Math.log2(Math.max(i,a)/l);const x=Math.floor(_);_=_===x?x-1:x;for(let E=0;E<_;E++){c=Math.ceil(v/2),u=Math.ceil(w/2);const R=new OffscreenCanvas(c,u);R.getContext("2d").drawImage(t,0,0,v,w,0,0,c,u),v=c,w=u,t!==e&&t.close(),t=R.transferToImageBitmap()}const S=Math.min(l/c,l/u);c=Math.round(c*S),u=Math.round(u*S)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const m=f.getImageData(0,0,c,u).data;return[this.#d(m),c,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:a},l,c,u,d){let f=new OffscreenCanvas(1,1),m=f.getContext("2d",{alpha:!1});const g=200,v=m.font=`${i} ${a} ${g}px ${e}`,{actualBoundingBoxLeft:w,actualBoundingBoxRight:_,actualBoundingBoxAscent:x,actualBoundingBoxDescent:S,fontBoundingBoxAscent:E,fontBoundingBoxDescent:R,width:C}=m.measureText(t),D=1.5,N=Math.ceil(Math.max(Math.abs(w)+Math.abs(_)||0,C)*D),L=Math.ceil(Math.max(Math.abs(x)+Math.abs(S)||g,Math.abs(E)+Math.abs(R)||g)*D);f=new OffscreenCanvas(N,L),m=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),m.font=v,m.filter="grayscale(1)",m.fillStyle="white",m.fillRect(0,0,N,L),m.fillStyle="black",m.fillText(t,N*(D-1)/2,L*(3-D)/2);const j=this.#d(m.getImageData(0,0,N,L).data),K=this.#l(j),Y=this.#h(K),$=this.#a(j,N,L,Y);return this.processDrawnLines({lines:{curves:$,width:N,height:L},pageWidth:l,pageHeight:c,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,i,a,l){const[c,u,d]=this.#f(t),[f,m]=this.#c(c,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),g=this.#h(m),v=this.#a(f,u,d,g);return this.processDrawnLines({lines:{curves:v,width:u,height:d},pageWidth:e,pageHeight:i,rotation:a,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:a,innerMargin:l,mustSmooth:c,areContours:u}){a%180!==0&&([e,i]=[i,e]);const{curves:d,width:f,height:m}=t,g=t.thickness??0,v=[],w=Math.min(e/f,i/m),_=w/e,x=w/i,S=[];for(const{points:R}of d){const C=c?this.#o(R):R;if(!C)continue;S.push(C);const D=C.length,N=new Float32Array(D),L=new Float32Array(3*(D===2?2:D-2));if(v.push({line:L,points:N}),D===2){N[0]=C[0]*_,N[1]=C[1]*x,L.set([NaN,NaN,NaN,NaN,N[0],N[1]],0);continue}let[j,K,Y,$]=C;j*=_,K*=x,Y*=_,$*=x,N.set([j,K,Y,$],0),L.set([NaN,NaN,NaN,NaN,j,K],0);for(let H=4;H<D;H+=2){const J=N[H]=C[H]*_,at=N[H+1]=C[H+1]*x;L.set(it.createBezierPoints(j,K,Y,$,J,at),(H-2)*3),[j,K,Y,$]=[Y,$,J,at]}}if(v.length===0)return null;const E=u?new Ff:new al;return E.build(v,e,i,1,a,u?0:g,l),{outline:E,newCurves:S,areContours:u,thickness:g,width:f,height:m}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:a,height:l}){let c=1/0,u=-1/0,d=0;for(const C of t){d+=C.length;for(let D=2,N=C.length;D<N;D++){const L=C[D]-C[D-2];c=Math.min(c,L),u=Math.max(u,L)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const m=t.length,g=jc+Ao*m,v=new Uint32Array(g);let w=0;v[w++]=g*Uint32Array.BYTES_PER_ELEMENT+(d-2*m)*f.BYTES_PER_ELEMENT,v[w++]=0,v[w++]=a,v[w++]=l,v[w++]=e?0:1,v[w++]=Math.max(0,Math.floor(i??0)),v[w++]=m,v[w++]=f.BYTES_PER_ELEMENT;for(const C of t)v[w++]=C.length-2,v[w++]=C[0],v[w++]=C[1];const _=new CompressionStream("deflate-raw"),x=_.writable.getWriter();await x.ready,x.write(v);const S=f.prototype.constructor;for(const C of t){const D=new S(C.length-2);for(let N=2,L=C.length;N<L;N++)D[N-2]=C[N]-C[N-2];x.write(D)}x.close();const E=await new Response(_.readable).arrayBuffer(),R=new Uint8Array(E);return q1(R)}static async decompressSignature(t){try{const e=mD(t),{readable:i,writable:a}=new DecompressionStream("deflate-raw"),l=a.getWriter();await l.ready,l.write(e).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const C of i)c||=new Uint8Array(new Uint32Array(C.buffer,0,4)[0]),c.set(C,u),u+=C.length;const d=new Uint32Array(c.buffer,0,c.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const m=d[2],g=d[3],v=d[4]===0,w=d[5],_=d[6],x=d[7],S=[],E=(jc+Ao*_)*Uint32Array.BYTES_PER_ELEMENT;let R;switch(x){case Int8Array.BYTES_PER_ELEMENT:R=new Int8Array(c.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:R=new Int16Array(c.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:R=new Int32Array(c.buffer,E);break}u=0;for(let C=0;C<_;C++){const D=d[Ao*C+jc],N=new Float32Array(D+2);S.push(N);for(let L=0;L<Ao-1;L++)N[L]=d[Ao*C+jc+L+1];for(let L=0;L<D;L++)N[L+2]=N[L]+R[u++]}return{areContours:v,thickness:w,outlines:S,width:m,height:g}}catch(e){return wt(`decompressSignature: ${e}`),null}}}class Dp extends Tw{constructor(){super(),super.updateProperties({fill:ct._defaultLineColor,"stroke-width":0})}clone(){const t=new Dp;return t.updateAll(this),t}}class Np extends Su{constructor(t){super(t),super.updateProperties({stroke:ct._defaultLineColor,"stroke-width":1})}clone(){const t=new Np(this._viewParameters);return t.updateAll(this),t}}class ei extends Ot{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=vt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){ct.initialize(t,e),this._defaultDrawingOptions=new Dp,this._defaultDrawnSignatureOptions=new Np(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return yt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:a,mustSmooth:l,areContours:c,description:u,uuid:d,heightInPage:f}=this.#i,{rawDims:{pageWidth:m,pageHeight:g},rotation:v}=this.parent.viewport,w=Ys.processDrawnLines({lines:a,pageWidth:m,pageHeight:g,rotation:v,innerMargin:ei._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(w,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:a,height:l}=this.#i,c=Math.max(a,l),u=Ys.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:i,width:a,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,a){const{x:l,y:c}=this,{outline:u}=this.#i=t;this.#t=u instanceof Ff,this.description=i;let d;this.#t?d=ei.getDefaultDrawingOptions():(d=ei._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let m=e/f;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:a}=this.parent.viewport;return Ys.process(t,e,i,a,ei._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:a},rotation:l}=this.parent.viewport;return Ys.extractContoursFromText(t,e,i,a,l,ei._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:a}=this.parent.viewport;return Ys.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:a,innerMargin:ei._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=ei.getDefaultDrawingOptions():(this._drawingOptions=ei._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(l),t?(l.paths={lines:e,points:i},l.uuid=this.#n,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,i,a,l,c){return c.areContours?Ff.deserialize(t,e,i,a,l,c):al.deserialize(t,e,i,a,l,c)}static async deserialize(t,e,i){const a=await super.deserialize(t,e,i);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#n=t.uuid,a}}class $N extends ct{#t=null;#e=null;#i=null;#n=null;#r=null;#a="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=vt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){ct.initialize(t,e)}static isHandlingMimeForPasting(t){return ou.includes(t)}static paste(t,e){e.pasteEditor({mode:vt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#a=t.file.name),this.#m()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await i.guess({name:"altText",request:{data:a,width:l,height:c,channels:a.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#h(i,!0)).finally(()=>this.#f());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#r){const i=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=ou.join(",");const e=this._uiManager._signal;this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#r||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,a&&(this.#t=a),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#m(){const{div:t}=this;let{width:e,height:i}=this.#t;const[a,l]=this.pageDimensions,c=.75;if(this.width)e=this.width*a,i=this.height*l;else if(e>c*a||i>c*l){const d=Math.min(c*a/e,c*l/i);e*=d,i*=d}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/a,this.height=i/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:a,height:l}=this.#t,c=new Hn;let u=this.#t,d=a,f=l,m=null;if(e){if(a>e||l>e){const L=Math.min(e/a,e/l);d=Math.floor(a*L),f=Math.floor(l*L)}m=document.createElement("canvas");const v=m.width=Math.ceil(d*c.sx),w=m.height=Math.ceil(f*c.sy);this.#l||(u=this.#u(v,w));const _=m.getContext("2d");_.filter=this._uiManager.hcmFilter;let x="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":bD.isDarkMode&&(x="#8f8f9d",S="#42414d");const E=15,R=E*c.sx,C=E*c.sy,D=new OffscreenCanvas(R*2,C*2),N=D.getContext("2d");N.fillStyle=x,N.fillRect(0,0,R*2,C*2),N.fillStyle=S,N.fillRect(0,0,R,C),N.fillRect(R,C,R,C),_.fillStyle=_.createPattern(D,"repeat"),_.fillRect(0,0,v,w),_.drawImage(u,0,0,u.width,u.height,0,0,v,w)}let g=null;if(i){let v,w;if(c.symmetric&&u.width<t&&u.height<t)v=u.width,w=u.height;else if(u=this.#t,a>t||l>t){const S=Math.min(t/a,t/l);v=Math.floor(a*S),w=Math.floor(l*S),this.#l||(u=this.#u(v,w))}const x=new OffscreenCanvas(v,w).getContext("2d",{willReadFrequently:!0});x.drawImage(u,0,0,u.width,u.height,0,0,v,w),g={width:v,height:w,data:x.getImageData(0,0,v,w).data}}return{canvas:m,width:d,height:f,imageData:g}}#u(t,e){const{width:i,height:a}=this.#t;let l=i,c=a,u=this.#t;for(;l>2*t||c>2*e;){const d=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*e&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const m=new OffscreenCanvas(l,c);m.getContext("2d").drawImage(u,0,0,d,f,0,0,l,c),u=m.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:i,height:a}=this,l=new Hn,c=Math.ceil(i*t*l.sx),u=Math.ceil(a*e*l.sy),d=this.#s;if(!d||d.width===c&&d.height===u)return;d.width=c,d.height=u;const f=this.#l?this.#t:this.#u(c,u),m=d.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,a=Math.round(this.width*e*ta.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*ta.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(a,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let a=null,l=!1;if(t instanceof _w){const{data:{rect:x,rotation:S,id:E,structParent:R,popupRef:C,richText:D,contentsObj:N,creationDate:L,modificationDate:j},container:K,parent:{page:{pageNumber:Y}},canvas:$}=t;let H,J;$?(delete t.canvas,{id:H,bitmap:J}=i.imageManager.getFromCanvas(K.id,$),$.remove()):(l=!0,t._hasNoCanvas=!0);const at=(await e._structTree.getAriaAttributes(`${Za}${E}`))?.get("aria-label")||"";a=t={annotationType:vt.STAMP,bitmapId:H,bitmap:J,pageIndex:Y-1,rect:x.slice(0),rotation:S,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:at},isSvg:!1,structParent:R,popupRef:C,richText:D,comment:N?.str||null,creationDate:L,modificationDate:j}}const c=await super.deserialize(t,e,i),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:m,isSvg:g,accessibilityData:v}=t;l?(i.addMissingCanvas(t.id,c),c.#o=!0):m&&i.imageManager.isValidId(m)?(c.#e=m,d&&(c.#t=d)):c.#n=f,c.#l=g;const[w,_]=c.pageDimensions;return c.width=(u[2]-u[0])/w,c.height=(u[3]-u[1])/_,v&&(c.altTextData=v),c._initialData=a,t.comment&&c.setCommentData(t),c.#d=!!a,c}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(i);return u.isSame?null:(u.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const c=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:c,serialized:i}),i.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return i}#v(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,a=t.pageIndex===e,l=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class ii{#t;#e=!1;#i=null;#n=null;#r=null;#a=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([Te,Rp,$N,de,ei].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:a,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:d,viewport:f,l10n:m}){const g=[...ii.#p.values()];if(!ii._initialized){ii._initialized=!0;for(const v of g)v.initialize(m,t)}t.registerEditorTypes(g),this.#u=t,this.pageIndex=e,this.div=i,this.#t=l,this.#i=c,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===vt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#x(),t){case vt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case vt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case vt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===vt.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of ii.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#y(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const t=new Set;for(const i of this.#y)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#u.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#i;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#u.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const a=await this.deserialize(i);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const a=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:d,timeStamp:f}=l,m=this.#m;if(f-m>500){this.#m=f;return}this.#m=-1;const{classList:g}=this.div;g.toggle("getElements",!0);const v=document.elementsFromPoint(u,d);if(g.toggle("getElements",!1),!this.div.contains(v[0]))return;let w;const _=new RegExp(`^${Uo}[0-9]+$`);for(const S of v)if(_.test(S.id)){w=S.id;break}if(!w)return;const x=this.#a.get(w);x?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),x.dblclick(l))},{signal:a,capture:!0})}const t=this.#i,e=[];if(t){const a=new Map,l=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){e.push(u);continue}if(u.serialize()!==null){a.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=l.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=a.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const a of ii.#p.values())i.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:i}=ve.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),de.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),ct.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#a.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#b(){return ii.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const e=this.#b;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:i,offsetY:a}=this.#S(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:i,y:a,uiManager:this.#u,isCentered:!0,...e});c&&this.add(c)}async deserialize(t){return await ii.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,i={}){const a=this.getNextId(),l=this.#E({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...i});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#S(){const{x:t,y:e,width:i,height:a}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,e),u=Math.min(window.innerWidth,t+i),d=Math.min(window.innerHeight,e+a),f=(l+u)/2-t,m=(c+d)/2-e,[g,v]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:g,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#S(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=ve.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#s||(this.#s=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#u.getMode();if(i===vt.STAMP||i===vt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===vt.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:e}=ve.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#s=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const i=this.#u.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,e,i){const a=this.#u.findParent(e,i);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#x(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Es(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#x();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Es(this.div,{rotation:i}),e!==i)for(const a of this.#a.values())a.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class Ce{#t=null;#e=new Map;#i=new Map;static#n=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return yt(this,"_svgFactory",new Vo)}static#r(t,[e,i,a,l]){const{style:c}=t;c.top=`${100*i}%`,c.left=`${100*e}%`,c.width=`${100*a}%`,c.height=`${100*l}%`}#a(){const t=Ce._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,e){const i=Ce._svgFactory.createElement("clipPath");t.append(i);const a=`clip_${e}`;i.setAttribute("id",a),i.setAttribute("clipPathUnits","objectBoundingBox");const l=Ce._svgFactory.createElement("use");return i.append(l),l.setAttribute("href",`#${e}`),l.classList.add("clip"),a}#o(t,e){for(const[i,a]of Object.entries(e))a===null?t.removeAttribute(i):t.setAttribute(i,a)}draw(t,e=!1,i=!1){const a=Ce.#n++,l=this.#a(),c=Ce._svgFactory.createElement("defs");l.append(c);const u=Ce._svgFactory.createElement("path");c.append(u);const d=`path_p${this.pageIndex}_${a}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(a,u);const f=i?this.#s(c,d):null,m=Ce._svgFactory.createElement("use");return l.append(m),m.setAttribute("href",`#${d}`),this.updateProperties(l,t),this.#e.set(a,l),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=Ce.#n++,a=this.#a(),l=Ce._svgFactory.createElement("defs");a.append(l);const c=Ce._svgFactory.createElement("path");l.append(c);const u=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const g=Ce._svgFactory.createElement("mask");l.append(g),d=`mask_p${this.pageIndex}_${i}`,g.setAttribute("id",d),g.setAttribute("maskUnits","objectBoundingBox");const v=Ce._svgFactory.createElement("rect");g.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const w=Ce._svgFactory.createElement("use");g.append(w),w.setAttribute("href",`#${u}`),w.setAttribute("stroke","none"),w.setAttribute("fill","black"),w.setAttribute("fill-rule","nonzero"),w.classList.add("mask")}const f=Ce._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const m=f.cloneNode();return a.append(m),f.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(i,a),i}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:a,rootClass:l,path:c}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(i&&this.#o(u,i),a&&Ce.#r(u,a),l){const{classList:d}=u;for(const[f,m]of Object.entries(l))d.toggle(f,m)}if(c){const f=u.firstElementChild.firstElementChild;this.#o(f,c)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Bf};globalThis.pdfjsLib={AbortException:Bi,AnnotationEditorLayer:ii,AnnotationEditorParamsType:Rt,AnnotationEditorType:vt,AnnotationEditorUIManager:Ui,AnnotationLayer:Au,AnnotationMode:Di,AnnotationType:he,applyOpacity:K1,build:vw,ColorPicker:fn,createValidAbsoluteUrl:fp,CSSConstants:W1,DOMSVGFactory:Vo,DrawLayer:Ce,FeatureTest:ve,fetchData:vr,findContrastColor:Q1,getDocument:mw,getFilenameFromUrl:$1,getPdfFilenameFromUrl:Y1,getRGB:wr,getUuid:mp,getXfaPageViewport:X1,GlobalWorkerOptions:Zs,ImageKind:Mo,InvalidPDFException:au,isDataScheme:el,isPdfFile:wu,isValidExplicitDest:nw,MathClamp:Pe,noContextMenu:mn,normalizeUnicode:G1,OPS:hr,OutputScale:Hn,PasswordResponses:H1,PDFDataRangeTransport:Ep,PDFDateString:ru,PDFWorker:dr,PermissionFlag:z1,PixelsPerInch:ta,RenderingCancelledException:vu,renderRichText:yp,ResponseException:Fo,setLayerDimensions:Es,shadow:yt,SignatureExtractor:Ys,stopEvent:ie,SupportedImageMimeTypes:ou,TextLayer:Je,TouchManager:il,updateUrlHash:pp,Util:nt,VerbosityLevel:Zo,version:bw,XfaLayer:gp};const YN=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Bi,AnnotationEditorLayer:ii,AnnotationEditorParamsType:Rt,AnnotationEditorType:vt,AnnotationEditorUIManager:Ui,AnnotationLayer:Au,AnnotationMode:Di,AnnotationType:he,CSSConstants:W1,ColorPicker:fn,DOMSVGFactory:Vo,DrawLayer:Ce,FeatureTest:ve,GlobalWorkerOptions:Zs,ImageKind:Mo,InvalidPDFException:au,MathClamp:Pe,OPS:hr,OutputScale:Hn,PDFDataRangeTransport:Ep,PDFDateString:ru,PDFWorker:dr,PasswordResponses:H1,PermissionFlag:z1,PixelsPerInch:ta,RenderingCancelledException:vu,ResponseException:Fo,SignatureExtractor:Ys,SupportedImageMimeTypes:ou,TextLayer:Je,TouchManager:il,Util:nt,VerbosityLevel:Zo,XfaLayer:gp,applyOpacity:K1,build:vw,createValidAbsoluteUrl:fp,fetchData:vr,findContrastColor:Q1,getDocument:mw,getFilenameFromUrl:$1,getPdfFilenameFromUrl:Y1,getRGB:wr,getUuid:mp,getXfaPageViewport:X1,isDataScheme:el,isPdfFile:wu,isValidExplicitDest:nw,noContextMenu:mn,normalizeUnicode:G1,renderRichText:yp,setLayerDimensions:Es,shadow:yt,stopEvent:ie,updateUrlHash:pp,version:bw},Symbol.toStringTag,{value:"Module"}));Zs.workerPort=new Worker(new URL("/assets/pdf.worker.min-BHtGh23B.js",import.meta.url),{type:"module"});const sv=async r=>{try{let t="";for(let e=1;e<=r.numPages;e++){const l=(await(await r.getPage(e)).getTextContent()).items.map(c=>c.str).join(" ");t+=l+"\f"}return t}catch(t){return console.error("Error extracting text from PDF:",t),"PDF text content"}},av=async r=>{let t;if(typeof r=="string")t=new TextEncoder().encode(r);else if(r instanceof ArrayBuffer)t=new Uint8Array(r);else if(r instanceof Uint8Array)t=r;else throw new Error("computeSHA256: unsupported input type");const e=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(e)).map(a=>a.toString(16).padStart(2,"0")).join("")};function cu({pageCount:r,extractedText:t,pdfSizeBytes:e}){const i=String(t||""),l=i.split("\f").filter(c=>c!==void 0).slice(0,r).map(c=>String(c||"").trim().length);return{pageCount:r,charsPerPage:l,totalChars:i.replace(/\f/g,"").length,pdfSizeBytes:e||0}}const Cw=()=>{const[r,t]=I.useState(!1),[e,i]=I.useState(null),[a,l]=I.useState(null),[c,u]=I.useState(1),[d,f]=I.useState(1.5),[m,g]=I.useState(""),[v,w]=I.useState(null),[_,x]=I.useState(null),[S,E]=I.useState(!1),[R,C]=I.useState(""),[D,N]=I.useState(null);return I.useEffect(()=>{(async()=>{if(window.pdfjsLib){t(!0);return}try{const $=await dp(()=>Promise.resolve().then(()=>YN),[]);window.pdfjsLib=$,t(!0)}catch($){console.error("Failed to load PDF.js:",$),N($)}})()},[]),{pdfLibLoaded:r,pdfDoc:e,numPages:a,pageNumber:c,pageScale:d,pdfTextContent:m,docStats:v,docHash:_,isLoading:S,loadingMessage:R,loadError:D,loadPdfFromBlob:async Y=>{if(!(!window.pdfjsLib||!Y))try{E(!0),N(null);const $=Y.name||"document";C(`Loading ${$}...`);const H=await Y.arrayBuffer(),J=await av(H);x(J);const rt=await window.pdfjsLib.getDocument({data:H,onProgress:q=>{if(q.total>0){const tt=Math.round(q.loaded/q.total*100);C(`Loading ${$}: ${tt}%`)}}}).promise;i(rt),l(rt.numPages),C(`Extracting text from ${$}...`);const pt=await sv(rt);g(pt);const P=cu({pageCount:rt.numPages,extractedText:pt,pdfSizeBytes:H.byteLength});return w(P),u(1),C(""),{docHash:J,stats:P,text:pt}}catch($){throw console.error("Error loading PDF from blob:",$),N($),C(""),$}finally{E(!1)}},loadTestPdf:async Y=>{if(window.pdfjsLib)try{E(!0),N(null),C(`Loading ${Y}...`);const $=`/test-docs/${Y}`,H=await fetch($);if(!H.ok)throw new Error(`Failed to fetch PDF: ${H.statusText}`);const J=await H.arrayBuffer(),at=await av(J);x(at);const pt=await window.pdfjsLib.getDocument({data:J,onProgress:tt=>{if(tt.total>0){const mt=Math.round(tt.loaded/tt.total*100);C(`Loading ${Y}: ${mt}%`)}}}).promise;i(pt),l(pt.numPages),C(`Extracting text from ${Y}...`);const P=await sv(pt);g(P);const q=cu({pageCount:pt.numPages,extractedText:P,pdfSizeBytes:J.byteLength});return w(q),u(1),C(""),{docHash:at,stats:q,text:P,fileInfo:{name:Y,size:J.byteLength,type:"application/pdf"}}}catch($){throw console.error("Error loading test PDF:",$),N($),C(""),$}finally{E(!1)}},navigation:{goToPreviousPage:()=>u(Y=>Math.max(Y-1,1)),goToNextPage:()=>u(Y=>Math.min(Y+1,a||1)),zoomIn:()=>f(Y=>Math.min(Y+.2,3)),zoomOut:()=>f(Y=>Math.max(Y-.2,.5)),setPageNumber:u,setPageScale:f}}};async function XN({functions:r,docHash:t,text:e}){if(!r)throw new Error("Firebase functions not available");const i=oi(r,"analyzeByType");if(typeof i!="function")throw new Error("analyzeByType callable not available");return(await i({docHash:t,text:e}))?.data}async function WN({functions:r,docHash:t,stats:e}){if(!r)throw new Error("Firebase functions not available");const i=oi(r,"preflightCheck");if(typeof i!="function")throw new Error("preflightCheck callable not available");return(await i({docHash:t,stats:e}))?.data}async function KN({functions:r,payload:t}){if(!r)throw new Error("Firebase functions not available");const e=oi(r,"analyzeText");if(typeof e!="function")throw new Error("analyzeText callable not available");return await e(t)}const QN=({functions:r,authState:t,isMockMode:e})=>{const[i,a]=I.useState({}),[l,c]=I.useState(null),[u,d]=I.useState(!1),f=()=>e&&t.status==="authenticated"?!0:r&&t.status==="authenticated",m=async({pdfTextContent:S,numPages:E,selectedDocument:R,docHash:C})=>{if(!S||!E)return{ok:!0,classification:"OK"};if(e)return{ok:!0,classification:"OK"};if(!r)return console.error("Firebase functions not available. Returning default response."),{ok:!0,classification:"OK"};try{const D=cu({pageCount:E,extractedText:S,pdfSizeBytes:R?.size||0});return await WN({functions:r,docHash:C,stats:D})}catch(D){return console.error("Preflight check error:",D),{ok:!0,classification:"OK"}}};return{analysisResults:i,gate:l,setGate:c,isLoading:u,handleAnalyzeDocument:async({selectedDocument:S,pdfTextContent:E,docHash:R,numPages:C,updateAnnotations:D})=>{if(!(!S||!E||!R)){if(!f()){console.warn("Document analysis unavailable: Firebase services not accessible.");return}a(N=>({...N,[S.id]:{...N[S.id]||{},_meta:{status:"loading",message:"Running analysis"}}})),d(!0);try{const N=await m({pdfTextContent:E,numPages:C,selectedDocument:S,docHash:R});if(!N.ok)throw console.error("Preflight check failed:",N),new Error(N.message||"Preflight check failed");if(N.classification==="PRO_REQUIRED"){const H=N.reasons?.map(J=>J.message).join(" ")||"This document requires Pro features (OCR / deeper processing).";a(J=>({...J,[S.id]:{...J[S.id]||{},_meta:{status:"error",message:H}}})),c({title:"Pro required",message:H,primaryLabel:"Upgrade to Pro",primaryTo:"/pricing",secondaryLabel:"Cancel",secondaryTo:null});return}const L=cu({pageCount:C,extractedText:E,pdfSizeBytes:S?.size||0}),j=E.split("\f"),{charsPerPage:K,totalChars:Y}=L;let $;if(e?$={data:await(await fetch("/analyzeText",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docHash:R,stats:{pageCount:C,charsPerPage:K,totalChars:Y,languageHint:"en"},text:{format:"paged",value:E},options:{tasks:["explain","caveats","inconsistencies"],targetLanguage:null}})})).json()}:$=await KN({functions:r,payload:{docHash:R,stats:{pageCount:C,charsPerPage:K,totalChars:Y,languageHint:"en"},text:{format:"paged",value:E,pageTextIndex:j.map((H,J)=>({page:J+1,start:0,end:H.length}))},options:{tasks:["explain","caveats","inconsistencies"],targetLanguage:null}}}),$.data.ok){c(null);const H={_meta:{status:"success"},summary:$.data.result.plainExplanation,keyPoints:[],risks:$.data.result.risks.map(J=>({id:J.id,clause:J.title,riskLevel:J.severity,description:J.whyItMatters,explanation:J.whatToCheck.join("; ")})),recommendations:$.data.result.risks.flatMap(J=>J.whatToCheck||[])};a(J=>({...J,[S.id]:H})),D&&D(H)}else{const H=$.data.code;if(H==="SCAN_DETECTED_PRO_REQUIRED"){const J=$.data.message||"This PDF appears to be scanned. OCR is available on Pro.";a(at=>({...at,[S.id]:{...at[S.id]||{},_meta:{status:"error",message:J}}})),c({title:"Scanned PDF (OCR requires Pro)",message:J,primaryLabel:"Upgrade to Pro",primaryTo:"/pricing",secondaryLabel:"Cancel",secondaryTo:null});return}if(H==="ANON_TOKEN_LIMIT"){const J=$.data.message||"Anonymous token limit reached. Create a free account to continue.";a(at=>({...at,[S.id]:{...at[S.id]||{},_meta:{status:"error",message:J}}})),c({title:"Limit reached",message:J,primaryLabel:"Create free account",primaryTo:"/sign-in",secondaryLabel:"Cancel",secondaryTo:null});return}if(H==="FREE_TOKEN_LIMIT"){const J=$.data.message||"Daily token limit reached. Upgrade to Pro to continue.";a(at=>({...at,[S.id]:{...at[S.id]||{},_meta:{status:"error",message:J}}})),c({title:"Daily limit reached",message:J,primaryLabel:"Upgrade to Pro",primaryTo:"/pricing",secondaryLabel:"Cancel",secondaryTo:null});return}throw console.error("Analysis failed:",$.data),new Error($.data.message||"Analysis failed")}}catch(N){console.error("Error analyzing document:",N),a(L=>({...L,[S.id]:{...L[S.id]||{},_meta:{status:"error",message:N?.message||"Analysis failed."}}})),c({title:"Analysis failed",message:N?.message||"Request failed.",primaryLabel:"OK",primaryTo:null,secondaryLabel:null,secondaryTo:null});return}finally{d(!1)}}},handleAnalyzeByType:async({selectedDocument:S,pdfTextContent:E,docHash:R})=>{if(!(!S||!E||!R)){if(!f()){console.warn("Type-specific analysis unavailable: Firebase services not accessible.");return}a(C=>({...C,[S.id]:{...C[S.id]||{},_meta:{status:"loading",message:"Running type-specific analysis"}}})),d(!0);try{if(e){c({title:"Type-specific analysis (beta)",message:"Not available in mock mode yet.",primaryLabel:"OK",primaryTo:null,secondaryLabel:null,secondaryTo:null}),a(N=>({...N,[S.id]:{...N[S.id]||{},_meta:{status:"error",message:"Not available in mock mode yet."}}}));return}const C=await XN({functions:r,docHash:R,text:E})||{},D={ok:!!C.ok,effectiveTypeId:C.effectiveTypeId||null,validationSlug:C.validationSlug||null,validationTitle:C.validationSpec?.title||null,message:C.message||null,result:C.result||null,usage:C.usage||null,requiredTier:C.requiredTier||null,code:C.code||null};a(N=>({...N,[S.id]:{...N[S.id]||{},_meta:{status:"success"},typeSpecific:D}})),c({title:"Type-specific analysis (beta)",message:`effectiveTypeId: ${D.effectiveTypeId||"null"}
validationSlug: ${D.validationSlug||"null"}

`+(D.validationTitle?`Spec: ${D.validationTitle}

`:"")+(D.message||""),primaryLabel:"OK",primaryTo:null,secondaryLabel:null,secondaryTo:null})}catch(C){console.error("analyzeByType error:",C),a(D=>({...D,[S.id]:{...D[S.id]||{},_meta:{status:"error",message:C?.message||"Request failed."}}})),c({title:"Type-specific analysis failed",message:C?.message||"Request failed.",primaryLabel:"OK",primaryTo:null,secondaryLabel:null,secondaryTo:null})}finally{d(!1)}}},handleExplainSelection:async({selectedDocument:S,docHash:E,pdfTextContent:R})=>{if(!S||!E)return;if(!f()){console.warn("Explain selection unavailable: Firebase services not accessible.");return}const C="Limitation of liability clause";try{let D;if(e?D={data:await(await fetch("/explainSelection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docHash:E,selection:C,documentContext:R})})).json()}:D=await oi(r,"explainSelection")({docHash:E,selection:C,documentContext:R}),D.data.success)alert(`Explanation: ${D.data.explanation.plainExplanation}`);else throw console.error("Explanation failed:",D.data),new Error(D.data.error||"Explanation failed")}catch(D){throw console.error("Error explaining selection:",D),D}},handleHighlightRisks:async({selectedDocument:S,docHash:E,pdfTextContent:R,setRiskBadges:C})=>{if(!(!S||!E)){if(!f()){console.warn("Risk highlighting unavailable: Firebase services not accessible.");return}d(!0);try{let D;if(e?D={data:await(await fetch("/highlightRisks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docHash:E,documentText:R,documentType:"contract"})})).json()}:D=await oi(r,"highlightRisks")({docHash:E,documentText:R,documentType:"contract"}),D.data.success){alert(`Found ${D.data.risks.summary.totalRisks} risks in the document.`);const N=D.data.risks.items?.map((L,j)=>({id:j,pageNum:1,x:150+j*40,y:150+j*35,level:L.riskLevel,description:L.description,explanation:L.explanation}))||[];C(N)}else throw console.error("Risk highlighting failed:",D.data),new Error(D.data.error||"Risk highlighting failed")}catch(D){throw console.error("Error highlighting risks:",D),D}finally{d(!1)}}},handleTranslateToPlainEnglish:async({selectedDocument:S,docHash:E,pdfTextContent:R})=>{if(!(!S||!E)){if(!f()){console.warn("Translation unavailable: Firebase services not accessible.");return}try{const C=R.substring(0,500);let D;if(e?D={data:await(await fetch("/translateToPlainEnglish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docHash:E,legalText:C})})).json()}:D=await oi(r,"translateToPlainEnglish")({docHash:E,legalText:C}),D.data.success)alert(`Original: ${D.data.translation.originalText}

Plain English: ${D.data.translation.plainEnglishTranslation}`);else throw console.error("Translation failed:",D.data),new Error(D.data.error||"Translation failed")}catch(C){throw console.error("Error translating to plain English:",C),C}}}}};async function ZN({functions:r,docHash:t,typeId:e}){if(!r)throw new Error("Firebase functions not available");const i=oi(r,"saveDocTypeOverride");return typeof i!="function"?null:(await i({docHash:t,typeId:e}))?.data}async function JN({functions:r,docHash:t}){if(!r)throw new Error("Firebase functions not available");const e=oi(r,"getDocumentTypeState");return typeof e!="function"?null:(await e({docHash:t}))?.data}async function tM({functions:r,docHash:t,stats:e,text:i}){if(!r)throw new Error("Firebase functions not available");const a=oi(r,"detectDocumentType");return typeof a!="function"?null:(await a({docHash:t,stats:e,text:i}))?.data}const eM=({functions:r,isMockMode:t})=>{const[e,i]=I.useState("legal_contract_generic"),[a,l]=I.useState(null),[c,u]=I.useState(null),[d,f]=I.useState(null);return{detectedDocTypeId:e,detectedMeta:a,overrideDocTypeId:c,pendingOverride:d,setOverrideDocTypeId:u,setPendingOverride:f,loadServerTypeState:async _=>{if(!(!r||t))try{const x=await JN({functions:r,docHash:_})||{};x?.overrideTypeId&&u(x.overrideTypeId),x?.detected?.typeId&&i(x.detected.typeId),x?.detected&&l({intakeCategory:x.detected.intakeCategory||null,confidence:typeof x.detected.confidence=="number"?x.detected.confidence:null,model:x.detected.model||null,updatedAt:x.detected.updatedAt||null})}catch(x){console.warn("Failed to load server document type state",x)}},runServerDetection:async({docHashValue:_,stats:x,text:S})=>{if(!(!r||t))try{const E=await tM({functions:r,docHash:_,stats:x,text:S})||{};E?.typeId&&i(E.typeId),l({intakeCategory:E.intakeCategory||null,confidence:typeof E.confidence=="number"?E.confidence:null,model:E.model||"heuristic-v1",updatedAt:null})}catch(E){console.warn("Failed to detect document type",E)}},persistOverride:async(_,x)=>{try{localStorage.setItem(`decodocs:doctype:${_}`,String(x))}catch{}if(!(!r||t))try{await ZN({functions:r,docHash:_,typeId:x})}catch(S){console.warn("Failed to persist doc type override",S)}},loadLocalOverride:_=>{try{const x=localStorage.getItem(`decodocs:doctype:${_}`);x&&u(x)}catch{}},setDetectedDocTypeId:i}},gf=()=>{const{authState:r,app:t}=Cs(),e=typeof window<"u"&&window.MOCK_AUTH,{documentId:i,fileName:a}=vv(),l=yn(),c=Ts(),u=I.useRef(null),d=t?M1(t):null,{pdfLibLoaded:f,pdfDoc:m,numPages:g,pageNumber:v,pageScale:w,pdfTextContent:_,docHash:x,isLoading:S,loadingMessage:E,loadPdfFromBlob:R,loadTestPdf:C,navigation:D}=Cw(),{analysisResults:N,gate:L,setGate:j,isLoading:K,handleAnalyzeDocument:Y,handleAnalyzeByType:$,handleExplainSelection:H,handleHighlightRisks:J,handleTranslateToPlainEnglish:at}=QN({functions:d,authState:r,isMockMode:e}),{detectedDocTypeId:rt,overrideDocTypeId:pt,pendingOverride:P,setOverrideDocTypeId:q,setPendingOverride:tt,loadServerTypeState:mt,runServerDetection:St,persistOverride:k,loadLocalOverride:V}=eM({functions:d,isMockMode:e}),[Z,et]=I.useState(null),[ut,gt]=I.useState([]),[ht,ae]=I.useState([]),[Pt,Gn]=I.useState([]),[qn,Ln]=I.useState(!1),[aa,$n]=I.useState(!1),[ra,xr]=I.useState(!0),rl=S||K,{types:ol}=F1(),oa=Yt=>ol.find(re=>re.id===Yt)||null,la=oa(pt||rt),_u=oa(rt),Eu=la?.validationSlug||null;iD(Eu);const je=Yt=>{D.setPageNumber(Yt)},Tu=Yt=>{D.setPageNumber(Yt);const re=document.getElementById(`pdf-page-${Yt}`);re&&re.scrollIntoView({behavior:"smooth"})};I.useEffect(()=>{a&&f&&(async()=>{try{const re=await C(a);re&&(et({id:a,name:a,type:"application/pdf",size:re.fileInfo?.size,file:null}),V(re.docHash),await mt(re.docHash),St({docHashValue:re.docHash,stats:re.stats,text:re.text}))}catch(re){j({title:"Could not load PDF",message:re?.message||"Failed to load test PDF.",primaryLabel:"OK",primaryTo:null,secondaryLabel:null,secondaryTo:null})}})()},[a,f]),I.useEffect(()=>{if(l.state?.document&&!a&&f){const Yt=l.state.document;et(Yt),(async()=>{try{const Oe=await R(Yt.file);Oe&&(V(Oe.docHash),await mt(Oe.docHash),St({docHashValue:Oe.docHash,stats:Oe.stats,text:Oe.text}))}catch{}})()}},[l,a,f]);const Ar=Yt=>{const Oe=Array.from(Yt.target.files).filter(bn=>bn.type==="application/pdf");if(Oe.length>0){const bn=Oe[0],Vi={id:Date.now()+Math.random(),name:bn.name,size:bn.size,type:bn.type,file:bn};et(Vi),c("/view",{state:{document:Vi}})}},cl=()=>{Z&&c(`/edit/${Z.id}`,{state:{document:Z}})},ca=Yt=>{const re=[];Yt.risks&&Yt.risks.length>0&&Yt.risks.forEach((Oe,bn)=>{re.push({id:bn,pageNum:1,x:100+bn*50,y:100+bn*40,level:Oe.riskLevel,description:Oe.description,explanation:Oe.explanation})}),Gn(re)};return b.jsxs(Mn,{variant:"app",showFooter:!1,children:[L&&b.jsx("div",{role:"dialog","aria-modal":"true",className:"fixed inset-0 bg-slate-900/45 flex items-center justify-center z-[2000] p-4",onClick:()=>j(null),children:b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 max-w-[520px] w-full p-5 shadow-2xl",onClick:Yt=>Yt.stopPropagation(),children:[b.jsx("div",{className:"font-black text-base text-slate-900",children:L.title}),b.jsx("div",{className:"mt-2.5 text-slate-600 leading-relaxed whitespace-pre-wrap",children:L.message}),b.jsxs("div",{className:"mt-3.5 flex gap-2.5 flex-wrap justify-end",children:[L.secondaryLabel&&b.jsx("button",{type:"button",onClick:()=>{j(null),L.secondaryTo&&c(L.secondaryTo)},className:"px-3 py-2.5 rounded-xl border border-slate-200 bg-white font-black cursor-pointer hover:bg-slate-50 transition-colors",children:L.secondaryLabel}),L.primaryLabel&&b.jsx("button",{type:"button",onClick:async()=>{if(L._kind==="confirm-override"&&P&&x){const Yt=P.id;q(Yt),await k(x,Yt),tt(null),j(null);return}j(null),L.primaryTo&&c(L.primaryTo)},className:"px-3 py-2.5 rounded-xl border border-slate-900 bg-slate-900 text-white font-black cursor-pointer hover:bg-slate-800 transition-colors",children:L.primaryLabel})]})]})}),b.jsx(nD,{open:qn,detectedType:_u,onClose:()=>Ln(!1),onPick:Yt=>{Ln(!1),tt(Yt),j({title:"Confirm document type",message:`Set document type to ${Yt.label}? This will change the actions/checks we show for this document.`,primaryLabel:"Confirm",primaryTo:null,secondaryLabel:"Cancel",secondaryTo:null,_kind:"confirm-override"})}}),b.jsxs("div",{className:"flex flex-1 h-full overflow-hidden relative bg-slate-100",children:[b.jsxs("div",{className:"flex-1 flex flex-col items-center justify-start overflow-hidden relative",children:[x&&b.jsxs("div",{className:"absolute top-4 left-4 z-10 hidden lg:flex gap-2 items-center px-3 py-2 rounded-lg bg-white/90 backdrop-blur shadow-sm border border-slate-200/50",children:[b.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Type"}),b.jsx("span",{className:"text-sm font-semibold text-slate-700",children:la?.label||"Unknown"}),b.jsx("button",{onClick:()=>Ln(!0),className:"text-xs text-blue-600 font-medium hover:underline ml-1",children:"Change"})]}),m?b.jsxs("div",{className:"w-full flex-1 relative flex",children:[b.jsx(U1,{pdfDoc:m,numPages:g,currentPage:v,onPageClick:Tu}),b.jsx("div",{className:"flex-1 overflow-auto bg-slate-100/50 relative",children:b.jsx(j1,{pdfDoc:m,numPages:g,pageScale:w,isLoading:rl,loadingMessage:E,onPageVisible:je,highlights:ut,clauseMarkers:ht,riskBadges:Pt})})]}):b.jsx("div",{className:"flex-1 flex items-center justify-center w-full",children:b.jsx(B1,{onFileSelect:Ar})}),m&&b.jsx(P1,{onFileSelect:Ar,onEdit:cl,pageNumber:v,numPages:g,pageScale:w,onPreviousPage:D.goToPreviousPage,onNextPage:D.goToNextPage,onZoomIn:D.zoomIn,onZoomOut:D.zoomOut,fileInputRef:u})]}),b.jsx(JR,{isOpen:ra,onToggle:()=>xr(!ra),onAnalyzeDocument:()=>Y({selectedDocument:Z,pdfTextContent:_,docHash:x,numPages:g,updateAnnotations:ca}),onAnalyzeByType:()=>$({selectedDocument:Z,pdfTextContent:_,docHash:x}),onExplainSelection:()=>H({selectedDocument:Z,docHash:x,pdfTextContent:_}),onHighlightRisks:()=>J({selectedDocument:Z,docHash:x,pdfTextContent:_,setRiskBadges:Gn}),onTranslateToPlainEnglish:()=>at({selectedDocument:Z,docHash:x,pdfTextContent:_}),isLoading:rl,isAuthenticated:r.status==="authenticated",hasDocument:!!Z,selectedDocument:Z,analysisResults:N})]})]})},rv=()=>{const{documentId:r}=vv(),t=yn(),e=Ts(),i=I.useRef(null),{pdfLibLoaded:a,pdfDoc:l,numPages:c,pageNumber:u,pageScale:d,isLoading:f,loadingMessage:m,loadPdfFromBlob:g,loadTestPdf:v,navigation:w}=Cw(),[_,x]=I.useState(null),[S,E]=I.useState("select"),[R,C]=I.useState([]),[D,N]=I.useState([]),[L]=I.useState({width:150,height:50});I.useEffect(()=>{if(t.state?.document&&!l&&a){const $=t.state.document;x($),$.file&&g($.file).catch(console.error)}else if(t.pathname.includes("test-docs")&&a&&!l){t.pathname.split("/");const $=t.pathname.split("/").pop();$.endsWith(".pdf")&&v($).then(H=>{H&&x({name:$,id:"test-doc",type:"application/pdf"})})}else if(r&&a&&!l&&!t.pathname.includes("test-docs")){const $={id:r,name:`Document_${r}.pdf`,type:"application/pdf",file:null};x($)}},[t,r,a,l,g,v]);const j=$=>{if(S==="select")return;const H=$.target.closest("[data-page-num]");if(!H)return;const J=parseInt(H.getAttribute("data-page-num"),10),at=H.getBoundingClientRect(),rt=$.clientX-at.left,pt=$.clientY-at.top;if(S==="signature"){const P={id:Date.now(),pageNum:J,x:rt,y:pt,width:L.width,height:L.height,text:"John Doe",type:"signature"};C([...R,P]),E("select")}else if(S==="text"){const P={id:Date.now(),pageNum:J,x:rt,y:pt,text:"Type something...",type:"text"};N([...D,P]),E("select")}else if(S==="date"){const P={id:Date.now(),pageNum:J,x:rt,y:pt,text:new Date().toLocaleDateString(),type:"date"};N([...D,P]),E("select")}},K=$=>{const J=Array.from($.target.files).filter(at=>at.type==="application/pdf");if(J.length>0){const at=J[0],rt={id:Date.now(),name:at.name,size:at.size,type:at.type,file:at};x(rt),g(at)}},Y=$=>b.jsxs(b.Fragment,{children:[R.filter(H=>H.pageNum===$).map(H=>b.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-50/20 flex items-center justify-center cursor-move",style:{left:H.x,top:H.y,width:H.width,height:H.height,zIndex:50},onClick:J=>J.stopPropagation(),children:b.jsx("span",{className:"text-blue-700 font-script text-xl font-bold",children:H.text})},H.id)),D.filter(H=>H.pageNum===$).map(H=>b.jsx("div",{className:"absolute bg-yellow-100 border border-yellow-300 px-2 py-1 text-sm shadow-sm cursor-move",style:{left:H.x,top:H.y,zIndex:50},onClick:J=>J.stopPropagation(),children:H.text},H.id))]});return b.jsx(Mn,{variant:"app",showFooter:!1,children:b.jsxs("div",{className:"flex flex-col h-full bg-slate-100",children:[b.jsxs("div",{className:"h-16 bg-white border-b border-slate-200 px-4 flex items-center justify-between shadow-sm z-20 relative font-sans",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsx("button",{className:"p-2 hover:bg-slate-100 rounded-lg text-slate-600",children:b.jsx(IR,{className:"w-6 h-6"})}),b.jsxs("div",{className:"flex flex-col",children:[b.jsx("span",{className:"font-bold text-slate-800 text-lg leading-tight",children:_?.name||"Untitled Document"}),b.jsx("span",{className:"text-xs text-slate-500",children:"Edit Mode"})]})]}),b.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center gap-2 bg-slate-50 p-1.5 rounded-xl border border-slate-200 shadow-sm",children:[b.jsx(So,{active:S==="select",icon:MR,label:"Select",onClick:()=>E("select"),tooltip:"Select & Move"}),b.jsx("div",{className:"w-px h-6 bg-slate-300 mx-1"}),b.jsx(So,{active:S==="text",icon:DR,label:"Text",onClick:()=>E("text"),tooltip:"Add Text"}),b.jsx(So,{active:S==="signature",icon:PR,label:"Sign",onClick:()=>E("signature"),tooltip:"Create Signature"}),b.jsx(So,{active:S==="image",icon:jR,label:"Image",onClick:()=>E("image"),tooltip:"Insert Image"}),b.jsx(So,{active:S==="shape",icon:HR,label:"Shapes",onClick:()=>E("shape"),tooltip:"Add Shapes"})]}),b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("button",{onClick:()=>e("/view"),className:"px-4 py-2 text-slate-600 font-semibold hover:bg-slate-100 rounded-lg transition-colors",children:"Cancel"}),b.jsxs("button",{className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg shadow-blue-600/20 transition-all hover:-translate-y-0.5 active:translate-y-0",children:["Finish & Download ",b.jsx(LR,{className:"w-5 h-5"})]})]})]}),b.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[l&&b.jsx(U1,{pdfDoc:l,numPages:c,currentPage:u,onPageClick:$=>{w.setPageNumber($);const H=document.getElementById(`pdf-page-${$}`);H&&H.scrollIntoView({behavior:"smooth"})}}),b.jsx("div",{className:"flex-1 overflow-auto p-8 flex justify-center relative bg-slate-100/50",children:l?b.jsx("div",{className:"w-full flex justify-center",style:{minHeight:"100%"},onClick:j,children:b.jsx(j1,{pdfDoc:l,numPages:c,pageScale:d,isLoading:f,loadingMessage:m,onPageVisible:$=>w.setPageNumber($),renderPageOverlay:Y})}):b.jsx("div",{className:"flex-1 flex items-center justify-center w-full",children:b.jsx(B1,{onFileSelect:K})})}),b.jsx(P1,{onFileSelect:K,onEdit:()=>{},pageNumber:u,numPages:c,pageScale:d,onPreviousPage:w.goToPreviousPage,onNextPage:w.goToNextPage,onZoomIn:w.zoomIn,onZoomOut:w.zoomOut,fileInputRef:i})]})]})})},So=({active:r,icon:t,label:e,onClick:i,tooltip:a})=>b.jsx("button",{onClick:i,title:a||e,className:`flex items-center justify-center p-2.5 rounded-lg transition-all relative ${r?"!bg-slate-200/80 !text-slate-800":"!bg-transparent !text-slate-500 hover:!bg-slate-200/50 hover:!text-slate-800"}`,children:b.jsx(t,{className:"w-5 h-5"})}),nM=()=>b.jsxs("div",{className:"about-page",children:[b.jsx("header",{className:"App-header",children:b.jsxs(Xt,{to:"/",style:{textDecoration:"none",color:"white"},children:[b.jsx("h1",{children:"DecoDocs"}),b.jsx("p",{children:b.jsx("strong",{children:"Understand documents before you sign."})})]})}),b.jsx("main",{className:"about-main",children:b.jsxs("div",{className:"about-container",children:[b.jsxs("section",{className:"about-header",children:[b.jsx("h1",{children:"About DecoDocs"}),b.jsx("p",{children:"DecoDocs is a document intelligence product designed to help people understand what they are about to sign. Before any signature, DecoDocs explains documents in plain language, highlights caveats and unfair conditions, flags logical inconsistencies, and provides translations when needed. Our focus is clarity before commitment."})]}),b.jsxs("section",{className:"product-philosophy",children:[b.jsx("h2",{children:"What We Believe"}),b.jsxs("ul",{className:"philosophy-list",children:[b.jsx("li",{children:"Documents should be understood before being signed"}),b.jsx("li",{children:"AI should reduce information asymmetry, not introduce new ones"}),b.jsx("li",{children:"Free users deserve real value, not crippled features"}),b.jsx("li",{children:"We charge only for real costs: deeper analysis and storage"}),b.jsx("li",{children:"Documents belong to users, not platforms"})]})]}),b.jsxs("section",{className:"scope-definition",children:[b.jsx("h2",{children:"What DecoDocs Is  and Is Not"}),b.jsxs("div",{className:"scope-columns",children:[b.jsxs("div",{className:"scope-column",children:[b.jsx("h3",{children:"Is"}),b.jsxs("ul",{children:[b.jsx("li",{children:"Pre-signature document analysis"}),b.jsx("li",{children:"Plain-language explanation"}),b.jsx("li",{children:"Caveat and unfair-condition detection"}),b.jsx("li",{children:"Logical inconsistency checks"}),b.jsx("li",{children:"Ephemeral processing by default"})]})]}),b.jsxs("div",{className:"scope-column",children:[b.jsx("h3",{children:"Is Not"}),b.jsxs("ul",{children:[b.jsx("li",{children:"A document editor"}),b.jsx("li",{children:"A document management system"}),b.jsx("li",{children:'A "sign now, think later" tool'}),b.jsx("li",{children:"A storage-first SaaS"}),b.jsx("li",{children:"A replacement for legal advice"})]})]})]})]}),b.jsxs("section",{className:"decodocs-clarification",children:[b.jsx("h2",{children:"How It Relates To SnapSign"}),b.jsx("p",{children:"Snap Sign Pty Ltd builds DecoDocs. SnapSign is the company brand and broader product family; DecoDocs is the document understanding and analysis product in that family."})]}),b.jsxs("section",{className:"team-company",children:[b.jsx("h2",{children:"Company"}),b.jsx("p",{children:"SnapSign is built by a small, focused team with backgrounds in software engineering, automation, and privacy-first systems. We prioritize correctness, transparency, and long-term maintainability."}),b.jsxs("div",{className:"legal-block",children:[b.jsx("p",{children:"Snap Sign Pty Ltd"}),b.jsx("p",{children:"ABN 72 679 570 757"}),b.jsx("p",{children:"Australia"})]})]}),b.jsxs("section",{className:"collaboration-contact",children:[b.jsx("h2",{children:"Collaboration"}),b.jsx("p",{children:"We welcome serious collaboration and partnership enquiries. For certain discussions, a Non-Disclosure Agreement (NDA) may be required before sharing internal details."}),b.jsx("div",{className:"contact-info",children:b.jsxs("p",{children:["Email: ",b.jsx("a",{href:"mailto:partnerships@snapsign.com.au",children:"partnerships@snapsign.com.au"})]})})]})]})}),b.jsx("footer",{className:"about-footer",children:b.jsxs("div",{className:"footer-content",children:[b.jsx("p",{children:" Snap Sign Pty Ltd"}),b.jsx("p",{children:"ABN 72 679 570 757"}),b.jsxs("div",{className:"footer-links",children:[b.jsx(Xt,{to:"/about",children:"About"}),b.jsx(Xt,{to:"/privacy",children:"Privacy Policy"}),b.jsx(Xt,{to:"/terms",children:"Terms of Service"}),b.jsx(Xt,{to:"/contact",children:"Contact"})]})]})})]}),iM=()=>b.jsxs("section",{className:"mx-auto w-full max-w-4xl px-6 py-16",children:[b.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Privacy Policy"}),b.jsx("p",{className:"mt-4 text-sm text-slate-600",children:"Last updated: 1 February 2026"}),b.jsxs("div",{className:"mt-10 space-y-6 text-slate-700 leading-relaxed",children:[b.jsx("p",{children:'DecoDocs ("we", "us") is built by Snap Sign Pty Ltd. This policy explains what data is processed when you use DecoDocs, what is stored, and what choices you have.'}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"What we process"}),b.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[b.jsx("li",{children:"PDF file metadata (filename, size) and content needed to render and analyze the document."}),b.jsx("li",{children:"Extracted text used to generate summaries, explanations, and risk highlights."}),b.jsx("li",{children:"Basic usage events (e.g. button clicks) to understand product performance."})]}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Storage (Free vs Pro)"}),b.jsxs("p",{children:[b.jsx("strong",{children:"Free:"})," we aim to avoid storing your files. Documents are opened for viewing and analysis without persistent storage."]}),b.jsxs("p",{children:[b.jsx("strong",{children:"Pro (optional):"})," secure storage may be available for users who explicitly choose to save documents for later access."]}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Retention"}),b.jsx("p",{children:"We retain only what is necessary to operate the service. Where storage is enabled (e.g. Pro), retention and deletion controls will be provided."}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Your controls"}),b.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[b.jsx("li",{children:"You can choose whether to use free (no-storage) workflows or paid storage features when available."}),b.jsx("li",{children:"You can contact us to request deletion or export of stored data where applicable."})]}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Contact"}),b.jsxs("p",{children:["Questions or requests: ",b.jsx("a",{className:"underline",href:"mailto:team@snapsign.com.au",children:"team@snapsign.com.au"})]})]})]}),sM=()=>b.jsxs("section",{className:"mx-auto w-full max-w-4xl px-6 py-16",children:[b.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Terms of Service"}),b.jsx("p",{className:"mt-4 text-sm text-slate-600",children:"Last updated: 1 February 2026"}),b.jsxs("div",{className:"mt-10 space-y-6 text-slate-700 leading-relaxed",children:[b.jsx("p",{children:"These terms govern use of DecoDocs provided by Snap Sign Pty Ltd. By using the service, you agree to these terms."}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Not legal advice"}),b.jsx("p",{children:"DecoDocs provides informational analysis and is not legal advice. For legal decisions, consult a qualified professional."}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Acceptable use"}),b.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[b.jsx("li",{children:"Do not upload content you do not have the right to process."}),b.jsx("li",{children:"Do not attempt to abuse, probe, or disrupt the service."}),b.jsx("li",{children:"Do not use the service for illegal activity."})]}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Availability and changes"}),b.jsx("p",{children:"The service may change over time. We may add, modify, or remove features. We may suspend access to protect the service or comply with law."}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Limitation of liability"}),b.jsx("p",{children:"To the maximum extent permitted by law, Snap Sign Pty Ltd is not liable for indirect or consequential losses arising from use of the service."}),b.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Contact"}),b.jsxs("p",{children:["Questions: ",b.jsx("a",{className:"underline",href:"mailto:team@snapsign.com.au",children:"team@snapsign.com.au"})]})]})]}),aM=()=>{const r="mailto:contact@snapsign.com?subject="+encodeURIComponent("DecoDocs signing waitlist");return b.jsxs("section",{className:"mx-auto w-full max-w-3xl px-6 py-16",children:[b.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Contact"}),b.jsxs("p",{className:"mt-4 text-slate-700",children:["For support, partnerships, or product feedback, email us at"," ",b.jsx("a",{className:"underline",href:"mailto:team@snapsign.com.au",children:"team@snapsign.com.au"}),"."]}),b.jsxs("div",{className:"mt-10 rounded-2xl border border-slate-200 bg-white p-6",children:[b.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Signing waitlist"}),b.jsx("p",{className:"mt-2 text-slate-700",children:"Want the signing workflow? Join the waitlist and tell us your use case."}),b.jsx("a",{className:"mt-4 inline-flex rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white",href:r,children:"Join the waitlist"})]})]})},Bc=r=>{try{return new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",maximumFractionDigits:0}).format(r)}catch{return`$${r} AUD`}},yf=({items:r})=>b.jsx("ul",{style:{margin:0,paddingLeft:18,color:"#0f172a",lineHeight:1.7},children:r.map(t=>b.jsx("li",{style:{marginBottom:6},children:t},t))});function rM(){const r=Ts(),{authState:t}=Cs(),[e,i]=I.useState("monthly"),[a,l]=I.useState(null),c=I.useMemo(()=>e==="annual"?{label:Bc(60),suffix:"/year"}:{label:Bc(5),suffix:"/month"},[e]),u=async()=>{if(l(null),!t?.user){r("/sign-in?intent=upgrade");return}try{const{getFunctions:v,httpsCallable:w}=await dp(async()=>{const{getFunctions:R,httpsCallable:C}=await Promise.resolve().then(()=>L1);return{getFunctions:R,httpsCallable:C}},void 0),_=v(),E=(await w(_,"stripeCreateCheckoutSession")({billing:e}))?.data?.url;if(!E)throw new Error("No checkout URL returned");window.location.assign(E)}catch(v){l(`Could not start Stripe checkout: ${v?.message||v}`)}},d=()=>r("/sign-in"),f={padding:"2.5rem 1.5rem",maxWidth:1100,margin:"0 auto"},m={border:"1px solid #e2e8f0",borderRadius:14,background:"#fff",padding:18},g=v=>({padding:"8px 12px",borderRadius:999,border:`1px solid ${v?"#0f172a":"#e2e8f0"}`,background:v?"#0f172a":"#ffffff",color:v?"#ffffff":"#0f172a",fontWeight:700,fontSize:13,cursor:"pointer"});return b.jsxs("div",{style:f,children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"center"},children:[b.jsxs("div",{children:[b.jsx("h1",{style:{margin:0},children:"Pricing"}),b.jsx("p",{style:{marginTop:10,marginBottom:0,color:"#334155",lineHeight:1.6},children:"Three user types, one rule: pay only when your usage costs us money."})]}),b.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[b.jsx("button",{type:"button",onClick:()=>i("monthly"),style:g(e==="monthly"),children:"Monthly"}),b.jsx("button",{type:"button",onClick:()=>i("annual"),style:g(e==="annual"),children:"Annual"})]})]}),a&&b.jsx("div",{style:{marginTop:16,padding:12,borderRadius:12,background:"#fff7ed",border:"1px solid #fed7aa",color:"#9a3412"},children:a}),b.jsxs("div",{style:{marginTop:22,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:14},children:[b.jsxs("div",{style:m,children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[b.jsx("div",{style:{fontWeight:800,fontSize:16},children:"Anonymous"}),b.jsxs("div",{style:{fontWeight:800,fontSize:18},children:[Bc(0),b.jsx("span",{style:{color:"#64748b",fontWeight:600,fontSize:12},children:"/forever"})]})]}),b.jsx("p",{style:{marginTop:10,color:"#475569",lineHeight:1.6},children:"Try DecoDocs instantly. Minimal AI budget. No OCR. No storage."}),b.jsx("button",{type:"button",onClick:()=>r("/view"),style:{width:"100%",marginTop:8,padding:"10px 14px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:800,cursor:"pointer"},children:"Start now"}),b.jsx("div",{style:{marginTop:14},children:b.jsx(yf,{items:["AI analysis: 20k tokens per uid session","Text-only PDFs (no OCR)","No storage (browser-only)"]})})]}),b.jsxs("div",{style:m,children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[b.jsx("div",{style:{fontWeight:800,fontSize:16},children:"Free"}),b.jsxs("div",{style:{fontWeight:800,fontSize:18},children:[Bc(0),b.jsx("span",{style:{color:"#64748b",fontWeight:600,fontSize:12},children:"/forever"})]})]}),b.jsx("p",{style:{marginTop:10,color:"#475569",lineHeight:1.6},children:"Create an account to get a bigger daily budget and manage linked sign-in methods."}),b.jsx("button",{type:"button",onClick:d,style:{width:"100%",marginTop:8,padding:"10px 14px",borderRadius:12,border:"1px solid #0f172a",background:"#0f172a",color:"#fff",fontWeight:900,cursor:"pointer"},children:"Continue for free"}),b.jsx("div",{style:{marginTop:14},children:b.jsx(yf,{items:["AI analysis: 40k tokens/day per uid","Text-only PDFs (no OCR)","No storage with us (browser-only)","Link multiple providers (Google/Email/Apple/Microsoft)"]})})]}),b.jsxs("div",{style:{...m,borderColor:"#0f172a"},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[b.jsx("div",{style:{fontWeight:900,fontSize:16},children:"Pro"}),b.jsxs("div",{style:{fontWeight:900,fontSize:18},children:[c.label,b.jsx("span",{style:{color:"#64748b",fontWeight:600,fontSize:12},children:c.suffix})]})]}),b.jsx("p",{style:{marginTop:10,color:"#475569",lineHeight:1.6},children:"OCR for scanned PDFs, unlimited analysis (for now), better model, and 5GB storage."}),b.jsx("button",{type:"button",onClick:u,style:{width:"100%",marginTop:8,padding:"10px 14px",borderRadius:12,border:"1px solid #0f172a",background:"#0f172a",color:"#fff",fontWeight:900,cursor:"pointer"},children:"Upgrade"}),b.jsx("div",{style:{marginTop:14},children:b.jsx(yf,{items:["Unlimited AI (until abuse policy exists)","OCR / vision model for scanned PDFs","5GB storage (Contabo VPS)","Receipts + subscription management in /profile"]})})]})]}),b.jsxs("div",{style:{marginTop:22,display:"flex",gap:12,flexWrap:"wrap"},children:[b.jsx(Xt,{to:"/profile",style:{color:"#0f172a",fontWeight:800},children:"Go to profile"}),b.jsx(Xt,{to:"/terms",style:{color:"#475569",fontWeight:700},children:"Terms"}),b.jsx(Xt,{to:"/privacy",style:{color:"#475569",fontWeight:700},children:"Privacy"})]}),b.jsxs("div",{style:{marginTop:22,padding:16,borderRadius:12,background:"#f8fafc",border:"1px solid #e2e8f0"},children:[b.jsx("div",{style:{fontWeight:900,marginBottom:8},children:"Notes"}),b.jsxs("div",{style:{color:"#475569",lineHeight:1.7},children:["Well prompt you to upgrade when you hit limits or when a scanned/OCR-required document is detected. Upgrade redirects to ",b.jsx("code",{children:"/pricing"}),", and account linking is handled via ",b.jsx("code",{children:"/sign-in"}),"."]})]})]})}const oM=()=>{const{search:r}=yn();return I.useMemo(()=>new URLSearchParams(r),[r])},ov=({children:r})=>b.jsx("div",{style:{border:"1px solid #e2e8f0",borderRadius:14,background:"#fff",padding:18},children:r});function lM(){const{authState:r,auth:t,signInWithGoogle:e,signInWithMicrosoft:i,signInWithApple:a,signInWithEmail:l,signUpWithEmail:c,resetPassword:u,signOutUser:d}=Cs(),f=Ts(),m=oM(),[g,v]=I.useState(""),[w,_]=I.useState(""),[x,S]=I.useState({kind:"idle",message:""}),E=r?.user||null,R=!!E?.isAnonymous,C=m.get("intent"),D=async(H,J)=>{S({kind:"loading",message:"Opening sign-in"});try{if(!t)throw new Error("Auth is not available");if(t.currentUser)await VT(t.currentUser,H);else if(J)await J();else throw new Error("No active session. Refresh and try again.");S({kind:"ok",message:"Signed in. Your accounts are linked."}),f("/profile")}catch(at){const rt=at?.code||"";if(rt==="auth/credential-already-in-use"||rt==="auth/email-already-in-use"){S({kind:"error",message:"That account is already used elsewhere. Please sign out and sign in with that provider, then link the others from your profile."});return}S({kind:"error",message:at?.message||"Sign-in failed."})}},N=async()=>{S({kind:"loading",message:"Linking email"});try{if(!t)throw new Error("Auth is not available");if(!t.currentUser)throw new Error("No active session. Refresh and try again.");if(!g||!w)throw new Error("Email and password are required.");const H=na.credential(g,w);await yT(t.currentUser,H),S({kind:"ok",message:"Email sign-in linked."}),f("/profile")}catch(H){if((H?.code||"")==="auth/email-already-in-use"){S({kind:"error",message:"Email already exists. Use Sign out, then sign in with that email, and link providers from /profile."});return}S({kind:"error",message:H?.message||"Email linking failed."})}},L=async()=>{S({kind:"loading",message:"Signing in"});try{if(!g||!w)throw new Error("Email and password are required.");await l(g,w),S({kind:"ok",message:"Signed in."}),f("/profile")}catch(H){S({kind:"error",message:H?.message||"Email sign-in failed."})}},j=async()=>{S({kind:"loading",message:"Creating account"});try{if(!g||!w)throw new Error("Email and password are required.");if(String(w).length<10)throw new Error("Password must be at least 10 characters.");await c(g,w),S({kind:"ok",message:"Account created and signed in."}),f("/profile")}catch(H){S({kind:"error",message:H?.message||"Email sign-up failed."})}},K=async()=>{S({kind:"loading",message:"Sending reset email"});try{if(!g)throw new Error("Enter your email first.");await u(g),S({kind:"ok",message:"Password reset email sent (if the account exists)."})}catch(H){S({kind:"error",message:H?.message||"Password reset failed."})}},Y=async()=>{await(d?d():t?op(t):Promise.resolve()),S({kind:"ok",message:"Signed out. Refreshing"}),window.location.reload()},$=C==="upgrade"?"Sign in to upgrade":"Sign in";return b.jsxs("div",{style:{padding:"2.5rem 1.5rem",maxWidth:900,margin:"0 auto"},children:[b.jsx("h1",{style:{marginTop:0},children:$}),b.jsx("p",{style:{marginTop:10,color:"#475569",lineHeight:1.6},children:"We support Google, Email, Apple, and Microsoft. Linking is universal  you can attach multiple providers to one account."}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:14,marginTop:16},children:[b.jsxs(ov,{children:[b.jsx("div",{style:{fontWeight:900},children:"Continue with a provider"}),b.jsxs("div",{style:{marginTop:12,display:"grid",gap:10},children:[b.jsx("button",{type:"button",onClick:()=>D(new si,e),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:800,cursor:"pointer"},children:"Continue with Google"}),b.jsx("button",{type:"button",onClick:()=>D(new _s("apple.com"),a),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:800,cursor:"pointer"},children:"Continue with Apple"}),b.jsx("button",{type:"button",onClick:()=>D(new _s("microsoft.com"),i),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:800,cursor:"pointer"},children:"Continue with Microsoft"})]})]}),b.jsxs(ov,{children:[b.jsx("div",{style:{fontWeight:900},children:"Email + password"}),b.jsxs("div",{style:{marginTop:10,display:"grid",gap:10},children:[b.jsx("input",{value:g,onChange:H=>v(H.target.value),placeholder:"Email",style:{padding:10,borderRadius:12,border:"1px solid #e2e8f0"}}),b.jsx("input",{value:w,onChange:H=>_(H.target.value),placeholder:"Password",type:"password",style:{padding:10,borderRadius:12,border:"1px solid #e2e8f0"}}),b.jsxs("div",{style:{display:"grid",gap:10},children:[b.jsx("button",{type:"button",onClick:N,style:{padding:"10px 12px",borderRadius:12,border:"1px solid #0f172a",background:"#0f172a",color:"#fff",fontWeight:900,cursor:"pointer"},children:"Link email to current session"}),b.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[b.jsx("button",{type:"button",onClick:L,style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:900,cursor:"pointer",flex:1},children:"Sign in with email"}),b.jsx("button",{type:"button",onClick:j,style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:900,cursor:"pointer",flex:1},children:"Create account"})]}),b.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[b.jsx("button",{type:"button",onClick:K,style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:900,cursor:"pointer"},children:"Reset password"}),b.jsx("button",{type:"button",onClick:Y,style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:900,cursor:"pointer"},children:"Sign out"})]})]}),b.jsx("div",{style:{color:"#64748b",fontSize:13,lineHeight:1.5},children:"Recommended password minimum: 10 chars. If an email already exists and linking fails, sign out then sign in using that email."})]})]})]}),x.kind!=="idle"&&b.jsx("div",{style:{marginTop:14,padding:12,borderRadius:12,border:"1px solid "+(x.kind==="error"?"#fecaca":"#bbf7d0"),background:x.kind==="error"?"#fef2f2":"#f0fdf4",color:x.kind==="error"?"#991b1b":"#166534"},children:x.message}),b.jsxs("div",{style:{marginTop:18,display:"flex",gap:12,flexWrap:"wrap"},children:[b.jsx(Xt,{to:"/pricing",style:{color:"#0f172a",fontWeight:800},children:"Back to pricing"}),b.jsx(Xt,{to:"/",style:{color:"#475569",fontWeight:700},children:"Home"})]}),b.jsxs("div",{style:{marginTop:18,padding:14,borderRadius:12,background:"#f8fafc",border:"1px solid #e2e8f0"},children:[b.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"Current session"}),b.jsxs("div",{style:{color:"#475569",lineHeight:1.7},children:["Status: ",b.jsx("strong",{children:r?.status}),b.jsx("br",{}),"UID: ",b.jsx("code",{children:E?.uid||"n/a"}),b.jsx("br",{}),"Anonymous: ",b.jsx("strong",{children:String(R)})]})]})]})}function cM(){const{authState:r,auth:t}=Cs(),e=Ts(),i=r?.user,[a,l]=I.useState(null),c=async()=>{t&&(await op(t),window.location.reload())},u=async()=>{l(null);try{const{getFunctions:d,httpsCallable:f}=await dp(async()=>{const{getFunctions:_,httpsCallable:x}=await Promise.resolve().then(()=>L1);return{getFunctions:_,httpsCallable:x}},void 0),m=d(),w=(await f(m,"stripeCreatePortalSession")({}))?.data?.url;if(!w)throw new Error("No portal URL returned");window.location.assign(w)}catch(d){l(`Could not open Stripe portal: ${d?.message||d}`)}};return b.jsxs("div",{style:{padding:"2.5rem 1.5rem",maxWidth:900,margin:"0 auto"},children:[b.jsx("h1",{style:{marginTop:0},children:"Profile"}),b.jsx("p",{style:{marginTop:10,color:"#475569",lineHeight:1.6},children:"Manage linked accounts and subscription. Receipts and subscription management use Stripe Customer Portal."}),a&&b.jsx("div",{style:{marginTop:16,padding:12,borderRadius:12,background:"#fff7ed",border:"1px solid #fed7aa",color:"#9a3412"},children:a}),b.jsxs("div",{style:{marginTop:16,padding:16,borderRadius:14,border:"1px solid #e2e8f0",background:"#fff"},children:[b.jsx("div",{style:{fontWeight:900},children:"Session"}),b.jsxs("div",{style:{marginTop:10,color:"#0f172a",lineHeight:1.7},children:["Status: ",b.jsx("strong",{children:r?.status}),b.jsx("br",{}),"UID: ",b.jsx("code",{children:i?.uid||"n/a"}),b.jsx("br",{}),"Anonymous: ",b.jsx("strong",{children:String(!!i?.isAnonymous)})]}),b.jsxs("div",{style:{marginTop:12,color:"#475569"},children:["Linked providers: ",i?.providerData?.length?b.jsx("ul",{style:{margin:"6px 0 0",paddingLeft:18},children:i.providerData.map(d=>b.jsxs("li",{children:[b.jsx("code",{children:d.providerId}),d.email?`  ${d.email}`:""]},d.providerId))}):b.jsx("span",{children:"none (anonymous)"})]}),b.jsxs("div",{style:{marginTop:14,display:"flex",gap:10,flexWrap:"wrap"},children:[b.jsx("button",{type:"button",onClick:()=>e("/sign-in"),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #0f172a",background:"#0f172a",color:"#fff",fontWeight:900,cursor:"pointer"},children:"Link accounts"}),b.jsx("button",{type:"button",onClick:u,style:{padding:"10px 12px",borderRadius:12,border:"1px solid #0f172a",background:"#fff",fontWeight:900,cursor:"pointer"},children:"Billing & receipts"}),b.jsx("button",{type:"button",onClick:c,style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff",fontWeight:900,cursor:"pointer"},children:"Sign out"})]})]}),b.jsxs("div",{style:{marginTop:18,display:"flex",gap:12,flexWrap:"wrap"},children:[b.jsx(Xt,{to:"/pricing",style:{color:"#0f172a",fontWeight:800},children:"Pricing"}),b.jsx(Xt,{to:"/view",style:{color:"#475569",fontWeight:700},children:"Analyze a PDF"})]})]})}class uM extends Un.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,e){console.error("ErrorBoundary caught an error:",t,e),this.setState({error:t,errorInfo:e})}render(){return this.state.hasError?b.jsxs("div",{style:{padding:"2rem",textAlign:"center",minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},children:[b.jsx("h1",{children:"Oops! Something went wrong"}),b.jsx("p",{style:{color:"#666",marginBottom:"1rem"},children:"We encountered an unexpected error. Please try refreshing the page."}),!1,b.jsx("button",{onClick:()=>window.location.href="/",style:{marginTop:"1rem",padding:"0.5rem 1rem",backgroundColor:"#007acc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"1rem"},children:"Go to Home"})]}):this.props.children}}const hM=()=>{const{authState:r}=Cs(),[t,e]=Un.useState(!1);return r.status!=="error"||t?null:b.jsx("div",{style:{position:"fixed",top:"20px",right:"20px",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",padding:"1rem",maxWidth:"400px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)",zIndex:1e3,fontFamily:"sans-serif"},role:"alert",children:b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[b.jsxs("div",{children:[b.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"#856404"},children:"Authentication Unavailable"}),b.jsxs("div",{style:{margin:0,color:"#856404",fontSize:"0.9rem",lineHeight:1.4},children:[b.jsx("div",{children:"Some features may be limited, but you can still view documents."}),!1]})]}),b.jsx("button",{onClick:()=>e(!0),style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#856404",padding:0,marginLeft:"1rem",flexShrink:0},"aria-label":"Dismiss notification",children:""})]})})},Wa=({children:r})=>{const{authState:t}=Cs();return t.status==="loading"?b.jsx("div",{children:"Loading..."}):r},dM=()=>{const r=[{title:"Signature placement UI",detail:"Place a signature field on a PDF with drag/drop + resize."},{title:"Identity & consent",detail:"Signer authentication + explicit consent."},{title:"Audit trail",detail:"Record who signed, when, and what hash."}];return b.jsxs("div",{style:{padding:"2.5rem 1.5rem",maxWidth:900,margin:"0 auto"},children:[b.jsx("h1",{children:"Sign PDFs"}),b.jsx("p",{children:"Signing is not ready yet. This is a roadmap placeholder."}),b.jsx("ul",{children:r.map(t=>b.jsxs("li",{children:[b.jsx("strong",{children:t.title}),": ",t.detail]},t.title))})]})},fM=()=>b.jsx("div",{children:"Sign Up Page"}),pM=()=>b.jsx(uM,{children:b.jsxs(BC,{children:[b.jsx(hM,{}),b.jsx(x_,{children:b.jsxs(QS,{children:[b.jsx(_e,{path:"/",element:b.jsx(Mn,{children:b.jsx(cR,{})})}),b.jsx(_e,{path:"/pricing",element:b.jsx(Mn,{children:b.jsx(rM,{})})}),b.jsx(_e,{path:"/about",element:b.jsx(Mn,{children:b.jsx(nM,{})})}),b.jsx(_e,{path:"/privacy",element:b.jsx(Mn,{children:b.jsx(iM,{})})}),b.jsx(_e,{path:"/terms",element:b.jsx(Mn,{children:b.jsx(sM,{})})}),b.jsx(_e,{path:"/contact",element:b.jsx(Mn,{children:b.jsx(aM,{})})}),b.jsx(_e,{path:"/sign-in",element:b.jsx(Mn,{showHeader:!1,showFooter:!1,children:b.jsx(lM,{})})}),b.jsx(_e,{path:"/sign-up",element:b.jsx(Mn,{showHeader:!1,showFooter:!1,children:b.jsx(fM,{})})}),b.jsx(_e,{path:"/view",element:b.jsx(Wa,{children:b.jsx(gf,{})})}),b.jsx(_e,{path:"/view/:documentId",element:b.jsx(Wa,{children:b.jsx(gf,{})})}),b.jsx(_e,{path:"/view/test-docs/:fileName",element:b.jsx(Wa,{children:b.jsx(gf,{})})}),b.jsx(_e,{path:"/profile",element:b.jsx(Wa,{children:b.jsx(Mn,{variant:"app",children:b.jsx(cM,{})})})}),b.jsx(_e,{path:"/edit/:documentId",element:b.jsx(Wa,{children:b.jsx(rv,{})})}),b.jsx(_e,{path:"/edit/test-docs/:fileName",element:b.jsx(Wa,{children:b.jsx(rv,{})})}),b.jsx(_e,{path:"/sign",element:b.jsx(Mn,{children:b.jsx(dM,{})})}),b.jsx(_e,{path:"/app",element:b.jsx(Gy,{to:"/view",replace:!0})}),b.jsx(_e,{path:"*",element:b.jsx(Gy,{to:"/",replace:!0})})]})})]})});tS.createRoot(document.getElementById("root")).render(b.jsx(Un.StrictMode,{children:b.jsx(pM,{})}));
